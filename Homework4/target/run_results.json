{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-10-20T14:20:01.839896Z", "invocation_id": "6dfcd795-76e8-42b4-b8d8-de6e04ac61aa", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:19:59.630157Z", "completed_at": "2024-10-20T14:19:59.648639Z"}, {"name": "execute", "started_at": "2024-10-20T14:19:59.650682Z", "completed_at": "2024-10-20T14:19:59.838461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23056626319885254, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.aircrafts_raw", "compiled": true, "compiled_code": "\n\nselect\n    aircraft_id,\n    aircraft_model,\n    capacity,\n    manufacturer,\n    in_service_date\nfrom main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts", "relation_name": "\"lh\".\"main_raw\".\"aircrafts_raw\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:19:59.869681Z", "completed_at": "2024-10-20T14:19:59.885321Z"}, {"name": "execute", "started_at": "2024-10-20T14:19:59.885321Z", "completed_at": "2024-10-20T14:19:59.963410Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14058303833007812, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.airports_raw", "compiled": true, "compiled_code": "\n\nselect\n    airport_code,\n    airport_name,\n    city,\n    country,\n    timezone\nfrom main.raw_airports", "relation_name": "\"lh\".\"main_raw\".\"airports_raw\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:00.025881Z", "completed_at": "2024-10-20T14:20:00.025881Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:00.025881Z", "completed_at": "2024-10-20T14:20:00.119870Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1096181869506836, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.bookings_raw", "compiled": true, "compiled_code": "\n\nselect\n    booking_id,\n    flight_id,\n    passenger_id,\n    booking_date,\n    booking_status,\n    price\nfrom  main.raw_bookings", "relation_name": "\"lh\".\"main_raw\".\"bookings_raw\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:00.151120Z", "completed_at": "2024-10-20T14:20:00.166763Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:00.166763Z", "completed_at": "2024-10-20T14:20:00.244859Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12495970726013184, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.flights_raw", "compiled": true, "compiled_code": "  -- tells dbt how to create and store model in db\n\nselect\n    flight_id,\n    flight_number,\n    origin_airport_code,\n    destination_airport_code,\n    scheduled_departure_time,\n    scheduled_arrival_time,\n    actual_departure_time,\n    actual_arrival_time,\n    aircraft_id,\n    status\nfrom main.raw_flights", "relation_name": "\"lh\".\"main_raw\".\"flights_raw\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:00.291701Z", "completed_at": "2024-10-20T14:20:00.291701Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:00.291701Z", "completed_at": "2024-10-20T14:20:00.385568Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1251232624053955, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.passengers_raw", "compiled": true, "compiled_code": "\n\nselect\n    passenger_id,\n    first_name,\n    last_name,\n    date_of_birth,\n    email,\n    phone_number\nfrom  main.raw_passengers", "relation_name": "\"lh\".\"main_raw\".\"passengers_raw\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:00.416848Z", "completed_at": "2024-10-20T14:20:00.432460Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:00.432460Z", "completed_at": "2024-10-20T14:20:00.527943Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12562346458435059, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.aircrafts_stg", "compiled": true, "compiled_code": "\n\nselect\n    aircraft_id,\n    aircraft_model,\n    capacity,\n    manufacturer,\n    in_service_date\nfrom \"lh\".\"main_raw\".\"aircrafts_raw\"\nwhere in_service_date IS NOT null", "relation_name": "\"lh\".\"main_stage\".\"aircrafts_stg\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:00.558125Z", "completed_at": "2024-10-20T14:20:00.573753Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:00.573753Z", "completed_at": "2024-10-20T14:20:00.651844Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10933208465576172, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.airports_stg", "compiled": true, "compiled_code": "\n\nselect\n    UPPER(airport_code) as airport_code,\n    airport_name,\n    city,\n    country,\n    timezone\nfrom \"lh\".\"main_raw\".\"airports_raw\"", "relation_name": "\"lh\".\"main_stage\".\"airports_stg\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:00.683096Z", "completed_at": "2024-10-20T14:20:00.683096Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:00.683096Z", "completed_at": "2024-10-20T14:20:00.776804Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10936665534973145, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.bookings_stg", "compiled": true, "compiled_code": "\n\nselect\n    booking_id,\n    flight_id,\n    passenger_id,\n    booking_date,\n    UPPER(booking_status) as booking_status,\n    price\nfrom \"lh\".\"main_raw\".\"bookings_raw\"\nwhere booking_status is not null", "relation_name": "\"lh\".\"main_stage\".\"bookings_stg\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:00.808054Z", "completed_at": "2024-10-20T14:20:00.808054Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:00.808054Z", "completed_at": "2024-10-20T14:20:00.886140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10929608345031738, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.flights_stg", "compiled": true, "compiled_code": "\n\nselect\n    flight_id,\n    flight_number,\n    origin_airport_code as airport_from,\n    destination_airport_code as airport_to,\n    scheduled_departure_time,\n    scheduled_arrival_time,\n    actual_departure_time,\n    actual_arrival_time,\n    aircraft_id,\n    upper(status) as status\nfrom \"lh\".\"main_raw\".\"flights_raw\"\nwhere status is not null", "relation_name": "\"lh\".\"main_stage\".\"flights_stg\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:00.917382Z", "completed_at": "2024-10-20T14:20:00.917382Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:00.933001Z", "completed_at": "2024-10-20T14:20:00.995481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09372353553771973, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.passengers_stg", "compiled": true, "compiled_code": "\n\nselect\n    passenger_id,\n    first_name,\n    last_name,\n    date_of_birth,\n    LOWER(email) as email,\n    phone_number\nfrom \"lh\".\"main_raw\".\"passengers_raw\"", "relation_name": "\"lh\".\"main_stage\".\"passengers_stg\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:01.026702Z", "completed_at": "2024-10-20T14:20:01.042341Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:01.042341Z", "completed_at": "2024-10-20T14:20:01.216642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21923494338989258, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.daily_flights", "compiled": true, "compiled_code": "\n\nwith flights as (\n    select\n        flight_id,\n        -- date(scheduled_departure_time) as flight_date,\n        -- Function with name date does not exist! Did you mean \"datesub\"?\n        CAST (scheduled_departure_time AS DATE) AS flight_date,\n        airport_from,\n        airport_to,\n        status\n    from \"lh\".\"main_stage\".\"flights_stg\"\n)\nselect\n    flight_date,\n    airport_from,\n    airport_to,\n    count(*) as total_flights,\n    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,\n    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled\nfrom flights\ngroup by flight_date, airport_from, airport_to", "relation_name": "\"lh\".\"main_mart\".\"daily_flights\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:01.261585Z", "completed_at": "2024-10-20T14:20:01.261585Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:01.261585Z", "completed_at": "2024-10-20T14:20:01.339687Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10932326316833496, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.delays", "compiled": true, "compiled_code": "\n\nWITH delays AS (\n    SELECT\n        flight_id,\n        scheduled_departure_time,\n        actual_departure_time,\n        EXTRACT('epoch' FROM (actual_departure_time - scheduled_departure_time)) / 60 AS departure_delay_minutes\n      --EXTRACT('epoch' FROM interval) function returns the total number of seconds contained in the interval\n    FROM \"lh\".\"main_stage\".\"flights_stg\"\n    WHERE actual_departure_time IS NOT NULL\n)\n\nSELECT\n    AVG(departure_delay_minutes) AS average_delay_minutes,\n    MAX(departure_delay_minutes) AS max_delay_minutes,\n    MIN(departure_delay_minutes) AS min_delay_minutes,\n    COUNT(*) AS total_flights\nFROM delays", "relation_name": "\"lh\".\"main_mart\".\"delays\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:01.386526Z", "completed_at": "2024-10-20T14:20:01.386526Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:01.386526Z", "completed_at": "2024-10-20T14:20:01.480629Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14096999168395996, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.flight_effectiveness", "compiled": true, "compiled_code": "\n\nwith flight_bookings as (\n    select\n        b.flight_id,\n        count(*) AS booked_seats\n    from \"lh\".\"main_stage\".\"bookings_stg\" b\n    group by b.flight_id\n),\nflight_capacity as (\n    select\n        f.flight_id,\n        f.aircraft_id,\n        a.capacity\n    from \"lh\".\"main_stage\".\"flights_stg\" f\n    INNER JOIN \"lh\".\"main_stage\".\"aircrafts_stg\" a ON f.aircraft_id = a.aircraft_id\n)\nselect\n    fc.flight_id,\n    fc.aircraft_id,\n    fc.capacity,\n    fb.booked_seats,\n    (fb.booked_seats::float / fc.capacity) * 100 AS effectiveness_percentage -- typecast to float\nfrom flight_capacity fc\nLEFT JOIN flight_bookings fb ON fc.flight_id = fb.flight_id", "relation_name": "\"lh\".\"main_mart\".\"flight_effectiveness\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:01.511878Z", "completed_at": "2024-10-20T14:20:01.527524Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:01.527524Z", "completed_at": "2024-10-20T14:20:01.605616Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1406090259552002, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.top_routes", "compiled": true, "compiled_code": "\n\nSELECT\n    airport_from,\n    airport_to,\n    COUNT(*) AS total_flights\nFROM \"lh\".\"main_stage\".\"flights_stg\"\nGROUP BY airport_from, airport_to\nORDER BY total_flights DESC\nLIMIT 10", "relation_name": "\"lh\".\"main_mart\".\"top_routes\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-20T14:20:01.668101Z", "completed_at": "2024-10-20T14:20:01.668101Z"}, {"name": "execute", "started_at": "2024-10-20T14:20:01.668101Z", "completed_at": "2024-10-20T14:20:01.761820Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12494921684265137, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.lufthansa.revenue_from_passengers", "compiled": true, "compiled_code": "\n\nselect\n    p.passenger_id,\n    p.first_name,\n    p.last_name,\n    sum(b.price) as total_revenue,\n    count(*) as total_bookings\nfrom \"lh\".\"main_stage\".\"passengers_stg\" p\nINNER JOIN \"lh\".\"main_stage\".\"bookings_stg\" b on p.passenger_id = b.passenger_id\ngroup BY p.passenger_id, p.first_name, p.last_name", "relation_name": "\"lh\".\"main_mart\".\"revenue_from_passengers\""}], "elapsed_time": 3.3284265995025635, "args": {"cache_selected_only": false, "show_resource_report": false, "indirect_selection": "eager", "strict_mode": false, "use_colors_file": true, "log_format_file": "debug", "log_level_file": "debug", "log_level": "info", "which": "run", "select": [], "favor_state": false, "macro_debugging": false, "profiles_dir": "C:\\Users\\Hanna\\.dbt", "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "print": true, "project_dir": "C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa", "require_resource_names_without_spaces": false, "quiet": false, "vars": {}, "log_path": "C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs", "invocation_command": "dbt run", "populate_cache": true, "printer_width": 80, "version_check": true, "empty": false, "write_json": true, "defer": false, "partial_parse_file_diff": true, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "partial_parse": true, "exclude": [], "enable_legacy_logger": false, "source_freshness_run_project_hooks": false, "introspect": true, "log_file_max_bytes": 10485760}}