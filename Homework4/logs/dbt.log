[0m16:35:50.716551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CAAB9F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CAAB98090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CAABE3F90>]}


============================== 16:35:50.717794 | ecb4fac4-b18e-45ad-add3-27f3afb2686c ==============================
[0m16:35:50.717794 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:35:50.717794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:51.747239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb4fac4-b18e-45ad-add3-27f3afb2686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CAAF2F3D0>]}
[0m16:35:51.857821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb4fac4-b18e-45ad-add3-27f3afb2686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA803A0D0>]}
[0m16:35:51.894040 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:35:51.940181 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:35:51.943174 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:35:51.944167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ecb4fac4-b18e-45ad-add3-27f3afb2686c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CAA78A3D0>]}
[0m16:35:56.336106 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.lufthansa.aircrafts_stg' (models\stage\aircrafts_stg.sql) depends on a node named 'aircraft_raw' which was not found
[0m16:35:56.338077 [debug] [MainThread]: Command `dbt run` failed at 16:35:56.338077 after 5.80 seconds
[0m16:35:56.340107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA466E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA493D990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA493D850>]}
[0m16:35:56.342028 [debug] [MainThread]: Flushing usage events
[0m16:37:35.334553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D792DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D792D890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D792DC90>]}


============================== 16:37:35.347195 | 89582588-4d14-4d1a-a965-2e52093cd58e ==============================
[0m16:37:35.347195 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:37:35.349319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:35.804458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D792CD90>]}
[0m16:37:35.921348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D4DCA150>]}
[0m16:37:35.930748 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:37:35.950639 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:37:35.953617 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:37:35.954588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D792CC10>]}
[0m16:37:39.148852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D9063C90>]}
[0m16:37:39.480863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D8E6C250>]}
[0m16:37:39.480863 [info ] [MainThread]: Found 17 models, 4 seeds, 4 data tests, 416 macros
[0m16:37:39.489542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D8F439D0>]}
[0m16:37:39.496482 [info ] [MainThread]: 
[0m16:37:39.499439 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:37:39.515330 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:37:43.985514 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:37:43.986507 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:37:43.987500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:44.082406 [debug] [ThreadPool]: SQL status: OK in 0.095 seconds
[0m16:37:44.088785 [debug] [ThreadPool]: On list_dev: Close
[0m16:37:44.098754 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:37:44.099714 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:37:44.100727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:44.130497 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m16:37:44.132788 [debug] [ThreadPool]: On list_dev: Close
[0m16:37:44.142834 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:37:44.142834 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:37:44.142834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:44.166782 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m16:37:44.170784 [debug] [ThreadPool]: On list_dev: Close
[0m16:37:44.184954 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:37:44.185915 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:37:44.186904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:44.205961 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:37:44.208940 [debug] [ThreadPool]: On list_dev: Close
[0m16:37:44.214881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_stage)
[0m16:37:44.216870 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:37:44.232781 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:37:44.233777 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:37:44.234767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:44.256005 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:37:44.260002 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:37:44.260971 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:37:44.261989 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:44.262979 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:37:44.263973 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:37:44.266399 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:37:44.268390 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:37:44.269382 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:37:44.270376 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:37:44.274371 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:37:44.275362 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:37:44.296563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main)
[0m16:37:44.297555 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:37:44.302523 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:37:44.303516 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:37:44.304510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:44.334990 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m16:37:44.339114 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:37:44.340107 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:37:44.341101 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:44.342098 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:37:44.343089 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:37:44.344081 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:44.346070 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:37:44.347040 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:37:44.347040 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:37:44.349042 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:44.350043 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:37:44.354987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now create_dev_main_mart)
[0m16:37:44.356974 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:37:44.361941 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:37:44.362934 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:37:44.362934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:44.382824 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:37:44.386797 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:37:44.387789 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:37:44.388785 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:44.389776 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:37:44.390769 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:37:44.391762 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:44.393749 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:37:44.394742 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:37:44.395735 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:37:44.399159 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:37:44.400159 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:37:44.414673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_mart, now create_dev_main_raw)
[0m16:37:44.415667 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:37:44.423187 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:37:44.424180 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:37:44.425176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:44.455967 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m16:37:44.459942 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:37:44.461929 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:37:44.463914 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:37:44.464907 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:37:44.465922 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:37:44.466912 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:37:44.469894 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:37:44.469894 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:37:44.470888 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:37:44.474900 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:37:44.476301 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:37:44.492895 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_stage'
[0m16:37:44.506800 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:37:44.507794 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:37:44.508787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:44.539560 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m16:37:44.540564 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:37:44.541549 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:37:44.638687 [debug] [ThreadPool]: SQL status: OK in 0.099 seconds
[0m16:37:44.642681 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:37:44.670632 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:37:44.674628 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:37:44.683854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main)
[0m16:37:44.688821 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:37:44.689818 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:37:44.690808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:44.709691 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:37:44.711647 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:37:44.712666 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:37:44.809173 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m16:37:44.813146 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:37:44.814139 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:37:44.815133 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:37:44.823100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_mart)
[0m16:37:44.828045 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:37:44.829038 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:37:44.830033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:44.852879 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:37:44.853876 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:37:44.854866 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:37:44.959949 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m16:37:44.959949 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:37:44.959949 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:37:44.959949 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:37:44.975569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main_raw)
[0m16:37:44.975569 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:37:44.975569 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:37:44.975569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:45.007321 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m16:37:45.007321 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:37:45.007321 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:37:45.116682 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m16:37:45.116682 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:37:45.116682 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:37:45.116682 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:37:45.132283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D8F73590>]}
[0m16:37:45.132283 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:45.132283 [debug] [MainThread]: On master: BEGIN
[0m16:37:45.132283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:45.147929 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m16:37:45.147929 [debug] [MainThread]: On master: COMMIT
[0m16:37:45.147929 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:45.147929 [debug] [MainThread]: On master: COMMIT
[0m16:37:45.147929 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:37:45.147929 [debug] [MainThread]: On master: Close
[0m16:37:45.163527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:45.163527 [info ] [MainThread]: 
[0m16:37:45.171577 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:37:45.179582 [info ] [Thread-1 (]: 1 of 17 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:37:45.179582 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:37:45.179582 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:37:45.204430 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:37:45.211405 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:37:45.284911 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:37:45.289339 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:37:45.290331 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:37:45.291325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:37:45.308216 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m16:37:45.309227 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:37:45.310218 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from source_data.aircraft
    );
  
  
[0m16:37:45.394085 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from source_data.aircraft
    );
  
  
[0m16:37:45.395253 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:37:45.395253 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m16:37:45.638276 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m16:37:45.639265 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:37:45.651185 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircraft does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from source_data.aircraft
                ^
[0m16:37:45.654165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D90A2990>]}
[0m16:37:45.656152 [error] [Thread-1 (]: 1 of 17 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.47s]
[0m16:37:45.658120 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:37:45.659238 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:37:45.663324 [info ] [Thread-1 (]: 2 of 17 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:37:45.666239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:37:45.668247 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:37:45.675212 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:37:45.677307 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:37:45.685260 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:37:45.688241 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:37:45.689235 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:37:45.691223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:45.709100 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:37:45.710093 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:37:45.711086 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from source_data.airports
    );
  
  
[0m16:37:45.778655 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from source_data.airports
    );
  
  
[0m16:37:45.779648 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:37:45.781648 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:37:45.786615 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:37:45.787609 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:37:45.799540 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from source_data.airports
                ^
[0m16:37:45.800532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D677D190>]}
[0m16:37:45.802520 [error] [Thread-1 (]: 2 of 17 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.13s]
[0m16:37:45.804092 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:37:45.805054 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:37:45.807098 [info ] [Thread-1 (]: 3 of 17 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:37:45.810003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:37:45.811985 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:37:45.817970 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:37:45.822683 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:37:45.830633 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:37:45.832954 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:37:45.834947 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:37:45.835939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:45.853839 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:37:45.855826 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:37:45.856800 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from source_data.bookings
    );
  
  
[0m16:37:45.922763 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from source_data.bookings
    );
  
  
[0m16:37:45.923758 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:37:45.925745 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:37:45.930695 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:37:45.931689 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:37:45.943589 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from source_data.bookings
                ^
[0m16:37:45.944582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D8EED0D0>]}
[0m16:37:45.945575 [error] [Thread-1 (]: 3 of 17 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.14s]
[0m16:37:45.947564 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:37:45.950372 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:37:45.952339 [info ] [Thread-1 (]: 4 of 17 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:37:45.954327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:37:45.956312 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:37:45.962271 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:37:45.965304 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:37:45.973200 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:37:45.977463 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:37:45.978457 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:37:45.979449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:46.000036 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m16:37:46.002002 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:37:46.003020 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from source_data.flights
    );
  
  
[0m16:37:46.080097 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from source_data.flights
    );
  
  
[0m16:37:46.081091 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:37:46.083093 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:37:46.088669 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:37:46.089688 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:37:46.101022 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from source_data.flights
                ^
[0m16:37:46.102016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D5262010>]}
[0m16:37:46.104003 [error] [Thread-1 (]: 4 of 17 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.15s]
[0m16:37:46.105567 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:37:46.107537 [debug] [Thread-1 (]: Began running node model.lufthansa.my_first_dbt_model
[0m16:37:46.108972 [info ] [Thread-1 (]: 5 of 17 START sql table model main.my_first_dbt_model .......................... [RUN]
[0m16:37:46.111105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.my_first_dbt_model)
[0m16:37:46.112979 [debug] [Thread-1 (]: Began compiling node model.lufthansa.my_first_dbt_model
[0m16:37:46.119926 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.my_first_dbt_model"
[0m16:37:46.124609 [debug] [Thread-1 (]: Began executing node model.lufthansa.my_first_dbt_model
[0m16:37:46.133569 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.my_first_dbt_model"
[0m16:37:46.136529 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_first_dbt_model"
[0m16:37:46.137521 [debug] [Thread-1 (]: On model.lufthansa.my_first_dbt_model: BEGIN
[0m16:37:46.138514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:46.156416 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:37:46.158402 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_first_dbt_model"
[0m16:37:46.159375 [debug] [Thread-1 (]: On model.lufthansa.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m16:37:46.168022 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:37:46.184930 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_first_dbt_model"
[0m16:37:46.185925 [debug] [Thread-1 (]: On model.lufthansa.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:37:46.190602 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:37:46.229375 [debug] [Thread-1 (]: On model.lufthansa.my_first_dbt_model: COMMIT
[0m16:37:46.230368 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_first_dbt_model"
[0m16:37:46.232354 [debug] [Thread-1 (]: On model.lufthansa.my_first_dbt_model: COMMIT
[0m16:37:46.237325 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:37:46.249227 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_first_dbt_model"
[0m16:37:46.250199 [debug] [Thread-1 (]: On model.lufthansa.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m16:37:46.251197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:46.256180 [debug] [Thread-1 (]: On model.lufthansa.my_first_dbt_model: Close
[0m16:37:46.312732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D95ED0D0>]}
[0m16:37:46.314717 [info ] [Thread-1 (]: 5 of 17 OK created sql table model main.my_first_dbt_model ..................... [[32mOK[0m in 0.20s]
[0m16:37:46.317067 [debug] [Thread-1 (]: Finished running node model.lufthansa.my_first_dbt_model
[0m16:37:46.318056 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:37:46.320025 [info ] [Thread-1 (]: 6 of 17 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:37:46.322131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.my_first_dbt_model, now model.lufthansa.passengers_raw)
[0m16:37:46.324147 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:37:46.332884 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:37:46.334870 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:37:46.342822 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:37:46.346134 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:37:46.347126 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:37:46.348118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:46.379429 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m16:37:46.380391 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:37:46.381384 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from source_data.passengers
    );
  
  
[0m16:37:46.450903 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from source_data.passengers
    );
  
  
[0m16:37:46.451896 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:37:46.452892 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:37:46.458849 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:37:46.459842 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:37:46.470534 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Catalog Error: Table with name passengers does not exist!
  Did you mean "dev.pg_catalog.pg_settings"?
  LINE 20: from source_data.passengers
                ^
[0m16:37:46.472522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D90A2A50>]}
[0m16:37:46.473729 [error] [Thread-1 (]: 6 of 17 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.15s]
[0m16:37:46.473729 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:37:46.473729 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:37:46.473729 [info ] [Thread-1 (]: 7 of 17 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m16:37:46.473729 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:37:46.473729 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:37:46.473729 [info ] [Thread-1 (]: 8 of 17 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:37:46.473729 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:37:46.473729 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:37:46.489532 [info ] [Thread-1 (]: 9 of 17 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:37:46.491645 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:37:46.493247 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:37:46.494319 [info ] [Thread-1 (]: 10 of 17 SKIP relation main_stage.flights_stg .................................. [[33mSKIP[0m]
[0m16:37:46.495394 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:37:46.495394 [debug] [Thread-1 (]: Began running node model.lufthansa.my_second_dbt_model
[0m16:37:46.495394 [info ] [Thread-1 (]: 11 of 17 START sql view model main.my_second_dbt_model ......................... [RUN]
[0m16:37:46.495394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.my_second_dbt_model)
[0m16:37:46.495394 [debug] [Thread-1 (]: Began compiling node model.lufthansa.my_second_dbt_model
[0m16:37:46.505400 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.my_second_dbt_model"
[0m16:37:46.505400 [debug] [Thread-1 (]: Began executing node model.lufthansa.my_second_dbt_model
[0m16:37:46.553092 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.my_second_dbt_model"
[0m16:37:46.556052 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_second_dbt_model"
[0m16:37:46.557047 [debug] [Thread-1 (]: On model.lufthansa.my_second_dbt_model: BEGIN
[0m16:37:46.558060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:46.576932 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:37:46.577928 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_second_dbt_model"
[0m16:37:46.578918 [debug] [Thread-1 (]: On model.lufthansa.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m16:37:46.580907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:46.587858 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_second_dbt_model"
[0m16:37:46.589845 [debug] [Thread-1 (]: On model.lufthansa.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:37:46.593670 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:37:46.596648 [debug] [Thread-1 (]: On model.lufthansa.my_second_dbt_model: COMMIT
[0m16:37:46.597641 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_second_dbt_model"
[0m16:37:46.598634 [debug] [Thread-1 (]: On model.lufthansa.my_second_dbt_model: COMMIT
[0m16:37:46.602353 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:37:46.608318 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.my_second_dbt_model"
[0m16:37:46.609311 [debug] [Thread-1 (]: On model.lufthansa.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m16:37:46.611299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:46.614278 [debug] [Thread-1 (]: On model.lufthansa.my_second_dbt_model: Close
[0m16:37:46.625851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89582588-4d14-4d1a-a965-2e52093cd58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D8EEEDD0>]}
[0m16:37:46.626843 [info ] [Thread-1 (]: 11 of 17 OK created sql view model main.my_second_dbt_model .................... [[32mOK[0m in 0.13s]
[0m16:37:46.629327 [debug] [Thread-1 (]: Finished running node model.lufthansa.my_second_dbt_model
[0m16:37:46.630319 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:37:46.631312 [info ] [Thread-1 (]: 12 of 17 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:37:46.633315 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:37:46.634272 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:37:46.635287 [info ] [Thread-1 (]: 13 of 17 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:37:46.637273 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:37:46.638269 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:37:46.640320 [info ] [Thread-1 (]: 14 of 17 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:37:46.642255 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:37:46.643250 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:37:46.645329 [info ] [Thread-1 (]: 15 of 17 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:37:46.647185 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:37:46.649192 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:37:46.650185 [info ] [Thread-1 (]: 16 of 17 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:37:46.651179 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:37:46.652172 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:37:46.653171 [info ] [Thread-1 (]: 17 of 17 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:37:46.654144 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:37:46.657153 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:46.659195 [debug] [MainThread]: On master: BEGIN
[0m16:37:46.661094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:46.688926 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m16:37:46.689925 [debug] [MainThread]: On master: COMMIT
[0m16:37:46.691887 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:46.692880 [debug] [MainThread]: On master: COMMIT
[0m16:37:46.694933 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:37:46.696916 [debug] [MainThread]: On master: Close
[0m16:37:46.701818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:46.702811 [debug] [MainThread]: Connection 'create_dev_main_raw' was properly closed.
[0m16:37:46.703806 [debug] [MainThread]: Connection 'list_dev_main_raw' was properly closed.
[0m16:37:46.703806 [debug] [MainThread]: Connection 'model.lufthansa.my_second_dbt_model' was properly closed.
[0m16:37:46.704799 [info ] [MainThread]: 
[0m16:37:46.706786 [info ] [MainThread]: Finished running 11 table models, 6 view models in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m16:37:46.712766 [debug] [MainThread]: Command end result
[0m16:37:46.784577 [info ] [MainThread]: 
[0m16:37:46.784577 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:37:46.784577 [info ] [MainThread]: 
[0m16:37:46.784577 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircraft does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from source_data.aircraft
                ^
[0m16:37:46.784577 [info ] [MainThread]: 
[0m16:37:46.784577 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from source_data.airports
                ^
[0m16:37:46.801504 [info ] [MainThread]: 
[0m16:37:46.802492 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from source_data.bookings
                ^
[0m16:37:46.803486 [info ] [MainThread]: 
[0m16:37:46.804479 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from source_data.flights
                ^
[0m16:37:46.806447 [info ] [MainThread]: 
[0m16:37:46.808456 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Catalog Error: Table with name passengers does not exist!
  Did you mean "dev.pg_catalog.pg_settings"?
  LINE 20: from source_data.passengers
                ^
[0m16:37:46.810442 [info ] [MainThread]: 
[0m16:37:46.811439 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=10 TOTAL=17
[0m16:37:46.814413 [debug] [MainThread]: Command `dbt run` failed at 16:37:46.814413 after 11.62 seconds
[0m16:37:46.815411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D7704F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D14BE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D7960FD0>]}
[0m16:37:46.817396 [debug] [MainThread]: Flushing usage events
[0m16:39:14.424335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261015BC050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002610130DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261015BD610>]}


============================== 16:39:14.436632 | 0c82a1b6-a60c-42a1-bed4-e046139a62cd ==============================
[0m16:39:14.436632 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:39:14.440627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:39:14.933206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026101966450>]}
[0m16:39:15.026925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002617EA1DDD0>]}
[0m16:39:15.042534 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:39:15.073754 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:39:15.448965 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m16:39:15.448965 [debug] [MainThread]: Partial parsing: deleted file: lufthansa://models\example\my_first_dbt_model.sql
[0m16:39:15.464619 [debug] [MainThread]: Partial parsing: deleted file: lufthansa://models\example\my_second_dbt_model.sql
[0m16:39:15.605200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026102A23690>]}
[0m16:39:15.793277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026102A8D250>]}
[0m16:39:15.808899 [info ] [MainThread]: Found 15 models, 4 seeds, 416 macros
[0m16:39:15.808899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026101665F90>]}
[0m16:39:15.808899 [info ] [MainThread]: 
[0m16:39:15.808899 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:39:15.824518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:39:16.011993 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:39:16.011993 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:39:16.027600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:16.058821 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m16:39:16.058821 [debug] [ThreadPool]: On list_dev: Close
[0m16:39:16.058821 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:39:16.074461 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:39:16.074461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:16.090183 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:39:16.090183 [debug] [ThreadPool]: On list_dev: Close
[0m16:39:16.105875 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:39:16.105875 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:39:16.105875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:16.121474 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:39:16.121474 [debug] [ThreadPool]: On list_dev: Close
[0m16:39:16.137115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_stage)
[0m16:39:16.137115 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:39:16.152716 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:39:16.152716 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:39:16.152716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:16.168334 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:39:16.183956 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:39:16.183956 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:39:16.183956 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:39:16.183956 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:39:16.183956 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:39:16.183956 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:39:16.183956 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:39:16.183956 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:39:16.183956 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:39:16.183956 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:39:16.199574 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:39:16.199574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_raw)
[0m16:39:16.199574 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:39:16.199574 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:39:16.215194 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:39:16.215194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:16.230814 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:39:16.230814 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:39:16.230814 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:39:16.230814 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:16.230814 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:39:16.230814 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:39:16.230814 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:16.246454 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:39:16.246454 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:39:16.246454 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:39:16.246454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:16.246454 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:39:16.246454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_mart)
[0m16:39:16.246454 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:39:16.262079 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:39:16.262079 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:39:16.262079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:16.277675 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:39:16.277675 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:39:16.277675 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:39:16.277675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:16.277675 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:39:16.277675 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:39:16.277675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:16.293316 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:39:16.293316 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:39:16.293316 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:39:16.293316 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:16.293316 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:39:16.293316 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:39:16.308934 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:39:16.308934 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:39:16.308934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:16.340176 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:39:16.340176 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:39:16.340176 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:39:16.418277 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m16:39:16.418277 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:39:16.418277 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:39:16.418277 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:39:16.433897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_stage)
[0m16:39:16.433897 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:39:16.433897 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:39:16.433897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:16.449539 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:39:16.449539 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:39:16.449539 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:39:16.527630 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m16:39:16.527630 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:39:16.527630 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:39:16.527630 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:39:16.543251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_raw)
[0m16:39:16.543251 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:39:16.543251 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:39:16.543251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:16.558858 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:39:16.574477 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:39:16.574477 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:39:16.652604 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m16:39:16.652604 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:39:16.652604 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:39:16.652604 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:39:16.668219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_mart)
[0m16:39:16.668219 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:39:16.668219 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:39:16.668219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:16.683821 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m16:39:16.683821 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:39:16.683821 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:39:16.761916 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m16:39:16.761916 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:39:16.777543 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:39:16.777543 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:39:16.777543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026102F74F90>]}
[0m16:39:16.777543 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:16.777543 [debug] [MainThread]: On master: BEGIN
[0m16:39:16.777543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:16.793139 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m16:39:16.793139 [debug] [MainThread]: On master: COMMIT
[0m16:39:16.808759 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:16.808759 [debug] [MainThread]: On master: COMMIT
[0m16:39:16.808759 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:39:16.808759 [debug] [MainThread]: On master: Close
[0m16:39:16.808759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:16.808759 [info ] [MainThread]: 
[0m16:39:16.824378 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:39:16.824378 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:39:16.824378 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:39:16.824378 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:39:16.840017 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:39:16.840017 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:39:16.918097 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:39:16.918097 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:39:16.918097 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:39:16.918097 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:39:16.933744 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m16:39:16.933744 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:39:16.933744 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from source_data.aircraft
    );
  
  
[0m16:39:17.012105 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from source_data.aircraft
    );
  
  
[0m16:39:17.012105 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:39:17.012105 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m16:39:17.027752 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m16:39:17.027752 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:39:17.043377 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircraft does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from source_data.aircraft
                ^
[0m16:39:17.043377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002610166D310>]}
[0m16:39:17.043377 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.22s]
[0m16:39:17.043377 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:39:17.043377 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:39:17.043377 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:39:17.058971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:39:17.058971 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:39:17.058971 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:39:17.058971 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:39:17.074614 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:39:17.074614 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:39:17.074614 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:39:17.074614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:17.090234 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:39:17.090234 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:39:17.090234 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from source_data.airports
    );
  
  
[0m16:39:17.168635 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from source_data.airports
    );
  
  
[0m16:39:17.168635 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:39:17.168635 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:39:17.168635 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:39:17.184219 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:39:17.184219 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from source_data.airports
                ^
[0m16:39:17.184219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026102A54D90>]}
[0m16:39:17.199841 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.13s]
[0m16:39:17.199841 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:39:17.199841 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:39:17.199841 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:39:17.199841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:39:17.199841 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:39:17.215458 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:39:17.215458 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:39:17.231082 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:39:17.231082 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:39:17.246699 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:39:17.246699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:17.262323 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m16:39:17.277940 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:39:17.277940 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from source_data.bookings
    );
  
  
[0m16:39:17.356045 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from source_data.bookings
    );
  
  
[0m16:39:17.356045 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:39:17.356045 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:39:17.356045 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:39:17.356045 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:39:17.371664 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from source_data.bookings
                ^
[0m16:39:17.371664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261030C1450>]}
[0m16:39:17.371664 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.17s]
[0m16:39:17.371664 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:39:17.371664 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:39:17.387281 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:39:17.387281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:39:17.387281 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:39:17.402907 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:39:17.402907 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:39:17.402907 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:39:17.418521 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:39:17.418521 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:39:17.418521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:17.434142 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:39:17.434142 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:39:17.434142 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from source_data.flights
    );
  
  
[0m16:39:17.512275 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from source_data.flights
    );
  
  
[0m16:39:17.512275 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:39:17.512275 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:39:17.512275 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:39:17.512275 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:39:17.527863 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "main.sqlite_schema"?
  LINE 24: from source_data.flights
                ^
[0m16:39:17.527863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026103168490>]}
[0m16:39:17.527863 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.14s]
[0m16:39:17.527863 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:39:17.527863 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:39:17.527863 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:39:17.527863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:39:17.527863 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:39:17.543549 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:39:17.543549 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:39:17.543549 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:39:17.559124 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:39:17.559124 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:39:17.559124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:17.574742 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:39:17.574742 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:39:17.574742 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from source_data.passengers
    );
  
  
[0m16:39:17.652856 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from source_data.passengers
    );
  
  
[0m16:39:17.652856 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:39:17.652856 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:39:17.652856 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:39:17.652856 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:39:17.668467 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Catalog Error: Table with name passengers does not exist!
  Did you mean "dev.pg_catalog.pg_settings"?
  LINE 20: from source_data.passengers
                ^
[0m16:39:17.668467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c82a1b6-a60c-42a1-bed4-e046139a62cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261030CC2D0>]}
[0m16:39:17.668467 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.14s]
[0m16:39:17.668467 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:39:17.668467 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:39:17.668467 [info ] [Thread-1 (]: 6 of 15 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m16:39:17.668467 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:39:17.668467 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:39:17.684087 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:39:17.684087 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:39:17.684087 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:39:17.684087 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:39:17.684087 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:39:17.684087 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:39:17.684087 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m16:39:17.684087 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:39:17.684087 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:39:17.684087 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:39:17.684087 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:39:17.684087 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:39:17.699682 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:39:17.699682 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:39:17.699682 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:39:17.699682 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:39:17.699682 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:39:17.699682 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:39:17.699682 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:39:17.699682 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:39:17.699682 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:39:17.699682 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:39:17.699682 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:39:17.715324 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:39:17.715324 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:39:17.715324 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:39:17.715324 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:17.715324 [debug] [MainThread]: On master: BEGIN
[0m16:39:17.715324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:17.730960 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m16:39:17.730960 [debug] [MainThread]: On master: COMMIT
[0m16:39:17.730960 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:17.730960 [debug] [MainThread]: On master: COMMIT
[0m16:39:17.746578 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:39:17.746578 [debug] [MainThread]: On master: Close
[0m16:39:17.746578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:17.746578 [debug] [MainThread]: Connection 'create_dev_main_mart' was properly closed.
[0m16:39:17.746578 [debug] [MainThread]: Connection 'list_dev_main_mart' was properly closed.
[0m16:39:17.746578 [debug] [MainThread]: Connection 'model.lufthansa.passengers_raw' was properly closed.
[0m16:39:17.746578 [info ] [MainThread]: 
[0m16:39:17.746578 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m16:39:17.762163 [debug] [MainThread]: Command end result
[0m16:39:17.824663 [info ] [MainThread]: 
[0m16:39:17.824663 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:39:17.824663 [info ] [MainThread]: 
[0m16:39:17.824663 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircraft does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from source_data.aircraft
                ^
[0m16:39:17.840277 [info ] [MainThread]: 
[0m16:39:17.840277 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from source_data.airports
                ^
[0m16:39:17.840277 [info ] [MainThread]: 
[0m16:39:17.840277 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from source_data.bookings
                ^
[0m16:39:17.840277 [info ] [MainThread]: 
[0m16:39:17.840277 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "main.sqlite_schema"?
  LINE 24: from source_data.flights
                ^
[0m16:39:17.840277 [info ] [MainThread]: 
[0m16:39:17.840277 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Catalog Error: Table with name passengers does not exist!
  Did you mean "dev.pg_catalog.pg_settings"?
  LINE 20: from source_data.passengers
                ^
[0m16:39:17.840277 [info ] [MainThread]: 
[0m16:39:17.840277 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=10 TOTAL=15
[0m16:39:17.840277 [debug] [MainThread]: Command `dbt run` failed at 16:39:17.840277 after 3.57 seconds
[0m16:39:17.840277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002617B04E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261015F0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002617D82A450>]}
[0m16:39:17.840277 [debug] [MainThread]: Flushing usage events
[0m16:41:23.357788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2082DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2082CF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2082D390>]}


============================== 16:41:23.375152 | a0aec22f-2443-4f87-b71e-f810c44cb692 ==============================
[0m16:41:23.375152 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:41:23.375152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:41:23.843726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A20BE9F90>]}
[0m16:41:23.953083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A1DCCA2D0>]}
[0m16:41:23.953083 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:41:23.984310 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:41:24.330158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:41:24.330158 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\aircrafts_raw.sql
[0m16:41:24.793606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A208D54D0>]}
[0m16:41:24.996832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A21F3DB90>]}
[0m16:41:24.996832 [info ] [MainThread]: Found 15 models, 4 seeds, 416 macros
[0m16:41:24.996832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A21C981D0>]}
[0m16:41:24.996832 [info ] [MainThread]: 
[0m16:41:24.996832 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:41:25.012430 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:41:25.199871 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:41:25.199871 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:41:25.199871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:25.231147 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m16:41:25.231147 [debug] [ThreadPool]: On list_dev: Close
[0m16:41:25.246753 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:41:25.246753 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:41:25.246753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:25.262379 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:41:25.262379 [debug] [ThreadPool]: On list_dev: Close
[0m16:41:25.277972 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:41:25.277972 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:41:25.277972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:25.293593 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:41:25.309213 [debug] [ThreadPool]: On list_dev: Close
[0m16:41:25.309213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_raw)
[0m16:41:25.309213 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:41:25.324862 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:41:25.324862 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:41:25.324862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:25.340491 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:41:25.356108 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:41:25.356108 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:41:25.356108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:41:25.356108 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:41:25.356108 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:41:25.356108 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:25.356108 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:41:25.356108 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:41:25.356108 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:41:25.371693 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:41:25.371693 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:41:25.371693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_mart)
[0m16:41:25.371693 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:41:25.371693 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:41:25.387313 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:41:25.387313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:25.402932 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:41:25.402932 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:41:25.402932 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:41:25.402932 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:25.418553 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:41:25.418553 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:41:25.418553 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:25.418553 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:41:25.418553 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:41:25.418553 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:41:25.418553 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:25.418553 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:41:25.434172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_mart, now create_dev_main_stage)
[0m16:41:25.434172 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:41:25.434172 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:41:25.434172 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:41:25.434172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:25.449817 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:41:25.465443 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:41:25.465443 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:41:25.465443 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:41:25.465443 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:41:25.465443 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:41:25.465443 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:41:25.465443 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:41:25.465443 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:41:25.465443 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:41:25.465443 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:41:25.465443 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:41:25.481091 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_raw'
[0m16:41:25.496674 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:41:25.496674 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:41:25.496674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:25.512309 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:41:25.512309 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:41:25.512309 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:41:25.606014 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m16:41:25.606014 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:41:25.606014 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:41:25.606014 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:41:25.606014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_mart)
[0m16:41:25.621635 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:41:25.621635 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:41:25.621635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:25.637259 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m16:41:25.637259 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:41:25.637259 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:41:25.715356 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m16:41:25.715356 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:41:25.715356 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:41:25.715356 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:41:25.730977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main_stage)
[0m16:41:25.730977 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:41:25.730977 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:41:25.730977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:25.762215 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:41:25.762215 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:41:25.762215 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:41:25.840297 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m16:41:25.840297 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:41:25.840297 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:41:25.840297 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:41:25.855916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main)
[0m16:41:25.855916 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:41:25.855916 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:41:25.855916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:25.871538 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:41:25.887178 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:41:25.887178 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:41:25.949669 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m16:41:25.965291 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:41:25.965291 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:41:25.965291 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:41:25.965291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A20B478D0>]}
[0m16:41:25.965291 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:25.965291 [debug] [MainThread]: On master: BEGIN
[0m16:41:25.980897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:25.996517 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m16:41:25.996517 [debug] [MainThread]: On master: COMMIT
[0m16:41:25.996517 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:25.996517 [debug] [MainThread]: On master: COMMIT
[0m16:41:25.996517 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:41:25.996517 [debug] [MainThread]: On master: Close
[0m16:41:25.996517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:25.996517 [info ] [MainThread]: 
[0m16:41:26.012253 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:41:26.012253 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:41:26.012253 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:41:26.012253 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:41:26.027737 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:41:26.043356 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:41:26.107199 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:41:26.107199 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:41:26.121704 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:41:26.121704 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:41:26.137355 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:41:26.137355 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:41:26.137355 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from source_data.aircrafts
    );
  
  
[0m16:41:26.199811 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from source_data.aircrafts
    );
  
  
[0m16:41:26.215599 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:41:26.216643 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m16:41:26.221479 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m16:41:26.221479 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:41:26.231505 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircrafts does not exist!
  Did you mean "system.information_schema.referential_constraints"?
  LINE 19: from source_data.aircrafts
                ^
[0m16:41:26.231505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A20BD0A50>]}
[0m16:41:26.231505 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.22s]
[0m16:41:26.231505 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:41:26.247153 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:41:26.247153 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:41:26.247153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:41:26.247153 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:41:26.262789 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:41:26.262789 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:41:26.262789 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:41:26.278372 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:41:26.278372 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:41:26.278372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:26.293994 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:41:26.293994 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:41:26.293994 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from source_data.airports
    );
  
  
[0m16:41:26.356507 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from source_data.airports
    );
  
  
[0m16:41:26.356507 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:41:26.356507 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:41:26.372132 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:41:26.372132 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:41:26.387736 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "pg_catalog.pg_constraint"?
  LINE 19: from source_data.airports
                ^
[0m16:41:26.387736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A22458BD0>]}
[0m16:41:26.387736 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.14s]
[0m16:41:26.387736 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:41:26.387736 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:41:26.387736 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:41:26.387736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:41:26.387736 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:41:26.403355 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:41:26.403355 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:41:26.403355 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:41:26.418975 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:41:26.418975 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:41:26.418975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:26.434596 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:41:26.434596 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:41:26.434596 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from source_data.bookings
    );
  
  
[0m16:41:26.512674 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from source_data.bookings
    );
  
  
[0m16:41:26.512674 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:41:26.528296 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:41:26.528296 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:41:26.528296 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:41:26.543916 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from source_data.bookings
                ^
[0m16:41:26.543916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2243E690>]}
[0m16:41:26.543916 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.16s]
[0m16:41:26.543916 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:41:26.543916 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:41:26.543916 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:41:26.543916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:41:26.543916 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:41:26.559557 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:41:26.559557 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:41:26.559557 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:41:26.575156 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:41:26.575156 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:41:26.575156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:26.590799 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:41:26.590799 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:41:26.590799 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from source_data.flights
    );
  
  
[0m16:41:26.653289 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from source_data.flights
    );
  
  
[0m16:41:26.653289 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:41:26.653289 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:41:26.668896 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:41:26.668896 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:41:26.684517 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from source_data.flights
                ^
[0m16:41:26.684517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A22303E10>]}
[0m16:41:26.684517 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.14s]
[0m16:41:26.684517 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:41:26.684517 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:41:26.684517 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:41:26.684517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:41:26.684517 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:41:26.700138 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:41:26.700138 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:41:26.700138 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:41:26.700138 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:41:26.715757 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:41:26.715757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:26.731374 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:41:26.731374 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:41:26.731374 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from source_data.passengers
    );
  
  
[0m16:41:26.793869 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from source_data.passengers
    );
  
  
[0m16:41:26.793869 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:41:26.793869 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:41:26.809495 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:41:26.809495 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:41:26.809495 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Catalog Error: Table with name passengers does not exist!
  Did you mean "dev.pg_catalog.pg_settings"?
  LINE 20: from source_data.passengers
                ^
[0m16:41:26.825099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0aec22f-2443-4f87-b71e-f810c44cb692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A22414DD0>]}
[0m16:41:26.825099 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.14s]
[0m16:41:26.825099 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:41:26.825099 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:41:26.825099 [info ] [Thread-1 (]: 6 of 15 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m16:41:26.825099 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:41:26.825099 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:41:26.825099 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:41:26.825099 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:41:26.825099 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:41:26.825099 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:41:26.840717 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:41:26.840717 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:41:26.840717 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m16:41:26.840717 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:41:26.840717 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:41:26.840717 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:41:26.840717 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:41:26.840717 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:41:26.840717 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:41:26.840717 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:41:26.840717 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:41:26.840717 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:41:26.856337 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:41:26.856337 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:41:26.856337 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:41:26.856337 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:41:26.856337 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:41:26.856337 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:41:26.856337 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:41:26.856337 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:41:26.856337 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:41:26.856337 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:41:26.871937 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:26.871937 [debug] [MainThread]: On master: BEGIN
[0m16:41:26.871937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:26.887557 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m16:41:26.887557 [debug] [MainThread]: On master: COMMIT
[0m16:41:26.887557 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:26.887557 [debug] [MainThread]: On master: COMMIT
[0m16:41:26.887557 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:41:26.887557 [debug] [MainThread]: On master: Close
[0m16:41:26.903198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:26.903198 [debug] [MainThread]: Connection 'create_dev_main_stage' was properly closed.
[0m16:41:26.903198 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m16:41:26.903198 [debug] [MainThread]: Connection 'model.lufthansa.passengers_raw' was properly closed.
[0m16:41:26.903198 [info ] [MainThread]: 
[0m16:41:26.903198 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m16:41:26.903198 [debug] [MainThread]: Command end result
[0m16:41:26.981436 [info ] [MainThread]: 
[0m16:41:26.981436 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:41:26.981436 [info ] [MainThread]: 
[0m16:41:26.981436 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircrafts does not exist!
  Did you mean "system.information_schema.referential_constraints"?
  LINE 19: from source_data.aircrafts
                ^
[0m16:41:26.981436 [info ] [MainThread]: 
[0m16:41:26.981436 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "pg_catalog.pg_constraint"?
  LINE 19: from source_data.airports
                ^
[0m16:41:26.981436 [info ] [MainThread]: 
[0m16:41:26.981436 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from source_data.bookings
                ^
[0m16:41:26.997087 [info ] [MainThread]: 
[0m16:41:26.997087 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from source_data.flights
                ^
[0m16:41:26.997087 [info ] [MainThread]: 
[0m16:41:26.997087 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Catalog Error: Table with name passengers does not exist!
  Did you mean "dev.pg_catalog.pg_settings"?
  LINE 20: from source_data.passengers
                ^
[0m16:41:26.997087 [info ] [MainThread]: 
[0m16:41:26.997087 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=10 TOTAL=15
[0m16:41:26.997087 [debug] [MainThread]: Command `dbt run` failed at 16:41:26.997087 after 3.80 seconds
[0m16:41:26.997087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2089FC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A1A3CE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A20847710>]}
[0m16:41:26.997087 [debug] [MainThread]: Flushing usage events
[0m16:47:08.006650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D222B16590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D225B9CC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D225B9C910>]}


============================== 16:47:08.022273 | 76031378-f26f-4640-b9e9-f6ca6ab4cedb ==============================
[0m16:47:08.022273 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:47:08.022273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:08.476606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D225ED3010>]}
[0m16:47:08.585920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22303DED0>]}
[0m16:47:08.585920 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:47:08.617161 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:47:08.929585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 4 files changed.
[0m16:47:08.929585 [debug] [MainThread]: Partial parsing: added file: lufthansa://seeds\raw_aircrafts.csv
[0m16:47:08.929585 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\bookings_raw.sql
[0m16:47:08.929585 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\passengers_raw.sql
[0m16:47:08.929585 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\airports_raw.sql
[0m16:47:08.929585 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\flights_raw.sql
[0m16:47:09.772115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D225B9EBD0>]}
[0m16:47:09.964021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22738C090>]}
[0m16:47:09.964021 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m16:47:09.964021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227289050>]}
[0m16:47:09.964021 [info ] [MainThread]: 
[0m16:47:09.979679 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:47:09.979679 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:47:10.182723 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:47:10.182723 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:47:10.182723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:10.213963 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m16:47:10.213963 [debug] [ThreadPool]: On list_dev: Close
[0m16:47:10.213963 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:47:10.213963 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:47:10.229564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:10.245206 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:47:10.245206 [debug] [ThreadPool]: On list_dev: Close
[0m16:47:10.260824 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:47:10.260824 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:47:10.260824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:10.276425 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m16:47:10.292045 [debug] [ThreadPool]: On list_dev: Close
[0m16:47:10.292045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_mart)
[0m16:47:10.292045 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:47:10.307688 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:47:10.307688 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:47:10.307688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:10.323321 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:47:10.323321 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:47:10.338944 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:47:10.338944 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:47:10.338944 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:47:10.338944 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:47:10.338944 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:47:10.338944 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:47:10.338944 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:47:10.338944 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:47:10.338944 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:47:10.338944 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:47:10.354547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_mart, now create_dev_main_raw)
[0m16:47:10.354547 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:47:10.354547 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:47:10.354547 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:47:10.354547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:10.370165 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:47:10.370165 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:47:10.385784 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:47:10.385784 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:47:10.385784 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:47:10.385784 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:47:10.385784 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:47:10.385784 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:47:10.385784 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:47:10.385784 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:47:10.385784 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:47:10.385784 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:47:10.401386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_stage)
[0m16:47:10.401386 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:47:10.401386 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:47:10.401386 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:47:10.401386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:10.417027 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:47:10.417027 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:47:10.432624 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:47:10.432624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:47:10.432624 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:47:10.432624 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:47:10.432624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:47:10.432624 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:47:10.432624 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:47:10.432624 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:47:10.432624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:47:10.432624 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:47:10.448245 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_mart'
[0m16:47:10.463893 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:47:10.463893 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:47:10.463893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:10.479510 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:47:10.479510 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:47:10.479510 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:47:10.573230 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m16:47:10.573230 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:47:10.573230 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:47:10.573230 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:47:10.573230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main_raw)
[0m16:47:10.588847 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:47:10.588847 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:47:10.588847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:10.604466 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:47:10.604466 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:47:10.604466 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:47:10.698287 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m16:47:10.698287 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:47:10.713907 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:47:10.713907 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:47:10.713907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_stage)
[0m16:47:10.713907 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:47:10.713907 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:47:10.713907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:10.747707 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:47:10.748887 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:47:10.750074 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:47:10.823829 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m16:47:10.823829 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:47:10.823829 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:47:10.823829 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:47:10.823829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main)
[0m16:47:10.839451 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:47:10.839451 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:47:10.839451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:10.855089 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m16:47:10.855089 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:47:10.855089 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:47:10.933172 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m16:47:10.933172 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:47:10.933172 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:47:10.933172 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:47:10.948770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227754090>]}
[0m16:47:10.948770 [debug] [MainThread]: Using duckdb connection "master"
[0m16:47:10.948770 [debug] [MainThread]: On master: BEGIN
[0m16:47:10.948770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:10.964392 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m16:47:10.964392 [debug] [MainThread]: On master: COMMIT
[0m16:47:10.964392 [debug] [MainThread]: Using duckdb connection "master"
[0m16:47:10.964392 [debug] [MainThread]: On master: COMMIT
[0m16:47:10.980012 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:47:10.980012 [debug] [MainThread]: On master: Close
[0m16:47:10.980012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:10.980012 [info ] [MainThread]: 
[0m16:47:10.980012 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:47:10.980012 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:47:10.995632 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:47:10.995632 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:47:11.011272 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:47:11.011272 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:47:11.089384 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:47:11.089384 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:47:11.089384 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:47:11.089384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:47:11.104992 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:47:11.104992 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:47:11.104992 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from source_data.aircrafts
    );
  
  
[0m16:47:11.183107 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from source_data.aircrafts
    );
  
  
[0m16:47:11.183107 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:47:11.183107 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m16:47:11.183107 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m16:47:11.183107 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:47:11.198713 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircrafts does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from source_data.aircrafts
                ^
[0m16:47:11.198713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22728B610>]}
[0m16:47:11.214333 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.20s]
[0m16:47:11.214333 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:47:11.214333 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:47:11.214333 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:47:11.214333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:47:11.214333 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:47:11.229954 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:47:11.229954 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:47:11.245575 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:47:11.245575 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:47:11.245575 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:47:11.245575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:11.261173 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:47:11.261173 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:47:11.261173 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:47:11.323651 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:47:11.323651 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:47:11.323651 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:47:11.339274 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:47:11.339274 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:47:11.354939 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:47:11.354939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2278EBC10>]}
[0m16:47:11.354939 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.14s]
[0m16:47:11.354939 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:47:11.354939 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:47:11.354939 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:47:11.354939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:47:11.354939 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:47:11.370536 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:47:11.370536 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:47:11.370536 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:47:11.370536 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:47:11.386217 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:47:11.386217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:11.401753 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:47:11.401753 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:47:11.401753 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:47:11.464234 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:47:11.464234 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:47:11.464234 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:47:11.479890 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:47:11.479890 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:47:11.495500 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:47:11.495500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2278F5690>]}
[0m16:47:11.495500 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.14s]
[0m16:47:11.495500 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:47:11.495500 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:47:11.495500 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:47:11.495500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:47:11.495500 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:47:11.511116 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:47:11.511116 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:47:11.511116 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:47:11.526735 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:47:11.526735 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:47:11.526735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:11.542336 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:47:11.542336 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:47:11.542336 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:47:11.604850 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:47:11.620471 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:47:11.620471 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:47:11.620471 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:47:11.620471 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:47:11.636076 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:47:11.636076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2278F5F10>]}
[0m16:47:11.636076 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.14s]
[0m16:47:11.636076 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:47:11.636076 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:47:11.636076 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:47:11.636076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:47:11.636076 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:47:11.651707 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:47:11.651707 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:47:11.651707 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:47:11.667315 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:47:11.667315 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:47:11.667315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:11.682941 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:47:11.682941 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:47:11.682941 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:47:11.698825 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:47:11.698825 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:47:11.698825 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:47:11.698825 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:47:11.698825 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:47:11.714452 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:47:11.714452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76031378-f26f-4640-b9e9-f6ca6ab4cedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2278B3450>]}
[0m16:47:11.714452 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.08s]
[0m16:47:11.730072 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:47:11.730072 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:47:11.730072 [info ] [Thread-1 (]: 6 of 15 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m16:47:11.730072 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:47:11.730072 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:47:11.730072 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:47:11.730072 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:47:11.730072 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:47:11.730072 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:47:11.745696 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:47:11.745696 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:47:11.745696 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m16:47:11.745696 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:47:11.745696 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:47:11.745696 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:47:11.761312 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:47:11.761312 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:47:11.761312 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:47:11.761312 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:47:11.761312 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:47:11.761312 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:47:11.776933 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:47:11.776933 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:47:11.776933 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:47:11.776933 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:47:11.776933 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:47:11.776933 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:47:11.776933 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:47:11.792551 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:47:11.792551 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:47:11.792551 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:47:11.792551 [debug] [MainThread]: Using duckdb connection "master"
[0m16:47:11.792551 [debug] [MainThread]: On master: BEGIN
[0m16:47:11.792551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:11.814472 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m16:47:11.824002 [debug] [MainThread]: On master: COMMIT
[0m16:47:11.824002 [debug] [MainThread]: Using duckdb connection "master"
[0m16:47:11.824002 [debug] [MainThread]: On master: COMMIT
[0m16:47:11.824002 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:47:11.824002 [debug] [MainThread]: On master: Close
[0m16:47:11.824002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:11.824002 [debug] [MainThread]: Connection 'create_dev_main_stage' was properly closed.
[0m16:47:11.824002 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m16:47:11.824002 [debug] [MainThread]: Connection 'model.lufthansa.passengers_raw' was properly closed.
[0m16:47:11.824002 [info ] [MainThread]: 
[0m16:47:11.839648 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m16:47:11.839648 [debug] [MainThread]: Command end result
[0m16:47:12.011780 [info ] [MainThread]: 
[0m16:47:12.012806 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:47:12.012806 [info ] [MainThread]: 
[0m16:47:12.012806 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircrafts does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from source_data.aircrafts
                ^
[0m16:47:12.012806 [info ] [MainThread]: 
[0m16:47:12.012806 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:47:12.012806 [info ] [MainThread]: 
[0m16:47:12.012806 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:47:12.012806 [info ] [MainThread]: 
[0m16:47:12.012806 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:47:12.012806 [info ] [MainThread]: 
[0m16:47:12.012806 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:47:12.012806 [info ] [MainThread]: 
[0m16:47:12.027332 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=10 TOTAL=15
[0m16:47:12.027332 [debug] [MainThread]: Command `dbt run` failed at 16:47:12.027332 after 4.16 seconds
[0m16:47:12.027332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D21F99D990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D21F99D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2277A71D0>]}
[0m16:47:12.027332 [debug] [MainThread]: Flushing usage events
[0m16:48:23.147294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C39A20D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C39AD0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C39AD450>]}


============================== 16:48:23.162917 | 7b2e39cc-3ca8-45c1-89ab-563688845f0b ==============================
[0m16:48:23.162917 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:48:23.162917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:48:23.601016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C3A55AD0>]}
[0m16:48:23.710333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C0E49C50>]}
[0m16:48:23.725980 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:48:23.741561 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:48:24.053962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:48:24.053962 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\aircrafts_raw.sql
[0m16:48:24.531328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C4FFBB10>]}
[0m16:48:24.746481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C50B6FD0>]}
[0m16:48:24.746481 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m16:48:24.746481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C5022290>]}
[0m16:48:24.754467 [info ] [MainThread]: 
[0m16:48:24.758459 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:48:24.770529 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:48:24.957993 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:48:24.957993 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:48:24.957993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:24.989235 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m16:48:24.989235 [debug] [ThreadPool]: On list_dev: Close
[0m16:48:24.989235 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:48:24.989235 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:48:24.989235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.020490 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:48:25.020490 [debug] [ThreadPool]: On list_dev: Close
[0m16:48:25.036091 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:48:25.036091 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:48:25.036091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.051721 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:48:25.051721 [debug] [ThreadPool]: On list_dev: Close
[0m16:48:25.067332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_raw)
[0m16:48:25.067332 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:48:25.082954 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:48:25.082954 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:48:25.082954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.098588 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:48:25.098588 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:48:25.098588 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:48:25.098588 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:48:25.098588 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:48:25.098588 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:48:25.098588 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:48:25.098588 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:48:25.114193 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:48:25.114193 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:48:25.114193 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:48:25.114193 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:48:25.114193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_stage)
[0m16:48:25.114193 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:48:25.114193 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:48:25.129813 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:48:25.129813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.145432 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:48:25.145432 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:48:25.145432 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:48:25.145432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:48:25.145432 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:48:25.145432 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:48:25.145432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:48:25.145432 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:48:25.145432 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:48:25.161058 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:48:25.161058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:48:25.161058 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:48:25.161058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_mart)
[0m16:48:25.161058 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:48:25.161058 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:48:25.161058 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:48:25.161058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.192292 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:48:25.192292 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:48:25.192292 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:48:25.192292 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:48:25.192292 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:48:25.192292 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:48:25.192292 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:48:25.192292 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:48:25.192292 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:48:25.192292 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:48:25.207892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:48:25.207892 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:48:25.207892 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_raw'
[0m16:48:25.223533 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:48:25.223533 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:48:25.223533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:25.239155 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:48:25.239155 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:48:25.239155 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:48:25.317269 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m16:48:25.317269 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:48:25.332886 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:48:25.332886 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:48:25.332886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main)
[0m16:48:25.348494 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:48:25.348494 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:48:25.348494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.364094 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m16:48:25.364094 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:48:25.364094 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:48:25.442192 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m16:48:25.442192 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:48:25.442192 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:48:25.442192 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:48:25.458889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_stage)
[0m16:48:25.459914 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:48:25.459914 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:48:25.459914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.473922 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:48:25.473922 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:48:25.489551 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:48:25.573517 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m16:48:25.573517 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:48:25.573517 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:48:25.573517 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:48:25.583525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_mart)
[0m16:48:25.583525 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:48:25.583525 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:48:25.583525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.614794 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:48:25.614794 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:48:25.614794 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:48:25.692895 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m16:48:25.692895 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:48:25.692895 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:48:25.692895 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:48:25.692895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C39FA850>]}
[0m16:48:25.708494 [debug] [MainThread]: Using duckdb connection "master"
[0m16:48:25.708494 [debug] [MainThread]: On master: BEGIN
[0m16:48:25.708494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:25.724116 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m16:48:25.724116 [debug] [MainThread]: On master: COMMIT
[0m16:48:25.724116 [debug] [MainThread]: Using duckdb connection "master"
[0m16:48:25.724116 [debug] [MainThread]: On master: COMMIT
[0m16:48:25.724116 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:48:25.724116 [debug] [MainThread]: On master: Close
[0m16:48:25.724116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:48:25.739734 [info ] [MainThread]: 
[0m16:48:25.739734 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:48:25.739734 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:48:25.739734 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:48:25.739734 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:48:25.756890 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:48:25.771434 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:48:25.833926 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:48:25.849543 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:48:25.849543 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:48:25.849543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:25.871358 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:48:25.871358 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:48:25.871358 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from airlines_lufthansa.aircrafts
    );
  
  
[0m16:48:25.927772 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from airlines_lufthansa.aircrafts
    );
  
  
[0m16:48:25.927772 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:48:25.943389 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m16:48:25.943389 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m16:48:25.943389 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:48:25.958975 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircrafts does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from airlines_lufthansa.aircrafts
                ^
[0m16:48:25.958975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C55E1210>]}
[0m16:48:25.974618 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.22s]
[0m16:48:25.974618 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:48:25.974618 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:48:25.974618 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:48:25.974618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:48:25.990216 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:48:25.990216 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:48:25.990216 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:48:26.005837 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:48:26.005837 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:48:26.021456 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:48:26.021456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:26.037078 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m16:48:26.037078 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:48:26.037078 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:48:26.099591 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:48:26.099591 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:48:26.099591 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:48:26.115211 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:48:26.115211 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:48:26.130823 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:48:26.130823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C4DE8AD0>]}
[0m16:48:26.130823 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.16s]
[0m16:48:26.130823 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:48:26.130823 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:48:26.130823 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:48:26.130823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:48:26.130823 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:48:26.146441 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:48:26.146441 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:48:26.146441 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:48:26.162046 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:48:26.162046 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:48:26.162046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:26.177680 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:48:26.177680 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:48:26.177680 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:48:26.240136 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:48:26.255778 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:48:26.255778 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:48:26.255778 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:48:26.255778 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:48:26.271404 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:48:26.271404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C39A3690>]}
[0m16:48:26.271404 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.14s]
[0m16:48:26.271404 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:48:26.271404 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:48:26.271404 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:48:26.271404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:48:26.271404 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:48:26.287062 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:48:26.295456 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:48:26.300593 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:48:26.303134 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:48:26.303134 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:48:26.303134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:26.318783 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:48:26.318783 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:48:26.318783 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:48:26.381273 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:48:26.396897 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:48:26.396897 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:48:26.396897 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:48:26.396897 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:48:26.412509 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:48:26.412509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C54BBE50>]}
[0m16:48:26.412509 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.14s]
[0m16:48:26.412509 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:48:26.412509 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:48:26.412509 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:48:26.412509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:48:26.428134 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:48:26.428134 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:48:26.428134 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:48:26.443743 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:48:26.443743 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:48:26.443743 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:48:26.443743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:26.459343 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:48:26.459343 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:48:26.459343 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:48:26.459343 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:48:26.459343 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:48:26.474982 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:48:26.474982 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:48:26.474982 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:48:26.490604 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:48:26.490604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2e39cc-3ca8-45c1-89ab-563688845f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C3CC5F90>]}
[0m16:48:26.490604 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.08s]
[0m16:48:26.490604 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:48:26.490604 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:48:26.490604 [info ] [Thread-1 (]: 6 of 15 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m16:48:26.490604 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:48:26.490604 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:48:26.490604 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:48:26.490604 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:48:26.490604 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:48:26.506201 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:48:26.506201 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:48:26.506201 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:48:26.506201 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m16:48:26.506201 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:48:26.506201 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:48:26.506201 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:48:26.506201 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:48:26.506201 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:48:26.506201 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:48:26.506201 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:48:26.506201 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:48:26.521858 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:48:26.521858 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:48:26.521858 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:48:26.521858 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:48:26.521858 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:48:26.521858 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:48:26.521858 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:48:26.521858 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:48:26.521858 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:48:26.521858 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:48:26.521858 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:48:26.537478 [debug] [MainThread]: Using duckdb connection "master"
[0m16:48:26.537478 [debug] [MainThread]: On master: BEGIN
[0m16:48:26.537478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:26.553064 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m16:48:26.553064 [debug] [MainThread]: On master: COMMIT
[0m16:48:26.553064 [debug] [MainThread]: Using duckdb connection "master"
[0m16:48:26.553064 [debug] [MainThread]: On master: COMMIT
[0m16:48:26.553064 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:48:26.553064 [debug] [MainThread]: On master: Close
[0m16:48:26.568682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:26.568682 [debug] [MainThread]: Connection 'create_dev_main_mart' was properly closed.
[0m16:48:26.568682 [debug] [MainThread]: Connection 'list_dev_main_mart' was properly closed.
[0m16:48:26.568682 [debug] [MainThread]: Connection 'model.lufthansa.passengers_raw' was properly closed.
[0m16:48:26.568682 [info ] [MainThread]: 
[0m16:48:26.568682 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m16:48:26.568682 [debug] [MainThread]: Command end result
[0m16:48:26.646805 [info ] [MainThread]: 
[0m16:48:26.646805 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:48:26.646805 [info ] [MainThread]: 
[0m16:48:26.646805 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name aircrafts does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from airlines_lufthansa.aircrafts
                ^
[0m16:48:26.646805 [info ] [MainThread]: 
[0m16:48:26.646805 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:48:26.646805 [info ] [MainThread]: 
[0m16:48:26.646805 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:48:26.646805 [info ] [MainThread]: 
[0m16:48:26.662402 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:48:26.662402 [info ] [MainThread]: 
[0m16:48:26.662402 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:48:26.662402 [info ] [MainThread]: 
[0m16:48:26.662402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=10 TOTAL=15
[0m16:48:26.662402 [debug] [MainThread]: Command `dbt run` failed at 16:48:26.662402 after 3.66 seconds
[0m16:48:26.662402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C3A1FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0BD55E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C36FDC10>]}
[0m16:48:26.662402 [debug] [MainThread]: Flushing usage events
[0m16:49:09.975611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3100BD490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3100BD050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3100BD550>]}


============================== 16:49:09.975611 | 3c588192-7917-46ea-b703-1f97b4225626 ==============================
[0m16:49:09.975611 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:49:09.975611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:49:10.476079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3103D6810>]}
[0m16:49:10.569767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D311499D10>]}
[0m16:49:10.585424 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:49:10.601028 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:49:10.913407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:49:10.913407 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\aircrafts_raw.sql
[0m16:49:11.351199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3114CED10>]}
[0m16:49:11.554455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3117DBD50>]}
[0m16:49:11.554455 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m16:49:11.554455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3114EF190>]}
[0m16:49:11.570055 [info ] [MainThread]: 
[0m16:49:11.570055 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:49:11.585695 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:49:11.773420 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:49:11.773420 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:49:11.789049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:11.804650 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m16:49:11.820269 [debug] [ThreadPool]: On list_dev: Close
[0m16:49:11.820269 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:49:11.820269 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:49:11.820269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:11.851510 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:49:11.851510 [debug] [ThreadPool]: On list_dev: Close
[0m16:49:11.867152 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:49:11.867152 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:49:11.867152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:11.882777 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:49:11.882777 [debug] [ThreadPool]: On list_dev: Close
[0m16:49:11.898370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_mart)
[0m16:49:11.898370 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:49:11.913991 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:49:11.913991 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:49:11.913991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:11.929612 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:49:11.929612 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:49:11.929612 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:49:11.945230 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:49:11.945230 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:49:11.945230 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:49:11.945230 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:11.945230 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:49:11.945230 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:49:11.945230 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:49:11.945230 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:11.945230 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:49:11.945230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_mart, now create_dev_main_stage)
[0m16:49:11.960850 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:49:11.960850 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:49:11.960850 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:49:11.960850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:11.976494 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:49:11.976494 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:49:11.992091 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:49:11.992091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:11.992091 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:49:11.992091 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:49:11.992091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:11.992091 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:49:11.992091 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:49:11.992091 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:49:11.992091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:11.992091 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:49:12.007731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_raw)
[0m16:49:12.007731 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:49:12.007731 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:49:12.007731 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:49:12.007731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:12.023353 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:49:12.023353 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:49:12.038972 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:49:12.038972 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:12.038972 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:49:12.038972 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:49:12.038972 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:12.038972 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:49:12.038972 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:49:12.038972 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:49:12.038972 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:12.038972 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:49:12.054593 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:49:12.070191 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:49:12.070191 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:49:12.070191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:12.085853 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:49:12.085853 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:49:12.085853 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:49:12.179551 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m16:49:12.179551 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:49:12.179551 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:49:12.179551 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:49:12.179551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_mart)
[0m16:49:12.195151 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:49:12.195151 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:49:12.195151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:12.210773 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:49:12.210773 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:49:12.210773 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:49:12.289313 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m16:49:12.289313 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:49:12.289313 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:49:12.289313 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:49:12.304929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main_stage)
[0m16:49:12.304929 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:49:12.304929 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:49:12.304929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:12.336162 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:49:12.336162 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:49:12.336162 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:49:12.429875 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m16:49:12.429875 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:49:12.429875 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:49:12.429875 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:49:12.429875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_raw)
[0m16:49:12.445501 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:49:12.445501 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:49:12.445501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:12.461117 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m16:49:12.461117 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:49:12.461117 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:49:12.539197 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m16:49:12.539197 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:49:12.539197 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:49:12.539197 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:49:12.554837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D311498750>]}
[0m16:49:12.554837 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:12.554837 [debug] [MainThread]: On master: BEGIN
[0m16:49:12.554837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:12.570462 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m16:49:12.570462 [debug] [MainThread]: On master: COMMIT
[0m16:49:12.570462 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:12.570462 [debug] [MainThread]: On master: COMMIT
[0m16:49:12.570462 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:49:12.570462 [debug] [MainThread]: On master: Close
[0m16:49:12.586057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:12.586057 [info ] [MainThread]: 
[0m16:49:12.586057 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:49:12.601676 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:49:12.601676 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:49:12.601676 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:49:12.617300 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:49:12.617300 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:49:12.711038 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:49:12.711038 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:49:12.711038 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:49:12.711038 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:12.726662 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:49:12.742294 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:49:12.742294 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:49:12.804771 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:49:12.804771 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:49:12.804771 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m16:49:12.820446 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m16:49:12.820446 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:49:12.835999 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from airlines_lufthansa.raw_aircrafts
                ^
[0m16:49:12.835999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3114F7990>]}
[0m16:49:12.835999 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.23s]
[0m16:49:12.835999 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:49:12.835999 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:49:12.851600 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:49:12.851600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:49:12.851600 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:49:12.851600 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:49:12.851600 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:49:12.867220 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:49:12.867220 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:49:12.867220 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:49:12.867220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:12.884443 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m16:49:12.898972 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:49:12.898972 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:49:12.961459 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:49:12.961459 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:49:12.961459 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:49:12.977082 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:49:12.977082 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:49:12.977082 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:49:12.977082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D310108A10>]}
[0m16:49:12.993969 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.13s]
[0m16:49:12.996135 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:49:12.997733 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:49:12.998805 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:49:12.998805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:49:12.998805 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:49:12.998805 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:49:13.008812 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:49:13.008812 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:49:13.008812 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:49:13.008812 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:49:13.008812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:13.024461 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:49:13.040568 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:49:13.041595 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:49:13.103036 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:49:13.103036 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:49:13.103036 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:49:13.103036 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:49:13.103036 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:49:13.118655 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:49:13.118655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D311835F90>]}
[0m16:49:13.118655 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.12s]
[0m16:49:13.134295 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:49:13.134295 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:49:13.134295 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:49:13.134295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:49:13.134295 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:49:13.134295 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:49:13.134295 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:49:13.149916 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:49:13.149916 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:49:13.149916 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:49:13.149916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:13.165538 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:49:13.165538 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:49:13.165538 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:49:13.244082 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:49:13.244082 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:49:13.244082 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:49:13.244082 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:49:13.244082 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:49:13.259688 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:49:13.259688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D311CCB390>]}
[0m16:49:13.275308 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.13s]
[0m16:49:13.275308 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:49:13.275308 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:49:13.275308 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:49:13.275308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:49:13.275308 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:49:13.275308 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:49:13.275308 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:49:13.290927 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:49:13.290927 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:49:13.290927 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:49:13.290927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:13.306547 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:49:13.306547 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:49:13.322149 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:49:13.322149 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:49:13.322149 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:49:13.322149 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:49:13.322149 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:49:13.322149 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:49:13.337789 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:49:13.337789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c588192-7917-46ea-b703-1f97b4225626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D311BE1E50>]}
[0m16:49:13.337789 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.06s]
[0m16:49:13.337789 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:49:13.337789 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:49:13.337789 [info ] [Thread-1 (]: 6 of 15 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m16:49:13.337789 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:49:13.353388 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:49:13.353388 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:49:13.353388 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:49:13.353388 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:49:13.353388 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:49:13.353388 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:49:13.353388 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:49:13.353388 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m16:49:13.353388 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:49:13.353388 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:49:13.353388 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:49:13.353388 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:49:13.353388 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:49:13.369029 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:49:13.369029 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:49:13.369029 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:49:13.369029 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:49:13.369029 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:49:13.369029 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:49:13.369029 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:49:13.369029 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:49:13.369029 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:49:13.369029 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:49:13.369029 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:49:13.369029 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:49:13.384627 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:49:13.384627 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:49:13.384627 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:13.384627 [debug] [MainThread]: On master: BEGIN
[0m16:49:13.384627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:13.400274 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m16:49:13.400274 [debug] [MainThread]: On master: COMMIT
[0m16:49:13.400274 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:13.400274 [debug] [MainThread]: On master: COMMIT
[0m16:49:13.400274 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:49:13.415869 [debug] [MainThread]: On master: Close
[0m16:49:13.415869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:13.415869 [debug] [MainThread]: Connection 'create_dev_main_raw' was properly closed.
[0m16:49:13.415869 [debug] [MainThread]: Connection 'list_dev_main_raw' was properly closed.
[0m16:49:13.415869 [debug] [MainThread]: Connection 'model.lufthansa.passengers_raw' was properly closed.
[0m16:49:13.415869 [info ] [MainThread]: 
[0m16:49:13.415869 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m16:49:13.431489 [debug] [MainThread]: Command end result
[0m16:49:13.525210 [info ] [MainThread]: 
[0m16:49:13.525210 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:49:13.525210 [info ] [MainThread]: 
[0m16:49:13.525210 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from airlines_lufthansa.raw_aircrafts
                ^
[0m16:49:13.525210 [info ] [MainThread]: 
[0m16:49:13.525210 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:49:13.525210 [info ] [MainThread]: 
[0m16:49:13.525210 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:49:13.525210 [info ] [MainThread]: 
[0m16:49:13.525210 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:49:13.540832 [info ] [MainThread]: 
[0m16:49:13.540832 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:49:13.540832 [info ] [MainThread]: 
[0m16:49:13.540832 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=10 TOTAL=15
[0m16:49:13.540832 [debug] [MainThread]: Command `dbt run` failed at 16:49:13.540832 after 3.71 seconds
[0m16:49:13.540832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D31012F810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D309B8E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D309E5D850>]}
[0m16:49:13.540832 [debug] [MainThread]: Flushing usage events
[0m16:52:12.414917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E0EDDC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E0EDD210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E0EDD710>]}


============================== 16:52:12.430558 | 2905c6a8-b4c0-4e9e-8089-751976ea01ed ==============================
[0m16:52:12.430558 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:52:12.430558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:52:12.883969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DE79DE50>]}
[0m16:52:12.993277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DE37DE50>]}
[0m16:52:13.008895 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:52:13.024535 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:52:13.337518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:13.337518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:13.415626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E0ED23D0>]}
[0m16:52:13.618645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E2385510>]}
[0m16:52:13.618645 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m16:52:13.634302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E0C2D950>]}
[0m16:52:13.634302 [info ] [MainThread]: 
[0m16:52:13.634302 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:52:13.649910 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:52:13.837327 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:52:13.837327 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:52:13.837327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:13.868586 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m16:52:13.868586 [debug] [ThreadPool]: On list_dev: Close
[0m16:52:13.868586 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:52:13.884188 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:52:13.884188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:13.899808 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:52:13.899808 [debug] [ThreadPool]: On list_dev: Close
[0m16:52:13.915447 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:52:13.915447 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:52:13.915447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:13.931049 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:52:13.931049 [debug] [ThreadPool]: On list_dev: Close
[0m16:52:13.946666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_mart)
[0m16:52:13.946666 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:52:13.962321 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:52:13.962321 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:52:13.962321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:13.977922 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:52:13.977922 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:52:13.977922 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:52:13.977922 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:13.977922 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:52:13.977922 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:52:13.977922 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:13.993547 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:52:13.993547 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:52:13.993547 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:52:13.993547 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:13.993547 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:52:13.993547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_mart, now create_dev_main_stage)
[0m16:52:13.993547 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:52:14.009170 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:52:14.009170 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:52:14.009170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:14.024767 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:52:14.024767 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:52:14.024767 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:52:14.024767 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:14.024767 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:52:14.024767 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:52:14.024767 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:14.040408 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:52:14.040408 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:52:14.040408 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:52:14.040408 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:14.040408 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:52:14.040408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_raw)
[0m16:52:14.040408 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:52:14.056031 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:52:14.056031 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:52:14.056031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:14.071649 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:52:14.071649 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:52:14.071649 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:52:14.071649 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:14.071649 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:52:14.071649 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:52:14.071649 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:14.071649 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:52:14.087268 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:52:14.087268 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:52:14.087268 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:52:14.087268 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:52:14.087268 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_mart'
[0m16:52:14.102888 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:52:14.102888 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:52:14.102888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:14.131339 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:52:14.134346 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:52:14.134346 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:52:14.226328 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m16:52:14.230321 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:52:14.230321 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:52:14.234316 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:52:14.238334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main_stage)
[0m16:52:14.246298 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:52:14.246298 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:52:14.246298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:14.266261 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:52:14.270255 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:52:14.270255 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:52:14.350139 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m16:52:14.354148 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:52:14.354148 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:52:14.354148 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:52:14.362122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_raw)
[0m16:52:14.370109 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:52:14.370109 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:52:14.370109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:14.390078 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:52:14.394073 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:52:14.394073 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:52:14.485983 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m16:52:14.490012 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:52:14.490012 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:52:14.493981 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:52:14.505947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main)
[0m16:52:14.513936 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:52:14.513936 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:52:14.513936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:14.534239 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:52:14.538233 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:52:14.538233 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:52:14.670014 [debug] [ThreadPool]: SQL status: OK in 0.130 seconds
[0m16:52:14.674006 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:52:14.674006 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:52:14.677999 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:52:14.685986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E0FC4710>]}
[0m16:52:14.685986 [debug] [MainThread]: Using duckdb connection "master"
[0m16:52:14.685986 [debug] [MainThread]: On master: BEGIN
[0m16:52:14.689978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:14.705952 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m16:52:14.705952 [debug] [MainThread]: On master: COMMIT
[0m16:52:14.709948 [debug] [MainThread]: Using duckdb connection "master"
[0m16:52:14.709948 [debug] [MainThread]: On master: COMMIT
[0m16:52:14.709948 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:52:14.713942 [debug] [MainThread]: On master: Close
[0m16:52:14.717935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:14.721926 [info ] [MainThread]: 
[0m16:52:14.725922 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:52:14.729917 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:52:14.729917 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:52:14.733907 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:52:14.749877 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:52:14.749877 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:52:14.809357 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:52:14.826543 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:52:14.826543 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:52:14.826543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:52:14.841076 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m16:52:14.841076 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:52:14.841076 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:52:14.903591 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:52:14.903591 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:52:14.903591 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m16:52:14.919206 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m16:52:14.919206 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:52:14.941302 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from airlines_lufthansa.raw_aircrafts
                ^
[0m16:52:14.941302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E2363C90>]}
[0m16:52:14.941302 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.21s]
[0m16:52:14.941302 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:52:14.941302 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:52:14.950807 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:52:14.950807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:52:14.950807 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:52:14.950807 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:52:14.950807 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:52:14.966456 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:52:14.966456 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:52:14.966456 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:52:14.966456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:14.982074 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:52:14.982074 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:52:14.982074 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:52:15.060174 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:52:15.060174 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:52:15.060174 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:52:15.060174 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:52:15.060174 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:52:15.075774 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:52:15.075774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E0F91CD0>]}
[0m16:52:15.091394 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.12s]
[0m16:52:15.091394 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:52:15.091394 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:52:15.091394 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:52:15.091394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:52:15.091394 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:52:15.107013 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:52:15.107013 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:52:15.107013 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:52:15.122645 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:52:15.122645 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:52:15.122645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:15.138254 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m16:52:15.138254 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:52:15.138254 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:52:15.216375 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:52:15.216375 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:52:15.231996 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:52:15.231996 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:52:15.231996 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:52:15.247623 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:52:15.247623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E284BA10>]}
[0m16:52:15.247623 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.16s]
[0m16:52:15.247623 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:52:15.247623 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:52:15.247623 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:52:15.247623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:52:15.247623 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:52:15.263237 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:52:15.263237 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:52:15.263237 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:52:15.278857 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:52:15.278857 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:52:15.278857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:15.294455 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:52:15.294455 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:52:15.294455 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:52:15.356968 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:52:15.356968 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:52:15.356968 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:52:15.372588 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:52:15.372588 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:52:15.372588 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "main.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:52:15.388202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E2A91F10>]}
[0m16:52:15.388202 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.14s]
[0m16:52:15.388202 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:52:15.388202 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:52:15.388202 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:52:15.388202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:52:15.388202 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:52:15.388202 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:52:15.403796 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:52:15.403796 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:52:15.403796 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:52:15.403796 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:52:15.403796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:15.435056 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:52:15.435056 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:52:15.435056 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:52:15.435056 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:52:15.435056 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:52:15.435056 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:52:15.435056 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:52:15.435056 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:52:15.450654 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:52:15.450654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2905c6a8-b4c0-4e9e-8089-751976ea01ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E2A68DD0>]}
[0m16:52:15.450654 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.06s]
[0m16:52:15.450654 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:52:15.450654 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:52:15.450654 [info ] [Thread-1 (]: 6 of 15 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m16:52:15.466296 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:52:15.466296 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:52:15.466296 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:52:15.466296 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:52:15.466296 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:52:15.466296 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:52:15.466296 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:52:15.466296 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:52:15.466296 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m16:52:15.466296 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:52:15.466296 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:52:15.466296 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:52:15.481895 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:52:15.481895 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:52:15.481895 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:52:15.481895 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:52:15.481895 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:52:15.481895 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:52:15.481895 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:52:15.481895 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:52:15.481895 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:52:15.497526 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:52:15.497526 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:52:15.497526 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:52:15.497526 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:52:15.497526 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:52:15.497526 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:52:15.497526 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:52:15.497526 [debug] [MainThread]: Using duckdb connection "master"
[0m16:52:15.513174 [debug] [MainThread]: On master: BEGIN
[0m16:52:15.513174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:15.528792 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m16:52:15.528792 [debug] [MainThread]: On master: COMMIT
[0m16:52:15.528792 [debug] [MainThread]: Using duckdb connection "master"
[0m16:52:15.528792 [debug] [MainThread]: On master: COMMIT
[0m16:52:15.528792 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:52:15.528792 [debug] [MainThread]: On master: Close
[0m16:52:15.544376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:15.544376 [debug] [MainThread]: Connection 'create_dev_main_raw' was properly closed.
[0m16:52:15.544376 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m16:52:15.544376 [debug] [MainThread]: Connection 'model.lufthansa.passengers_raw' was properly closed.
[0m16:52:15.544376 [info ] [MainThread]: 
[0m16:52:15.544376 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m16:52:15.544376 [debug] [MainThread]: Command end result
[0m16:52:15.625398 [info ] [MainThread]: 
[0m16:52:15.625398 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:52:15.625398 [info ] [MainThread]: 
[0m16:52:15.625398 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "information_schema.referential_constraints"?
  LINE 19: from airlines_lufthansa.raw_aircrafts
                ^
[0m16:52:15.625398 [info ] [MainThread]: 
[0m16:52:15.625398 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:52:15.625398 [info ] [MainThread]: 
[0m16:52:15.641017 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:52:15.641017 [info ] [MainThread]: 
[0m16:52:15.641017 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "main.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:52:15.641017 [info ] [MainThread]: 
[0m16:52:15.641017 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:52:15.641017 [info ] [MainThread]: 
[0m16:52:15.641017 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=10 TOTAL=15
[0m16:52:15.641017 [debug] [MainThread]: Command `dbt run` failed at 16:52:15.641017 after 3.37 seconds
[0m16:52:15.641017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DA9BE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E0F4FA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E0F4FB50>]}
[0m16:52:15.641017 [debug] [MainThread]: Flushing usage events
[0m16:54:18.069159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20DF4D290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20DD25050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20DF4EE10>]}


============================== 16:54:18.084780 | 0cad35e7-85ad-42b7-8d4e-b86d535c1e99 ==============================
[0m16:54:18.084780 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:54:18.084780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:54:18.526190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20E301E90>]}
[0m16:54:18.651113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20B3EDE10>]}
[0m16:54:18.651113 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:54:18.682371 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:54:18.980140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:54:18.980140 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\aircrafts_raw.sql
[0m16:54:19.444222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20F57AF50>]}
[0m16:54:19.656088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20F66E1D0>]}
[0m16:54:19.656088 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m16:54:19.660081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20F5D6150>]}
[0m16:54:19.664078 [info ] [MainThread]: 
[0m16:54:19.668068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:54:19.688016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:54:19.889325 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:54:19.889325 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:54:19.889325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:19.904947 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m16:54:19.920566 [debug] [ThreadPool]: On list_dev: Close
[0m16:54:19.920566 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:54:19.920566 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:54:19.920566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:19.951791 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:54:19.951791 [debug] [ThreadPool]: On list_dev: Close
[0m16:54:19.951791 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:54:19.967414 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:54:19.967414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:19.983011 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:54:19.983011 [debug] [ThreadPool]: On list_dev: Close
[0m16:54:19.983011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_raw)
[0m16:54:19.998651 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:54:20.014252 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:54:20.014252 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:54:20.014252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:20.029872 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:54:20.029872 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:54:20.029872 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:54:20.029872 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:54:20.029872 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:54:20.029872 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:54:20.045491 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:54:20.045491 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:54:20.045491 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:54:20.045491 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:54:20.045491 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:54:20.045491 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:54:20.045491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_stage)
[0m16:54:20.045491 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:54:20.061132 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:54:20.061132 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:54:20.061132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:20.076752 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:54:20.076752 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:54:20.092371 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:54:20.092371 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:54:20.092371 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:54:20.092371 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:54:20.092371 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:54:20.092371 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:54:20.092371 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:54:20.092371 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:54:20.092371 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:54:20.092371 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:54:20.107971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_mart)
[0m16:54:20.107971 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:54:20.107971 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:54:20.107971 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:54:20.107971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:20.139232 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:54:20.139232 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:54:20.139232 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:54:20.139232 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:54:20.139232 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:54:20.139232 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:54:20.139232 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:54:20.139232 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:54:20.154865 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:54:20.154865 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:54:20.154865 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:54:20.154865 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:54:20.154865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_raw'
[0m16:54:20.172107 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:54:20.186113 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:54:20.186113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:20.201744 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:54:20.201744 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:54:20.201744 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:54:20.286286 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m16:54:20.286286 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:54:20.286286 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:54:20.286286 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:54:20.295791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_stage)
[0m16:54:20.295791 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:54:20.295791 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:54:20.295791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:20.311440 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m16:54:20.311440 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:54:20.311440 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:54:20.389518 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m16:54:20.405140 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:54:20.405140 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:54:20.405140 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:54:20.405140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main)
[0m16:54:20.420763 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:54:20.420763 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:54:20.420763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:20.436381 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:54:20.436381 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:54:20.436381 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:54:20.515009 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m16:54:20.515009 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:54:20.515009 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:54:20.515009 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:54:20.530626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_mart)
[0m16:54:20.530626 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:54:20.530626 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:54:20.530626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:20.561832 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:54:20.561832 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:54:20.561832 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:54:20.640038 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m16:54:20.640038 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:54:20.640038 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:54:20.640038 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:54:20.655638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20DFF2450>]}
[0m16:54:20.655638 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:20.655638 [debug] [MainThread]: On master: BEGIN
[0m16:54:20.655638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:20.671279 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m16:54:20.671279 [debug] [MainThread]: On master: COMMIT
[0m16:54:20.671279 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:20.671279 [debug] [MainThread]: On master: COMMIT
[0m16:54:20.671279 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:54:20.686897 [debug] [MainThread]: On master: Close
[0m16:54:20.686897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:20.686897 [info ] [MainThread]: 
[0m16:54:20.686897 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:54:20.702498 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:54:20.702498 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:54:20.702498 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:54:20.718116 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:54:20.718116 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:54:20.812325 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:54:20.812325 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:54:20.812325 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:54:20.812325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:20.827939 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:54:20.827939 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:54:20.827939 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from information_schema.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:54:20.906315 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from information_schema.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:54:20.906315 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:54:20.906315 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m16:54:20.921944 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m16:54:20.921944 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:54:20.937588 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "referential_constraints"?
  LINE 19: from information_schema.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
      );
    
    ...
                ^
[0m16:54:20.937588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20F393090>]}
[0m16:54:20.937588 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.24s]
[0m16:54:20.937588 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:54:20.937588 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:54:20.937588 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:54:20.953181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:54:20.953181 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:54:20.953181 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:54:20.953181 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:54:20.968805 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:54:20.968805 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:54:20.968805 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:54:20.968805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:20.984423 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:54:20.984423 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:54:20.984423 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:54:21.046935 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:54:21.062543 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:54:21.062543 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:54:21.062543 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:54:21.062543 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:54:21.078164 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:54:21.078164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20F3B8450>]}
[0m16:54:21.078164 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.12s]
[0m16:54:21.078164 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:54:21.078164 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:54:21.078164 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:54:21.078164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:54:21.078164 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:54:21.093762 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:54:21.093762 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:54:21.093762 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:54:21.109403 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:54:21.109403 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:54:21.109403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:21.125027 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:54:21.125027 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:54:21.125027 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:54:21.187505 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:54:21.187505 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:54:21.187505 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:54:21.203123 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:54:21.203123 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:54:21.218749 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:54:21.218749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20E32B290>]}
[0m16:54:21.218749 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.14s]
[0m16:54:21.218749 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:54:21.218749 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:54:21.218749 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:54:21.218749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:54:21.218749 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:54:21.234344 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:54:21.234344 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:54:21.234344 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:54:21.234344 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:54:21.234344 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:54:21.234344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:21.265604 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:54:21.265604 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:54:21.265604 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:54:21.328096 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:54:21.328096 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:54:21.328096 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:54:21.343684 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:54:21.343684 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:54:21.343684 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:54:21.343684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20F3A5190>]}
[0m16:54:21.359338 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.12s]
[0m16:54:21.359338 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:54:21.359338 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:54:21.359338 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:54:21.359338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:54:21.359338 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:54:21.359338 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:54:21.374923 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:54:21.374923 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:54:21.374923 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:54:21.374923 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:54:21.374923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:21.390544 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:54:21.406163 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:54:21.406163 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:54:21.406163 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:54:21.406163 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:54:21.406163 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:54:21.406163 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:54:21.406163 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:54:21.421804 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:54:21.421804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cad35e7-85ad-42b7-8d4e-b86d535c1e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20FB69B50>]}
[0m16:54:21.421804 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.06s]
[0m16:54:21.421804 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:54:21.421804 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:54:21.421804 [info ] [Thread-1 (]: 6 of 15 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m16:54:21.421804 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:54:21.437403 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:54:21.437403 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:54:21.437403 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:54:21.437403 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:54:21.437403 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:54:21.437403 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:54:21.437403 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:54:21.437403 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m16:54:21.437403 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:54:21.437403 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:54:21.437403 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:54:21.437403 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:54:21.437403 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:54:21.453045 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:54:21.453045 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:54:21.453045 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:54:21.453045 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:54:21.453045 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:54:21.453045 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:54:21.453045 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:54:21.453045 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:54:21.453045 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:54:21.453045 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:54:21.453045 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:54:21.453045 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:54:21.468644 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:54:21.468644 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:54:21.468644 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:21.468644 [debug] [MainThread]: On master: BEGIN
[0m16:54:21.468644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:21.484285 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m16:54:21.484285 [debug] [MainThread]: On master: COMMIT
[0m16:54:21.484285 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:21.484285 [debug] [MainThread]: On master: COMMIT
[0m16:54:21.484285 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:54:21.484285 [debug] [MainThread]: On master: Close
[0m16:54:21.499904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:21.499904 [debug] [MainThread]: Connection 'create_dev_main_mart' was properly closed.
[0m16:54:21.499904 [debug] [MainThread]: Connection 'list_dev_main_mart' was properly closed.
[0m16:54:21.499904 [debug] [MainThread]: Connection 'model.lufthansa.passengers_raw' was properly closed.
[0m16:54:21.499904 [info ] [MainThread]: 
[0m16:54:21.499904 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m16:54:21.499904 [debug] [MainThread]: Command end result
[0m16:54:21.579821 [info ] [MainThread]: 
[0m16:54:21.579821 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:54:21.594330 [info ] [MainThread]: 
[0m16:54:21.594330 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "referential_constraints"?
  LINE 19: from information_schema.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
      );
    
    ...
                ^
[0m16:54:21.594330 [info ] [MainThread]: 
[0m16:54:21.594330 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.pg_catalog.pg_constraint"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:54:21.594330 [info ] [MainThread]: 
[0m16:54:21.594330 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "information_schema.columns"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:54:21.594330 [info ] [MainThread]: 
[0m16:54:21.594330 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.sqlite_schema"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:54:21.594330 [info ] [MainThread]: 
[0m16:54:21.594330 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:54:21.594330 [info ] [MainThread]: 
[0m16:54:21.609980 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=10 TOTAL=15
[0m16:54:21.609980 [debug] [MainThread]: Command `dbt run` failed at 16:54:21.609980 after 3.68 seconds
[0m16:54:21.609980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20DFBF950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A207AFE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20DF4E110>]}
[0m16:54:21.609980 [debug] [MainThread]: Flushing usage events
[0m16:54:55.746917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF2F1D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF2F1C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF2F1D610>]}


============================== 16:54:55.762511 | 4792a77b-d9d3-4775-981e-163056bdba6b ==============================
[0m16:54:55.762511 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:54:55.762511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:54:56.231146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF327AF50>]}
[0m16:54:56.340455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF03BA1D0>]}
[0m16:54:56.356100 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:54:56.371716 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:54:56.684115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:56.684115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:56.762657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF44235D0>]}
[0m16:54:56.981895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF2FB5F10>]}
[0m16:54:56.981895 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m16:54:56.981895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF2FD8710>]}
[0m16:54:56.981895 [info ] [MainThread]: 
[0m16:54:56.981895 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:54:56.997494 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:54:57.200962 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:54:57.200962 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:54:57.200962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:57.232200 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m16:54:57.232200 [debug] [ThreadPool]: On list_dev: Close
[0m16:54:57.232200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:54:57.232200 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:54:57.263441 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:54:57.263441 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:54:57.263441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:57.279083 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:54:57.279083 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:54:57.279083 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:54:57.279083 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:54:57.279083 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:54:57.279083 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:54:57.279083 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:54:57.279083 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:54:57.294701 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:54:57.294701 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:54:57.294701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:54:57.294701 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:54:57.294701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:54:57.310301 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:54:57.310301 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:54:57.310301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:57.325921 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:54:57.325921 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:54:57.341541 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:54:57.404019 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m16:54:57.419641 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:54:57.419641 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:54:57.419641 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:54:57.419641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_mart)
[0m16:54:57.435261 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:54:57.435261 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:54:57.435261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:57.450883 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:54:57.450883 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:54:57.450883 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:54:57.528982 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m16:54:57.528982 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:54:57.528982 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:54:57.528982 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:54:57.544640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main_raw)
[0m16:54:57.544640 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:54:57.544640 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:54:57.544640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:57.575843 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:54:57.575843 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:54:57.575843 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:54:57.653943 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m16:54:57.653943 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:54:57.653943 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:54:57.653943 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:54:57.653943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_stage)
[0m16:54:57.669563 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:54:57.669563 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:54:57.669563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:57.685185 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:54:57.685185 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:54:57.685185 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:54:57.763285 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m16:54:57.763285 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:54:57.763285 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:54:57.763285 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:54:57.778902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF2FC8FD0>]}
[0m16:54:57.778902 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:57.778902 [debug] [MainThread]: On master: BEGIN
[0m16:54:57.778902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:57.794546 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m16:54:57.794546 [debug] [MainThread]: On master: COMMIT
[0m16:54:57.794546 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:57.794546 [debug] [MainThread]: On master: COMMIT
[0m16:54:57.794546 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:54:57.810164 [debug] [MainThread]: On master: Close
[0m16:54:57.810164 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:57.810164 [info ] [MainThread]: 
[0m16:54:57.810164 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_aircrafts
[0m16:54:57.810164 [info ] [Thread-1 (]: 1 of 5 START seed file main.raw_aircrafts ...................................... [RUN]
[0m16:54:57.825763 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.lufthansa.raw_aircrafts'
[0m16:54:57.825763 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_aircrafts
[0m16:54:57.825763 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_aircrafts
[0m16:54:57.888675 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m16:54:57.888675 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: BEGIN
[0m16:54:57.888675 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:57.904255 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:54:57.919876 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m16:54:57.919876 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_aircrafts"} */

    create table "dev"."main"."raw_aircrafts" ("aircraft_id" text,"aircraft_model" text,"capacity" integer,"manufacturer" text,"in_service_date" date)
  
[0m16:54:57.919876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:54:57.935518 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m16:54:57.951150 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: 
          COPY "dev"."main"."raw_aircrafts" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_aircrafts.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:54:57.966749 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m16:54:57.966749 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_aircrafts"
[0m16:54:58.013596 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: COMMIT
[0m16:54:58.013596 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m16:54:58.013596 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: COMMIT
[0m16:54:58.029215 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:54:58.029215 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: Close
[0m16:54:58.044834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF48C48D0>]}
[0m16:54:58.044834 [info ] [Thread-1 (]: 1 of 5 OK loaded seed file main.raw_aircrafts .................................. [[32mINSERT 10[0m in 0.22s]
[0m16:54:58.044834 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_aircrafts
[0m16:54:58.044834 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_airports
[0m16:54:58.044834 [info ] [Thread-1 (]: 2 of 5 START seed file main.raw_airports ....................................... [RUN]
[0m16:54:58.060456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_aircrafts, now seed.lufthansa.raw_airports)
[0m16:54:58.060456 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_airports
[0m16:54:58.060456 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_airports
[0m16:54:58.060456 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m16:54:58.060456 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: BEGIN
[0m16:54:58.076076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:58.091696 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m16:54:58.107341 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m16:54:58.107341 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_airports"} */

    create table "dev"."main"."raw_airports" ("airport_code" text,"airport_name" text,"city" text,"country" text,"timezone" text)
  
[0m16:54:58.107341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:54:58.107341 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m16:54:58.107341 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: 
          COPY "dev"."main"."raw_airports" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_airports.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:54:58.107341 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:54:58.107341 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_airports"
[0m16:54:58.122957 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: COMMIT
[0m16:54:58.122957 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m16:54:58.122957 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: COMMIT
[0m16:54:58.122957 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:54:58.122957 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: Close
[0m16:54:58.154175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF48C7510>]}
[0m16:54:58.154175 [info ] [Thread-1 (]: 2 of 5 OK loaded seed file main.raw_airports ................................... [[32mINSERT 15[0m in 0.09s]
[0m16:54:58.154175 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_airports
[0m16:54:58.154175 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_bookings
[0m16:54:58.154175 [info ] [Thread-1 (]: 3 of 5 START seed file main.raw_bookings ....................................... [RUN]
[0m16:54:58.154175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_airports, now seed.lufthansa.raw_bookings)
[0m16:54:58.154175 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_bookings
[0m16:54:58.169798 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_bookings
[0m16:54:58.169798 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m16:54:58.169798 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: BEGIN
[0m16:54:58.185438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:58.201037 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m16:54:58.201037 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m16:54:58.216656 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_bookings"} */

    create table "dev"."main"."raw_bookings" ("booking_id" integer,"flight_id" integer,"passenger_id" integer,"booking_date" date,"booking_status" text,"price" integer)
  
[0m16:54:58.216656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:54:58.216656 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m16:54:58.216656 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: 
          COPY "dev"."main"."raw_bookings" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_bookings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:54:58.216656 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:54:58.216656 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_bookings"
[0m16:54:58.232277 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: COMMIT
[0m16:54:58.232277 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m16:54:58.232277 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: COMMIT
[0m16:54:58.232277 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:54:58.232277 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: Close
[0m16:54:58.247895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF4938190>]}
[0m16:54:58.263541 [info ] [Thread-1 (]: 3 of 5 OK loaded seed file main.raw_bookings ................................... [[32mINSERT 20[0m in 0.09s]
[0m16:54:58.263541 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_bookings
[0m16:54:58.263541 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_flights
[0m16:54:58.263541 [info ] [Thread-1 (]: 4 of 5 START seed file main.raw_flights ........................................ [RUN]
[0m16:54:58.263541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_bookings, now seed.lufthansa.raw_flights)
[0m16:54:58.263541 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_flights
[0m16:54:58.279138 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_flights
[0m16:54:58.294760 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m16:54:58.294760 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: BEGIN
[0m16:54:58.294760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:58.341616 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m16:54:58.341616 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m16:54:58.341616 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_flights"} */

    create table "dev"."main"."raw_flights" ("flight_id" integer,"flight_number" text,"origin_airport_code" text,"destination_airport_code" text,"scheduled_departure_time" timestamp without time zone,"scheduled_arrival_time" timestamp without time zone,"actual_departure_time" timestamp without time zone,"actual_arrival_time" timestamp without time zone,"aircraft_id" text,"status" text)
  
[0m16:54:58.341616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:54:58.341616 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m16:54:58.341616 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: 
          COPY "dev"."main"."raw_flights" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_flights.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:54:58.357238 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:54:58.357238 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_flights"
[0m16:54:58.357238 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: COMMIT
[0m16:54:58.357238 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m16:54:58.357238 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: COMMIT
[0m16:54:58.372858 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:54:58.372858 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: Close
[0m16:54:58.388479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF44BA790>]}
[0m16:54:58.388479 [info ] [Thread-1 (]: 4 of 5 OK loaded seed file main.raw_flights .................................... [[32mINSERT 15[0m in 0.12s]
[0m16:54:58.404097 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_flights
[0m16:54:58.404097 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_passengers
[0m16:54:58.404097 [info ] [Thread-1 (]: 5 of 5 START seed file main.raw_passengers ..................................... [RUN]
[0m16:54:58.404097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_flights, now seed.lufthansa.raw_passengers)
[0m16:54:58.404097 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_passengers
[0m16:54:58.404097 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_passengers
[0m16:54:58.419718 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m16:54:58.419718 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: BEGIN
[0m16:54:58.419718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:58.450978 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m16:54:58.450978 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m16:54:58.450978 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_passengers"} */

    create table "dev"."main"."raw_passengers" ("passenger_id" integer,"first_name" text,"last_name" text,"date_of_birth" date,"email" text,"phone_number" text)
  
[0m16:54:58.450978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:54:58.450978 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m16:54:58.450978 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: 
          COPY "dev"."main"."raw_passengers" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_passengers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:54:58.466579 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:54:58.466579 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_passengers"
[0m16:54:58.466579 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: COMMIT
[0m16:54:58.466579 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m16:54:58.466579 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: COMMIT
[0m16:54:58.466579 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:54:58.482197 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: Close
[0m16:54:58.497818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792a77b-d9d3-4775-981e-163056bdba6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF488BF90>]}
[0m16:54:58.497818 [info ] [Thread-1 (]: 5 of 5 OK loaded seed file main.raw_passengers ................................. [[32mINSERT 20[0m in 0.09s]
[0m16:54:58.497818 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_passengers
[0m16:54:58.513438 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:58.513438 [debug] [MainThread]: On master: BEGIN
[0m16:54:58.513438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:58.544680 [debug] [MainThread]: SQL status: OK in 0.029 seconds
[0m16:54:58.544680 [debug] [MainThread]: On master: COMMIT
[0m16:54:58.544680 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:58.544680 [debug] [MainThread]: On master: COMMIT
[0m16:54:58.544680 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:54:58.544680 [debug] [MainThread]: On master: Close
[0m16:54:58.544680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:58.544680 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m16:54:58.544680 [debug] [MainThread]: Connection 'list_dev_main_stage' was properly closed.
[0m16:54:58.544680 [debug] [MainThread]: Connection 'seed.lufthansa.raw_passengers' was properly closed.
[0m16:54:58.544680 [info ] [MainThread]: 
[0m16:54:58.560297 [info ] [MainThread]: Finished running 5 seeds in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m16:54:58.560297 [debug] [MainThread]: Command end result
[0m16:54:58.623322 [info ] [MainThread]: 
[0m16:54:58.623322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:58.623322 [info ] [MainThread]: 
[0m16:54:58.638950 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:54:58.638950 [debug] [MainThread]: Command `dbt seed` succeeded at 16:54:58.638950 after 3.03 seconds
[0m16:54:58.638950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CF2F639D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CECA7E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CECABB610>]}
[0m16:54:58.638950 [debug] [MainThread]: Flushing usage events
[0m16:55:16.538376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA7680F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA7680EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA7680D590>]}


============================== 16:55:16.538376 | f90d52a6-4e6c-4bbc-9c44-ba6e658080c7 ==============================
[0m16:55:16.538376 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:55:16.538376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:17.007012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA76897F50>]}
[0m16:55:17.100734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA73CADD50>]}
[0m16:55:17.116356 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:55:17.131963 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:55:17.429469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:17.429469 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:17.507580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA77D0C050>]}
[0m16:55:17.710599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA741C9A90>]}
[0m16:55:17.710599 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m16:55:17.710599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA77DFA810>]}
[0m16:55:17.710599 [info ] [MainThread]: 
[0m16:55:17.710599 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:55:17.726217 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:55:17.913695 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:55:17.913695 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:55:17.913695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:17.944933 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m16:55:17.944933 [debug] [ThreadPool]: On list_dev: Close
[0m16:55:17.960519 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:55:17.960519 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:55:17.960519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:17.976161 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:55:17.991759 [debug] [ThreadPool]: On list_dev: Close
[0m16:55:17.991759 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:55:17.991759 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:55:17.991759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:18.023000 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m16:55:18.023000 [debug] [ThreadPool]: On list_dev: Close
[0m16:55:18.038644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_stage)
[0m16:55:18.038644 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:55:18.054261 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:55:18.054261 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:55:18.054261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:18.069883 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:55:18.069883 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:55:18.069883 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:55:18.069883 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:18.069883 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:55:18.069883 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:55:18.085505 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:18.085505 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:55:18.085505 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:55:18.085505 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:55:18.085505 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:18.085505 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:55:18.085505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_raw)
[0m16:55:18.085505 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:55:18.101121 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:55:18.101121 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:55:18.101121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:18.116744 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:55:18.116744 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:55:18.116744 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:55:18.116744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:18.116744 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:55:18.132360 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:55:18.132360 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:55:18.132360 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:55:18.132360 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:55:18.132360 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:55:18.132360 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:18.132360 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:55:18.132360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_mart)
[0m16:55:18.147960 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:55:18.147960 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:55:18.147960 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:55:18.147960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:18.163601 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:55:18.163601 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:55:18.179220 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:55:18.179220 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:18.179220 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:55:18.179220 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:55:18.179220 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:18.179220 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:55:18.179220 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:55:18.179220 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:55:18.179220 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:18.179220 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:55:18.194840 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_stage'
[0m16:55:18.210455 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:55:18.210455 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:55:18.210455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:18.226104 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:55:18.226104 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:55:18.226104 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:55:18.304184 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m16:55:18.304184 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:55:18.304184 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:55:18.304184 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:55:18.319820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main)
[0m16:55:18.319820 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:55:18.319820 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:55:18.319820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:18.351042 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:55:18.351042 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:55:18.351042 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:55:18.429167 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m16:55:18.429167 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:55:18.429167 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:55:18.429167 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:55:18.444759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_raw)
[0m16:55:18.444759 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:55:18.444759 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:55:18.444759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:18.476003 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:55:18.476003 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:55:18.476003 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:55:18.554227 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m16:55:18.554227 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:55:18.554227 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:55:18.554227 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:55:18.554227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_mart)
[0m16:55:18.569868 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:55:18.569868 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:55:18.569868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:18.585491 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:55:18.585491 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:55:18.585491 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:55:18.663682 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m16:55:18.679318 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:55:18.679318 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:55:18.679318 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:55:18.679318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA780B75D0>]}
[0m16:55:18.679318 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:18.679318 [debug] [MainThread]: On master: BEGIN
[0m16:55:18.679318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:18.710523 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m16:55:18.710523 [debug] [MainThread]: On master: COMMIT
[0m16:55:18.710523 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:18.710523 [debug] [MainThread]: On master: COMMIT
[0m16:55:18.710523 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:18.710523 [debug] [MainThread]: On master: Close
[0m16:55:18.710523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:18.726142 [info ] [MainThread]: 
[0m16:55:18.726142 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:55:18.726142 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:55:18.726142 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:55:18.726142 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:55:18.748410 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:55:18.748410 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:55:18.820282 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:55:18.820282 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:55:18.820282 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:55:18.820282 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:18.851522 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:55:18.851522 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:55:18.851522 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from information_schema.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:55:18.914000 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from information_schema.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:55:18.914000 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:55:18.914000 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m16:55:18.929622 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m16:55:18.929622 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:55:18.945232 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "dev.raw_aircrafts"?
  LINE 19: from information_schema.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
      );
    
    ...
                ^
[0m16:55:18.945232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA77DFBAD0>]}
[0m16:55:18.945232 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.22s]
[0m16:55:18.945232 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:55:18.945232 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:55:18.945232 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:55:18.960827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:55:18.960827 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:55:18.960827 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:55:18.960827 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:55:18.976467 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:55:18.976467 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:55:18.976467 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:55:18.976467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:18.992090 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:55:19.007686 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:55:19.007686 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:55:19.070448 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:55:19.070448 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:55:19.086064 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:55:19.086064 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:55:19.086064 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:55:19.101685 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.raw_airports"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:55:19.101685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA7564D150>]}
[0m16:55:19.101685 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.16s]
[0m16:55:19.101685 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:55:19.101685 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:55:19.117341 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:55:19.117341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:55:19.117341 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:55:19.117341 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:55:19.117341 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:55:19.137553 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:55:19.137553 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:55:19.137553 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:55:19.137553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:19.164964 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:55:19.168912 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:55:19.168912 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:55:19.240792 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:55:19.240792 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:55:19.244806 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:55:19.248780 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:55:19.252772 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:55:19.260891 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "dev.raw_bookings"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:55:19.264883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA77E2D310>]}
[0m16:55:19.264883 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.15s]
[0m16:55:19.268900 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:55:19.268900 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:55:19.268900 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:55:19.272892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:55:19.272892 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:55:19.284852 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:55:19.284852 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:55:19.300833 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:55:19.304817 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:55:19.304817 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:55:19.304817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:19.324805 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:55:19.328798 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:55:19.328798 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:55:19.397033 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:55:19.397033 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:55:19.397033 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:55:19.405017 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:55:19.405017 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:55:19.416977 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.raw_flights"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:55:19.416977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA783ACBD0>]}
[0m16:55:19.416977 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.14s]
[0m16:55:19.420971 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:55:19.420971 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:55:19.424975 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:55:19.424975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:55:19.428994 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:55:19.432988 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:55:19.436967 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:55:19.444952 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:55:19.444952 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:55:19.450632 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:55:19.452216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:19.472843 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m16:55:19.476816 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:55:19.476816 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:55:19.476816 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:55:19.480833 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:55:19.480833 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:55:19.488816 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:55:19.488816 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:55:19.496804 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:55:19.500796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90d52a6-4e6c-4bbc-9c44-ba6e658080c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA7839D4D0>]}
[0m16:55:19.500796 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.08s]
[0m16:55:19.503694 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:55:19.505224 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:55:19.505224 [info ] [Thread-1 (]: 6 of 15 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m16:55:19.505224 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:55:19.509224 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:55:19.513219 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:55:19.513219 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:55:19.517212 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:55:19.517212 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:55:19.521225 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:55:19.521225 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:55:19.521225 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m16:55:19.525222 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:55:19.525222 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:55:19.525222 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:55:19.529191 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:55:19.529191 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:55:19.533225 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:55:19.533225 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:55:19.533225 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:55:19.537198 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:55:19.537198 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:55:19.537198 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:55:19.541189 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:55:19.541189 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:55:19.541189 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:55:19.541189 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:55:19.545187 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:55:19.549158 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:55:19.549158 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:55:19.553171 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:55:19.553171 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:19.557145 [debug] [MainThread]: On master: BEGIN
[0m16:55:19.557145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:19.581129 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m16:55:19.581129 [debug] [MainThread]: On master: COMMIT
[0m16:55:19.585099 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:19.585099 [debug] [MainThread]: On master: COMMIT
[0m16:55:19.585099 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:19.589113 [debug] [MainThread]: On master: Close
[0m16:55:19.593105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:19.593105 [debug] [MainThread]: Connection 'create_dev_main_mart' was properly closed.
[0m16:55:19.593105 [debug] [MainThread]: Connection 'list_dev_main_mart' was properly closed.
[0m16:55:19.597079 [debug] [MainThread]: Connection 'model.lufthansa.passengers_raw' was properly closed.
[0m16:55:19.597079 [info ] [MainThread]: 
[0m16:55:19.597079 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m16:55:19.601092 [debug] [MainThread]: Command end result
[0m16:55:19.672970 [info ] [MainThread]: 
[0m16:55:19.672970 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:55:19.676967 [info ] [MainThread]: 
[0m16:55:19.676967 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "dev.raw_aircrafts"?
  LINE 19: from information_schema.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
      );
    
    ...
                ^
[0m16:55:19.676967 [info ] [MainThread]: 
[0m16:55:19.680957 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "dev.raw_airports"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:55:19.680957 [info ] [MainThread]: 
[0m16:55:19.680957 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "dev.raw_bookings"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:55:19.684930 [info ] [MainThread]: 
[0m16:55:19.684930 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.raw_flights"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:55:19.684930 [info ] [MainThread]: 
[0m16:55:19.684930 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:55:19.688924 [info ] [MainThread]: 
[0m16:55:19.688924 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=10 TOTAL=15
[0m16:55:19.692920 [debug] [MainThread]: Command `dbt run` failed at 16:55:19.688924 after 3.29 seconds
[0m16:55:19.692920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA7680AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA703AE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA76BB9A90>]}
[0m16:55:19.692920 [debug] [MainThread]: Flushing usage events
[0m16:56:16.283221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A4BECF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A4BECA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A4BECD10>]}


============================== 16:56:16.294359 | 93ffe12b-ab23-4ed7-9472-0acd78ac887d ==============================
[0m16:56:16.294359 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:56:16.296467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:56:16.784255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A4C39890>]}
[0m16:56:16.881680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A2089A90>]}
[0m16:56:16.897267 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:56:16.912906 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:56:17.237774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:17.238751 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\aircrafts_raw.sql
[0m16:56:17.717150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A625A890>]}
[0m16:56:17.905180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A62BC990>]}
[0m16:56:17.905180 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m16:56:17.905180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A6025F50>]}
[0m16:56:17.920776 [info ] [MainThread]: 
[0m16:56:17.920776 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:56:17.941902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:56:18.141329 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:56:18.142321 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:56:18.143334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:18.174037 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m16:56:18.177016 [debug] [ThreadPool]: On list_dev: Close
[0m16:56:18.186582 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:56:18.187574 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:56:18.188568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:18.212409 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m16:56:18.217375 [debug] [ThreadPool]: On list_dev: Close
[0m16:56:18.226572 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:56:18.227566 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:56:18.228559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:18.242760 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:56:18.242760 [debug] [ThreadPool]: On list_dev: Close
[0m16:56:18.258409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_raw)
[0m16:56:18.258409 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:56:18.274041 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:56:18.274041 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:56:18.274041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:18.289665 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:56:18.289665 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:56:18.289665 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:56:18.289665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:18.289665 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:56:18.289665 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:56:18.289665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:18.306815 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:56:18.307787 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:56:18.308802 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:56:18.309799 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:18.310770 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:56:18.316157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_stage)
[0m16:56:18.317146 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:56:18.322112 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:56:18.323106 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:56:18.324103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:18.343963 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:56:18.346948 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:56:18.347939 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:56:18.348933 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:18.349926 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:56:18.350920 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:56:18.351918 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:18.353901 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:56:18.354893 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:56:18.355886 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:56:18.356885 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:18.357873 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:56:18.363812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_mart)
[0m16:56:18.364805 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:56:18.369773 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:56:18.370765 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:56:18.371759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:18.391625 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:56:18.394606 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:56:18.395599 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:56:18.396593 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:18.397587 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:56:18.398580 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:56:18.399573 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:18.402553 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:56:18.402553 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:56:18.403546 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:56:18.404540 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:18.405533 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:56:18.415293 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:56:18.427218 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:56:18.428208 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:56:18.429204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:18.449048 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:56:18.450043 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:56:18.452028 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:56:18.537078 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m16:56:18.537078 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:56:18.537078 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:56:18.537078 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:56:18.554170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_raw)
[0m16:56:18.554170 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:56:18.554170 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:56:18.554170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:18.589908 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:56:18.590901 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:56:18.591895 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:56:18.689348 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m16:56:18.693322 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:56:18.694316 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:56:18.696304 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:56:18.706256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_stage)
[0m16:56:18.711202 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:56:18.712197 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:56:18.714212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:18.734049 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:56:18.735042 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:56:18.736035 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:56:18.800339 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m16:56:18.815959 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:56:18.815959 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:56:18.815959 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:56:18.815959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_mart)
[0m16:56:18.815959 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:56:18.815959 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:56:18.831753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:18.851657 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:56:18.852646 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:56:18.853642 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:56:18.934065 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m16:56:18.937332 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:56:18.937332 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:56:18.937332 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:56:18.937332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A66D7890>]}
[0m16:56:18.937332 [debug] [MainThread]: Using duckdb connection "master"
[0m16:56:18.937332 [debug] [MainThread]: On master: BEGIN
[0m16:56:18.937332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:56:18.968596 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m16:56:18.968596 [debug] [MainThread]: On master: COMMIT
[0m16:56:18.968596 [debug] [MainThread]: Using duckdb connection "master"
[0m16:56:18.968596 [debug] [MainThread]: On master: COMMIT
[0m16:56:18.968596 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:56:18.968596 [debug] [MainThread]: On master: Close
[0m16:56:18.984193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:18.984193 [info ] [MainThread]: 
[0m16:56:18.984193 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:56:18.984193 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:56:18.984193 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:56:18.984193 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:56:19.012983 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:56:19.016038 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:56:19.093463 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:56:19.096431 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:56:19.097437 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:56:19.098430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:19.118297 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m16:56:19.119290 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:56:19.120284 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:56:19.125521 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:56:19.139427 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:56:19.140402 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw__dbt_tmp" rename to "aircrafts_raw"
[0m16:56:19.142397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:19.190078 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m16:56:19.192058 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:56:19.193049 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m16:56:19.197021 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:56:19.208965 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:56:19.210950 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
drop table if exists "dev"."main_raw"."aircrafts_raw__dbt_backup" cascade
[0m16:56:19.211941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:19.216910 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:56:19.245033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A682FA10>]}
[0m16:56:19.245033 [info ] [Thread-1 (]: 1 of 15 OK created sql table model main_raw.aircrafts_raw ...................... [[32mOK[0m in 0.26s]
[0m16:56:19.248998 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:56:19.248998 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:56:19.248998 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:56:19.253014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:56:19.253014 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:56:19.260999 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:56:19.260999 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:56:19.269031 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:56:19.272978 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:56:19.272978 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:56:19.272978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:19.310182 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m16:56:19.311176 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:56:19.312169 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:56:19.388734 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from airlines_lufthansa.airports
    );
  
  
[0m16:56:19.389728 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:56:19.391715 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m16:56:19.403860 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m16:56:19.403860 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:56:19.415787 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "main_raw.aircrafts_raw"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:56:19.415787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A601E850>]}
[0m16:56:19.419780 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.16s]
[0m16:56:19.419780 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:56:19.419780 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:56:19.423773 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:56:19.423773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:56:19.427767 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:56:19.431761 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:56:19.435756 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:56:19.443742 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:56:19.443742 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:56:19.447878 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:56:19.448870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:19.471737 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m16:56:19.473703 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:56:19.474695 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:56:19.551192 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from airlines_lufthansa.bookings
    );
  
  
[0m16:56:19.553196 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:56:19.554190 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m16:56:19.560150 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m16:56:19.561137 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:56:19.575029 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "dev.raw_bookings"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:56:19.576043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A666BA10>]}
[0m16:56:19.578030 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.15s]
[0m16:56:19.579999 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:56:19.581986 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:56:19.583972 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:56:19.586954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:56:19.587983 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:56:19.595891 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:56:19.597901 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:56:19.606852 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:56:19.608834 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:56:19.610811 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:56:19.610811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:19.634632 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:56:19.636617 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:56:19.637610 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:56:19.724086 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from airlines_lufthansa.flights
    );
  
  
[0m16:56:19.726072 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:56:19.727042 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m16:56:19.733996 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m16:56:19.734990 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:56:19.747903 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.raw_flights"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:56:19.749890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A4F3A510>]}
[0m16:56:19.751878 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.16s]
[0m16:56:19.753862 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:56:19.755850 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:56:19.757836 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:56:19.759847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:56:19.760817 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:56:19.767790 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:56:19.769755 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:56:19.778695 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:56:19.781675 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:56:19.783662 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:56:19.785650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:19.807502 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:56:19.809489 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:56:19.810482 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:56:19.811476 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from airlines_lufthansa.passengers
    );
  
  
[0m16:56:19.813464 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:56:19.814457 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:56:19.823416 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:56:19.825404 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:56:19.834342 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:56:19.835336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A691EE10>]}
[0m16:56:19.837325 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.08s]
[0m16:56:19.838314 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:56:19.839309 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:56:19.841297 [info ] [Thread-1 (]: 6 of 15 START sql view model main_stage.aircrafts_stg .......................... [RUN]
[0m16:56:19.842290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.aircrafts_stg)
[0m16:56:19.843283 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_stg
[0m16:56:19.849242 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_stg"
[0m16:56:19.852224 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_stg
[0m16:56:19.894922 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_stg"
[0m16:56:19.899329 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:56:19.900558 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: BEGIN
[0m16:56:19.900558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:19.916177 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m16:56:19.916177 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:56:19.916177 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */

  
  create view "dev"."main_stage"."aircrafts_stg__dbt_tmp" as (
    

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from "dev"."main_raw"."aircrafts_raw"
where in_service_date IS NOT null
  );

[0m16:56:19.916177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:19.931820 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:56:19.931820 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg__dbt_tmp" rename to "aircrafts_stg"
[0m16:56:19.931820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:19.931820 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m16:56:19.931820 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:56:19.931820 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m16:56:19.947778 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:56:19.952765 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:56:19.953758 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
drop view if exists "dev"."main_stage"."aircrafts_stg__dbt_backup" cascade
[0m16:56:19.955745 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:19.958725 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: Close
[0m16:56:19.971478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ffe12b-ab23-4ed7-9472-0acd78ac887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A68BCED0>]}
[0m16:56:19.973469 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main_stage.aircrafts_stg ..................... [[32mOK[0m in 0.13s]
[0m16:56:19.974450 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:56:19.975450 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:56:19.977417 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m16:56:19.978409 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:56:19.979411 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:56:19.980417 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m16:56:19.981410 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:56:19.982404 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:56:19.983396 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m16:56:19.984391 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:56:19.985384 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:56:19.987371 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:56:19.988363 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:56:19.989337 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:56:19.990328 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m16:56:19.991343 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:56:19.992338 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:56:19.993331 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m16:56:19.995317 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:56:19.996310 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:56:19.997309 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m16:56:19.998277 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:56:19.999290 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:56:20.000285 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m16:56:20.001277 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:56:20.002270 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:56:20.003264 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:56:20.004257 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:56:20.007237 [debug] [MainThread]: Using duckdb connection "master"
[0m16:56:20.008231 [debug] [MainThread]: On master: BEGIN
[0m16:56:20.009223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:56:20.038009 [debug] [MainThread]: SQL status: OK in 0.029 seconds
[0m16:56:20.039996 [debug] [MainThread]: On master: COMMIT
[0m16:56:20.040989 [debug] [MainThread]: Using duckdb connection "master"
[0m16:56:20.041983 [debug] [MainThread]: On master: COMMIT
[0m16:56:20.042977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:56:20.043969 [debug] [MainThread]: On master: Close
[0m16:56:20.048957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:20.049951 [debug] [MainThread]: Connection 'create_dev_main_mart' was properly closed.
[0m16:56:20.050944 [debug] [MainThread]: Connection 'list_dev_main_mart' was properly closed.
[0m16:56:20.051937 [debug] [MainThread]: Connection 'model.lufthansa.aircrafts_stg' was properly closed.
[0m16:56:20.052930 [info ] [MainThread]: 
[0m16:56:20.053903 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m16:56:20.058030 [debug] [MainThread]: Command end result
[0m16:56:20.227957 [info ] [MainThread]: 
[0m16:56:20.229910 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m16:56:20.232005 [info ] [MainThread]: 
[0m16:56:20.232926 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name airports does not exist!
  Did you mean "main_raw.aircrafts_raw"?
  LINE 19: from airlines_lufthansa.airports
                ^
[0m16:56:20.233917 [info ] [MainThread]: 
[0m16:56:20.235891 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name bookings does not exist!
  Did you mean "dev.raw_bookings"?
  LINE 20: from airlines_lufthansa.bookings
                ^
[0m16:56:20.236883 [info ] [MainThread]: 
[0m16:56:20.237876 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name flights does not exist!
  Did you mean "dev.raw_flights"?
  LINE 24: from airlines_lufthansa.flights
                ^
[0m16:56:20.238860 [info ] [MainThread]: 
[0m16:56:20.239863 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:56:20.240862 [info ] [MainThread]: 
[0m16:56:20.241850 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=9 TOTAL=15
[0m16:56:20.244829 [debug] [MainThread]: Command `dbt run` failed at 16:56:20.243840 after 4.12 seconds
[0m16:56:20.245823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59E78E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59E7D8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59EA5D8D0>]}
[0m16:56:20.246818 [debug] [MainThread]: Flushing usage events
[0m16:58:51.192262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B043C2DE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B043A01890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B043C2D950>]}


============================== 16:58:51.207891 | 46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925 ==============================
[0m16:58:51.207891 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:58:51.207891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:58:51.661318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B043CC9F50>]}
[0m16:58:51.755548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0410C9AD0>]}
[0m16:58:51.771168 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m16:58:51.786776 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:58:52.114773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m16:58:52.114773 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\airports_raw.sql
[0m16:58:52.114773 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\flights_raw.sql
[0m16:58:52.114773 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\bookings_raw.sql
[0m16:58:52.114773 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\passengers_raw.sql
[0m16:58:52.583657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04401E3D0>]}
[0m16:58:52.771791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0410D8710>]}
[0m16:58:52.771791 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m16:58:52.787537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B043F70E50>]}
[0m16:58:52.787537 [info ] [MainThread]: 
[0m16:58:52.787537 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:58:52.803016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:58:53.006867 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:58:53.006867 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:58:53.006867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:53.022512 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m16:58:53.038144 [debug] [ThreadPool]: On list_dev: Close
[0m16:58:53.038144 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:58:53.038144 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:58:53.038144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:53.069368 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:58:53.069368 [debug] [ThreadPool]: On list_dev: Close
[0m16:58:53.085006 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:58:53.085006 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:58:53.085006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:53.100612 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:58:53.100612 [debug] [ThreadPool]: On list_dev: Close
[0m16:58:53.116209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_stage)
[0m16:58:53.116209 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m16:58:53.133682 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:58:53.133682 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:58:53.133682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:53.147691 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:58:53.147691 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:58:53.147691 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m16:58:53.147691 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:58:53.163323 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:58:53.163323 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m16:58:53.163323 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:58:53.163323 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:58:53.163323 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m16:58:53.163323 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m16:58:53.163323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:58:53.163323 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m16:58:53.163323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_raw)
[0m16:58:53.163323 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m16:58:53.178963 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:58:53.178963 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:58:53.178963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:53.194565 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:58:53.194565 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:58:53.194565 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m16:58:53.210186 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:58:53.210186 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:58:53.210186 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m16:58:53.210186 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:58:53.210186 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:58:53.210186 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m16:58:53.210186 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m16:58:53.210186 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:58:53.210186 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m16:58:53.225824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_mart)
[0m16:58:53.225824 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m16:58:53.225824 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:58:53.225824 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:58:53.225824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:53.245843 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:58:53.257370 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:58:53.257370 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m16:58:53.257370 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:58:53.257370 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:58:53.257370 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m16:58:53.257370 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:58:53.257370 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:58:53.257370 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m16:58:53.257370 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m16:58:53.257370 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:58:53.257370 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m16:58:53.273018 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_stage'
[0m16:58:53.288618 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:58:53.288618 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m16:58:53.288618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:53.304238 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:58:53.304238 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m16:58:53.304238 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m16:58:53.382358 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m16:58:53.382358 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m16:58:53.382358 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m16:58:53.397997 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m16:58:53.397997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_raw)
[0m16:58:53.397997 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:58:53.397997 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m16:58:53.397997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:53.429198 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:58:53.429198 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m16:58:53.429198 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m16:58:53.507621 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m16:58:53.523242 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m16:58:53.523242 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m16:58:53.523242 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m16:58:53.523242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_mart)
[0m16:58:53.538841 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:58:53.538841 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m16:58:53.538841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:53.560961 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:58:53.560961 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m16:58:53.560961 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m16:58:53.632956 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m16:58:53.632956 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m16:58:53.648596 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m16:58:53.648596 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m16:58:53.648596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main)
[0m16:58:53.648596 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:58:53.648596 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:58:53.648596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:53.679836 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:58:53.679836 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:58:53.679836 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:58:53.759764 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m16:58:53.759764 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:58:53.759764 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:58:53.759764 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:58:53.773790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04406AA10>]}
[0m16:58:53.773790 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:53.773790 [debug] [MainThread]: On master: BEGIN
[0m16:58:53.773790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:53.789443 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m16:58:53.805060 [debug] [MainThread]: On master: COMMIT
[0m16:58:53.805060 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:53.805060 [debug] [MainThread]: On master: COMMIT
[0m16:58:53.805060 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:58:53.805060 [debug] [MainThread]: On master: Close
[0m16:58:53.805060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:53.805060 [info ] [MainThread]: 
[0m16:58:53.820698 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m16:58:53.820698 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m16:58:53.820698 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m16:58:53.820698 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m16:58:53.836282 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m16:58:53.836282 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m16:58:53.914379 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m16:58:53.914379 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:58:53.914379 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m16:58:53.930000 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:58:53.945620 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m16:58:53.945620 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:58:53.945620 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m16:58:53.945620 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:58:53.961894 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:58:53.961894 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw" rename to "aircrafts_raw__dbt_backup"
[0m16:58:53.976899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:53.976899 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:58:53.976899 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw__dbt_tmp" rename to "aircrafts_raw"
[0m16:58:53.976899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.023767 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m16:58:54.039390 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:58:54.039390 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m16:58:54.044462 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:58:54.055470 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m16:58:54.055470 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
drop table if exists "dev"."main_raw"."aircrafts_raw__dbt_backup" cascade
[0m16:58:54.055470 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:58:54.055470 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m16:58:54.086723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04586DED0>]}
[0m16:58:54.086723 [info ] [Thread-1 (]: 1 of 15 OK created sql table model main_raw.aircrafts_raw ...................... [[32mOK[0m in 0.25s]
[0m16:58:54.086723 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m16:58:54.086723 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m16:58:54.086723 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m16:58:54.086723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m16:58:54.086723 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m16:58:54.102342 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m16:58:54.102342 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m16:58:54.102342 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m16:58:54.117963 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:58:54.117963 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m16:58:54.117963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:54.151246 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m16:58:54.151246 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:58:54.153253 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m16:58:54.157256 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:58:54.161251 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:58:54.165241 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw__dbt_tmp" rename to "airports_raw"
[0m16:58:54.165241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.169236 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m16:58:54.173231 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:58:54.173231 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m16:58:54.177222 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:58:54.189201 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m16:58:54.189201 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
drop table if exists "dev"."main_raw"."airports_raw__dbt_backup" cascade
[0m16:58:54.193195 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.197198 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m16:58:54.221149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0457F0690>]}
[0m16:58:54.221149 [info ] [Thread-1 (]: 2 of 15 OK created sql table model main_raw.airports_raw ....................... [[32mOK[0m in 0.13s]
[0m16:58:54.225142 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m16:58:54.225142 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m16:58:54.229135 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m16:58:54.229135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m16:58:54.233147 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m16:58:54.241116 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m16:58:54.245109 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m16:58:54.261082 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m16:58:54.261082 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:58:54.261082 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m16:58:54.265075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:54.297021 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m16:58:54.297021 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:58:54.301015 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m16:58:54.305510 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:58:54.317055 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:58:54.317055 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw__dbt_tmp" rename to "bookings_raw"
[0m16:58:54.321051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.325038 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m16:58:54.325038 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:58:54.325038 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m16:58:54.329028 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:58:54.337023 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m16:58:54.337023 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
drop table if exists "dev"."main_raw"."bookings_raw__dbt_backup" cascade
[0m16:58:54.337023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.341014 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m16:58:54.357045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0458990D0>]}
[0m16:58:54.361067 [info ] [Thread-1 (]: 3 of 15 OK created sql table model main_raw.bookings_raw ....................... [[32mOK[0m in 0.13s]
[0m16:58:54.361067 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m16:58:54.365059 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m16:58:54.365059 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m16:58:54.369056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m16:58:54.369056 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m16:58:54.377041 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m16:58:54.377041 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m16:58:54.388998 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m16:58:54.393013 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:58:54.393013 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m16:58:54.393013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:54.424958 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m16:58:54.428933 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:58:54.428933 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m16:58:54.432925 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:58:54.440934 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:58:54.440934 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw__dbt_tmp" rename to "flights_raw"
[0m16:58:54.444917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.444917 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m16:58:54.448919 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:58:54.448919 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m16:58:54.452901 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:58:54.460901 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m16:58:54.460901 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
drop table if exists "dev"."main_raw"."flights_raw__dbt_backup" cascade
[0m16:58:54.460901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.464894 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m16:58:54.504827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0457805D0>]}
[0m16:58:54.508826 [info ] [Thread-1 (]: 4 of 15 OK created sql table model main_raw.flights_raw ........................ [[32mOK[0m in 0.14s]
[0m16:58:54.508826 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m16:58:54.512817 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m16:58:54.512817 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m16:58:54.516807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m16:58:54.516807 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m16:58:54.524795 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m16:58:54.524795 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m16:58:54.532824 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m16:58:54.536755 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:58:54.540767 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m16:58:54.540767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:54.568718 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m16:58:54.572713 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m16:58:54.572713 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m16:58:54.572713 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m16:58:54.576706 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:58:54.576706 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m16:58:54.588676 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m16:58:54.592659 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m16:58:54.600667 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:58:54.600667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0457F0510>]}
[0m16:58:54.604639 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.09s]
[0m16:58:54.604639 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m16:58:54.604639 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m16:58:54.608655 [info ] [Thread-1 (]: 6 of 15 START sql view model main_stage.aircrafts_stg .......................... [RUN]
[0m16:58:54.612648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.aircrafts_stg)
[0m16:58:54.612648 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_stg
[0m16:58:54.624632 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_stg"
[0m16:58:54.624632 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_stg
[0m16:58:54.665056 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_stg"
[0m16:58:54.669050 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:58:54.673043 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: BEGIN
[0m16:58:54.673043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:54.693010 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:58:54.697004 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:58:54.697004 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */

  
  create view "dev"."main_stage"."aircrafts_stg__dbt_tmp" as (
    

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from "dev"."main_raw"."aircrafts_raw"
where in_service_date IS NOT null
  );

[0m16:58:54.697004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.704991 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:58:54.704991 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg" rename to "aircrafts_stg__dbt_backup"
[0m16:58:54.708986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.720972 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:58:54.720972 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg__dbt_tmp" rename to "aircrafts_stg"
[0m16:58:54.724934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.728955 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m16:58:54.728955 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:58:54.728955 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m16:58:54.736632 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:58:54.828000 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m16:58:54.828000 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
drop view if exists "dev"."main_stage"."aircrafts_stg__dbt_backup" cascade
[0m16:58:54.828000 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:58:54.843597 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: Close
[0m16:58:54.859220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B045983F10>]}
[0m16:58:54.859220 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main_stage.aircrafts_stg ..................... [[32mOK[0m in 0.25s]
[0m16:58:54.859220 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m16:58:54.859220 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m16:58:54.859220 [info ] [Thread-1 (]: 7 of 15 START sql view model main_stage.airports_stg ........................... [RUN]
[0m16:58:54.859220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_stg, now model.lufthansa.airports_stg)
[0m16:58:54.859220 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_stg
[0m16:58:54.874840 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_stg"
[0m16:58:54.874840 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_stg
[0m16:58:54.874840 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_stg"
[0m16:58:54.874840 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m16:58:54.874840 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: BEGIN
[0m16:58:54.890459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:54.906081 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m16:58:54.921700 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m16:58:54.921700 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */

  
  create view "dev"."main_stage"."airports_stg__dbt_tmp" as (
    

select
    UPPER(airport_code) as airport_code,
    airport_name,
    city,
    country,
    timezone
from "dev"."main_raw"."airports_raw"
  );

[0m16:58:54.921700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.921700 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m16:58:54.921700 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg__dbt_tmp" rename to "airports_stg"
[0m16:58:54.921700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.937319 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m16:58:54.937319 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m16:58:54.937319 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m16:58:54.937319 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:58:54.937319 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m16:58:54.937319 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
drop view if exists "dev"."main_stage"."airports_stg__dbt_backup" cascade
[0m16:58:54.937319 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:54.952932 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: Close
[0m16:58:54.968538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0410B3B10>]}
[0m16:58:54.968538 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main_stage.airports_stg ...................... [[32mOK[0m in 0.11s]
[0m16:58:54.968538 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m16:58:54.968538 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m16:58:54.968538 [info ] [Thread-1 (]: 8 of 15 START sql view model main_stage.bookings_stg ........................... [RUN]
[0m16:58:54.968538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_stg, now model.lufthansa.bookings_stg)
[0m16:58:54.968538 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_stg
[0m16:58:54.984180 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_stg"
[0m16:58:54.984180 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_stg
[0m16:58:54.984180 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_stg"
[0m16:58:54.999800 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m16:58:54.999800 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: BEGIN
[0m16:58:54.999800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:55.031077 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m16:58:55.031077 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m16:58:55.031077 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */

  
  create view "dev"."main_stage"."bookings_stg__dbt_tmp" as (
    

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    UPPER(booking_status) as booking_status,
    price
from "dev"."main_raw"."bookings_raw"
where booking_status is not null
  );

[0m16:58:55.031077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.046641 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m16:58:55.046641 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg__dbt_tmp" rename to "bookings_stg"
[0m16:58:55.046641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.046641 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m16:58:55.046641 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m16:58:55.046641 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m16:58:55.062258 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:58:55.062258 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m16:58:55.062258 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
drop view if exists "dev"."main_stage"."bookings_stg__dbt_backup" cascade
[0m16:58:55.062258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.077883 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: Close
[0m16:58:55.077883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04587EF50>]}
[0m16:58:55.093500 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main_stage.bookings_stg ...................... [[32mOK[0m in 0.11s]
[0m16:58:55.093500 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m16:58:55.093500 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m16:58:55.093500 [info ] [Thread-1 (]: 9 of 15 START sql view model main_stage.flights_stg ............................ [RUN]
[0m16:58:55.093500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_stg, now model.lufthansa.flights_stg)
[0m16:58:55.093500 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_stg
[0m16:58:55.109119 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_stg"
[0m16:58:55.109119 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_stg
[0m16:58:55.109119 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_stg"
[0m16:58:55.109119 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m16:58:55.109119 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: BEGIN
[0m16:58:55.124758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:55.156000 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m16:58:55.156000 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m16:58:55.156000 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */

  
  create view "dev"."main_stage"."flights_stg__dbt_tmp" as (
    

select
    flight_id,
    flight_number,
    origin_airport_code as airport_from,
    destination_airport_code as airport_to,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    upper(status) as status
from "dev"."main_raw"."flights_raw"
where status is not null
  );

[0m16:58:55.156000 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.156000 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m16:58:55.156000 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg__dbt_tmp" rename to "flights_stg"
[0m16:58:55.156000 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.171620 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m16:58:55.171620 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m16:58:55.171620 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m16:58:55.171620 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:58:55.187241 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m16:58:55.187241 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
drop view if exists "dev"."main_stage"."flights_stg__dbt_backup" cascade
[0m16:58:55.187241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.187241 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: Close
[0m16:58:55.202904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B045876090>]}
[0m16:58:55.202904 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main_stage.flights_stg ....................... [[32mOK[0m in 0.11s]
[0m16:58:55.202904 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m16:58:55.202904 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m16:58:55.218481 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m16:58:55.218481 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m16:58:55.218481 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m16:58:55.218481 [info ] [Thread-1 (]: 11 of 15 START sql table model main_mart.daily_flights ......................... [RUN]
[0m16:58:55.218481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_stg, now model.lufthansa.daily_flights)
[0m16:58:55.218481 [debug] [Thread-1 (]: Began compiling node model.lufthansa.daily_flights
[0m16:58:55.218481 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.daily_flights"
[0m16:58:55.234090 [debug] [Thread-1 (]: Began executing node model.lufthansa.daily_flights
[0m16:58:55.234090 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.daily_flights"
[0m16:58:55.234090 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m16:58:55.234090 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: BEGIN
[0m16:58:55.234090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:55.265320 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m16:58:55.265320 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m16:58:55.265320 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        date(scheduled_departure_time) as flight_date,
        origin_airport,
        destination_airport,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    origin_airport,
    destination_airport,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, origin_airport, destination_airport
    );
  
  
[0m16:58:55.296581 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        date(scheduled_departure_time) as flight_date,
        origin_airport,
        destination_airport,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    origin_airport,
    destination_airport,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, origin_airport, destination_airport
    );
  
  
[0m16:58:55.296581 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:58:55.296581 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: ROLLBACK
[0m16:58:55.296581 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.daily_flights'
[0m16:58:55.296581 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: Close
[0m16:58:55.312200 [debug] [Thread-1 (]: Runtime Error in model daily_flights (models\mart\daily_flights.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  LINE 16:         date(scheduled_departure_time) as flight_date,
          origin_airport,
          destination_airport,
          status
      from "dev"."main_stage"."flights_stg"
  )
  select
      flight_date,
      origin_airport,
      destination_airport,
      count(*) as total_flights,
      sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
      sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
  from flights
  group by flight_date, origin_airport, destination_airport
      );
    
    ...
                   ^
[0m16:58:55.312200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0431F1990>]}
[0m16:58:55.312200 [error] [Thread-1 (]: 11 of 15 ERROR creating sql table model main_mart.daily_flights ................ [[31mERROR[0m in 0.09s]
[0m16:58:55.312200 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m16:58:55.312200 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m16:58:55.327799 [info ] [Thread-1 (]: 12 of 15 START sql table model main_mart.delays ................................ [RUN]
[0m16:58:55.327799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.daily_flights, now model.lufthansa.delays)
[0m16:58:55.327799 [debug] [Thread-1 (]: Began compiling node model.lufthansa.delays
[0m16:58:55.327799 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.delays"
[0m16:58:55.327799 [debug] [Thread-1 (]: Began executing node model.lufthansa.delays
[0m16:58:55.343443 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.delays"
[0m16:58:55.343443 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m16:58:55.343443 [debug] [Thread-1 (]: On model.lufthansa.delays: BEGIN
[0m16:58:55.343443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:55.359066 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:58:55.359066 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m16:58:55.359066 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */

  
    
    

    create  table
      "dev"."main_mart"."delays__dbt_tmp"
  
    as (
      

WITH delays AS (
    SELECT
        flight_id,
        scheduled_departure_time,
        actual_departure_time,
        EXTRACT('epoch' FROM (actual_departure_time - scheduled_departure_time)) / 60 AS departure_delay_minutes
      --EXTRACT('epoch' FROM interval) function returns the total number of seconds contained in the interval
    FROM "dev"."main_stage"."flights_stg"
    WHERE actual_departure_time IS NOT NULL
)

SELECT
    AVG(departure_delay_minutes) AS average_delay_minutes,
    MAX(departure_delay_minutes) AS max_delay_minutes,
    MIN(departure_delay_minutes) AS min_delay_minutes,
    COUNT(*) AS total_flights
FROM delays
    );
  
  
[0m16:58:55.390337 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m16:58:55.405924 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m16:58:55.405924 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays__dbt_tmp" rename to "delays"
[0m16:58:55.405924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.405924 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m16:58:55.405924 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m16:58:55.405924 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m16:58:55.405924 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:58:55.421541 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m16:58:55.421541 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
drop table if exists "dev"."main_mart"."delays__dbt_backup" cascade
[0m16:58:55.421541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.421541 [debug] [Thread-1 (]: On model.lufthansa.delays: Close
[0m16:58:55.452787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B043D37890>]}
[0m16:58:55.452787 [info ] [Thread-1 (]: 12 of 15 OK created sql table model main_mart.delays ........................... [[32mOK[0m in 0.12s]
[0m16:58:55.452787 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m16:58:55.452787 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m16:58:55.452787 [info ] [Thread-1 (]: 13 of 15 START sql table model main_mart.flight_effectiveness .................. [RUN]
[0m16:58:55.452787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.delays, now model.lufthansa.flight_effectiveness)
[0m16:58:55.452787 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flight_effectiveness
[0m16:58:55.468401 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flight_effectiveness"
[0m16:58:55.468401 [debug] [Thread-1 (]: Began executing node model.lufthansa.flight_effectiveness
[0m16:58:55.468401 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flight_effectiveness"
[0m16:58:55.468401 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m16:58:55.484022 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: BEGIN
[0m16:58:55.484022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:55.515261 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m16:58:55.515261 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m16:58:55.515261 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */

  
    
    

    create  table
      "dev"."main_mart"."flight_effectiveness__dbt_tmp"
  
    as (
      

with flight_bookings as (
    select
        b.flight_id,
        count(*) AS booked_seats
    from "dev"."main_stage"."bookings_stg" b
    group by b.flight_id
),
flight_capacity as (
    select
        f.flight_id,
        f.aircraft_id,
        a.capacity
    from "dev"."main_stage"."flights_stg" f
    INNER JOIN "dev"."main_stage"."aircrafts_stg" a ON f.aircraft_id = a.aircraft_id
)
select
    fc.flight_id,
    fc.aircraft_id,
    fc.capacity,
    fb.booked_seats,
    (fb.booked_seats::float / fc.capacity) * 100 AS effectiveness_percentage -- typecast to float
from flight_capacity fc
LEFT JOIN flight_bookings fb ON fc.flight_id = fb.flight_id
    );
  
  
[0m16:58:55.546503 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m16:58:55.546503 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m16:58:55.546503 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness__dbt_tmp" rename to "flight_effectiveness"
[0m16:58:55.546503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.562102 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m16:58:55.562102 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m16:58:55.562102 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m16:58:55.562102 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:58:55.577743 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m16:58:55.577743 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
drop table if exists "dev"."main_mart"."flight_effectiveness__dbt_backup" cascade
[0m16:58:55.577743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.577743 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: Close
[0m16:58:55.608990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04401C550>]}
[0m16:58:55.608990 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main_mart.flight_effectiveness ............. [[32mOK[0m in 0.16s]
[0m16:58:55.608990 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m16:58:55.608990 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m16:58:55.608990 [info ] [Thread-1 (]: 14 of 15 START sql table model main_mart.top_routes ............................ [RUN]
[0m16:58:55.608990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flight_effectiveness, now model.lufthansa.top_routes)
[0m16:58:55.608990 [debug] [Thread-1 (]: Began compiling node model.lufthansa.top_routes
[0m16:58:55.608990 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.top_routes"
[0m16:58:55.624602 [debug] [Thread-1 (]: Began executing node model.lufthansa.top_routes
[0m16:58:55.624602 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.top_routes"
[0m16:58:55.624602 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m16:58:55.640223 [debug] [Thread-1 (]: On model.lufthansa.top_routes: BEGIN
[0m16:58:55.640223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:55.671477 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m16:58:55.671477 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m16:58:55.671477 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */

  
    
    

    create  table
      "dev"."main_mart"."top_routes__dbt_tmp"
  
    as (
      

SELECT
    airport_from,
    airport_to,
    COUNT(*) AS total_flights
FROM "dev"."main_stage"."flights_stg"
GROUP BY airport_from, airport_to
ORDER BY total_flights DESC
LIMIT 10
    );
  
  
[0m16:58:55.671477 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:58:55.687061 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m16:58:55.687061 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes__dbt_tmp" rename to "top_routes"
[0m16:58:55.687061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.687061 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m16:58:55.687061 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m16:58:55.687061 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m16:58:55.702755 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:58:55.702755 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m16:58:55.702755 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
drop table if exists "dev"."main_mart"."top_routes__dbt_backup" cascade
[0m16:58:55.702755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:58:55.702755 [debug] [Thread-1 (]: On model.lufthansa.top_routes: Close
[0m16:58:55.733942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a01e5c-a0b3-4d98-ae4e-3a0e5a0a6925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0458A8550>]}
[0m16:58:55.733942 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main_mart.top_routes ....................... [[32mOK[0m in 0.12s]
[0m16:58:55.733942 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m16:58:55.733942 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m16:58:55.733942 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m16:58:55.733942 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m16:58:55.733942 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:55.749563 [debug] [MainThread]: On master: BEGIN
[0m16:58:55.749563 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:58:55.780784 [debug] [MainThread]: SQL status: OK in 0.030 seconds
[0m16:58:55.780784 [debug] [MainThread]: On master: COMMIT
[0m16:58:55.780784 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:55.780784 [debug] [MainThread]: On master: COMMIT
[0m16:58:55.780784 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:58:55.780784 [debug] [MainThread]: On master: Close
[0m16:58:55.780784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:55.780784 [debug] [MainThread]: Connection 'create_dev_main_mart' was properly closed.
[0m16:58:55.780784 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m16:58:55.780784 [debug] [MainThread]: Connection 'model.lufthansa.top_routes' was properly closed.
[0m16:58:55.796401 [info ] [MainThread]: 
[0m16:58:55.796401 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m16:58:55.796401 [debug] [MainThread]: Command end result
[0m16:58:55.874569 [info ] [MainThread]: 
[0m16:58:55.874569 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:58:55.874569 [info ] [MainThread]: 
[0m16:58:55.874569 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m16:58:55.874569 [info ] [MainThread]: 
[0m16:58:55.874569 [error] [MainThread]:   Runtime Error in model daily_flights (models\mart\daily_flights.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  LINE 16:         date(scheduled_departure_time) as flight_date,
          origin_airport,
          destination_airport,
          status
      from "dev"."main_stage"."flights_stg"
  )
  select
      flight_date,
      origin_airport,
      destination_airport,
      count(*) as total_flights,
      sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
      sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
  from flights
  group by flight_date, origin_airport, destination_airport
      );
    
    ...
                   ^
[0m16:58:55.874569 [info ] [MainThread]: 
[0m16:58:55.874569 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=2 TOTAL=15
[0m16:58:55.874569 [debug] [MainThread]: Command `dbt run` failed at 16:58:55.874569 after 4.84 seconds
[0m16:58:55.874569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B03D6FE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B03D9CD990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B03D9CD850>]}
[0m16:58:55.874569 [debug] [MainThread]: Flushing usage events
[0m17:00:10.927333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5AA920D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5AA9D350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5AA9D550>]}


============================== 17:00:10.942933 | 1c248974-7569-4e50-8ce6-516df909cdb3 ==============================
[0m17:00:10.942933 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:00:10.942933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:00:11.412224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5AA92DD0>]}
[0m17:00:11.521561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA57F39C50>]}
[0m17:00:11.521561 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:00:11.554441 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:00:11.866134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:11.866134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:11.944238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5AF61CD0>]}
[0m17:00:12.138010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5AB38250>]}
[0m17:00:12.138010 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:00:12.147517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5AEE8CD0>]}
[0m17:00:12.147517 [info ] [MainThread]: 
[0m17:00:12.147517 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:00:12.163169 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:00:12.350588 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:00:12.350588 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:00:12.350588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:12.381855 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:00:12.381855 [debug] [ThreadPool]: On list_dev: Close
[0m17:00:12.397465 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:00:12.397465 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:00:12.397465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:12.428724 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:00:12.428724 [debug] [ThreadPool]: On list_dev: Close
[0m17:00:12.428724 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:00:12.444329 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:00:12.444329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:12.459953 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:00:12.459953 [debug] [ThreadPool]: On list_dev: Close
[0m17:00:12.475573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_raw)
[0m17:00:12.475573 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m17:00:12.491190 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:00:12.491190 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:00:12.491190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:12.522430 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:00:12.522430 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:00:12.522430 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m17:00:12.522430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:12.522430 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:00:12.522430 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m17:00:12.522430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:12.522430 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:00:12.522430 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:00:12.522430 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:00:12.522430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:12.522430 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m17:00:12.538048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_mart)
[0m17:00:12.538048 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m17:00:12.538048 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:00:12.538048 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:00:12.538048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:12.569269 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:00:12.569269 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:00:12.569269 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m17:00:12.569269 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:12.569269 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:00:12.569269 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m17:00:12.569269 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:12.584909 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:00:12.584909 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:00:12.584909 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:00:12.584909 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:12.584909 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m17:00:12.584909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_mart, now create_dev_main_stage)
[0m17:00:12.584909 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m17:00:12.600530 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:00:12.600530 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:00:12.600530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:12.616154 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:00:12.616154 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:00:12.616154 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m17:00:12.616154 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:12.616154 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:00:12.616154 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m17:00:12.631769 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:00:12.631769 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:00:12.631769 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:00:12.631769 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:00:12.631769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:00:12.631769 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m17:00:12.647389 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_raw'
[0m17:00:12.647389 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:00:12.647389 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m17:00:12.647389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:12.678655 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:00:12.678655 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:00:12.678655 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m17:00:12.756731 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m17:00:12.756731 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m17:00:12.756731 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m17:00:12.756731 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m17:00:12.772328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_mart)
[0m17:00:12.772328 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:00:12.772328 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m17:00:12.772328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:12.805110 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:00:12.805110 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:00:12.805110 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m17:00:12.882138 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m17:00:12.882138 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m17:00:12.882138 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m17:00:12.882138 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m17:00:12.897782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main)
[0m17:00:12.897782 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:00:12.897782 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:00:12.897782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:12.929480 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m17:00:12.929480 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:00:12.929480 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:00:13.007589 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m17:00:13.007589 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:00:13.023980 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:00:13.025076 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:00:13.026245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_stage)
[0m17:00:13.039271 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:00:13.039271 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m17:00:13.039271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:13.054899 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:00:13.054899 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:00:13.054899 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m17:00:13.132997 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m17:00:13.132997 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m17:00:13.132997 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m17:00:13.132997 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m17:00:13.148653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA58479D90>]}
[0m17:00:13.148653 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:13.148653 [debug] [MainThread]: On master: BEGIN
[0m17:00:13.148653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:13.179892 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m17:00:13.179892 [debug] [MainThread]: On master: COMMIT
[0m17:00:13.179892 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:13.179892 [debug] [MainThread]: On master: COMMIT
[0m17:00:13.179892 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:13.179892 [debug] [MainThread]: On master: Close
[0m17:00:13.179892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:13.179892 [info ] [MainThread]: 
[0m17:00:13.195481 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m17:00:13.195481 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m17:00:13.195481 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m17:00:13.195481 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m17:00:13.211120 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m17:00:13.211120 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m17:00:13.289235 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m17:00:13.289235 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:00:13.289235 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m17:00:13.289235 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:00:13.320473 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m17:00:13.320473 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:00:13.320473 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m17:00:13.320473 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:13.336089 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:00:13.336089 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw" rename to "aircrafts_raw__dbt_backup"
[0m17:00:13.336089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:13.351681 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:00:13.351681 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw__dbt_tmp" rename to "aircrafts_raw"
[0m17:00:13.351681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:13.398553 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:00:13.398553 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:00:13.398553 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:00:13.416229 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:00:13.416229 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:00:13.430257 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
drop table if exists "dev"."main_raw"."aircrafts_raw__dbt_backup" cascade
[0m17:00:13.430257 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:13.430257 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m17:00:13.461508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C3F1B90>]}
[0m17:00:13.461508 [info ] [Thread-1 (]: 1 of 15 OK created sql table model main_raw.aircrafts_raw ...................... [[32mOK[0m in 0.25s]
[0m17:00:13.461508 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m17:00:13.461508 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m17:00:13.461508 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m17:00:13.461508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m17:00:13.461508 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m17:00:13.477161 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m17:00:13.477161 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m17:00:13.492746 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m17:00:13.492746 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:00:13.492746 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m17:00:13.492746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:13.524007 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:00:13.524007 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:00:13.524007 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m17:00:13.524007 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:13.539629 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:00:13.539629 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw" rename to "airports_raw__dbt_backup"
[0m17:00:13.539629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:13.539629 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:00:13.539629 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw__dbt_tmp" rename to "airports_raw"
[0m17:00:13.539629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:13.558774 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:00:13.559938 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:00:13.561040 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:00:13.564479 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:00:13.571011 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:00:13.571011 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
drop table if exists "dev"."main_raw"."airports_raw__dbt_backup" cascade
[0m17:00:13.571011 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:13.571011 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m17:00:13.602337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C563890>]}
[0m17:00:13.602337 [info ] [Thread-1 (]: 2 of 15 OK created sql table model main_raw.airports_raw ....................... [[32mOK[0m in 0.14s]
[0m17:00:13.602337 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m17:00:13.602337 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m17:00:13.602337 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m17:00:13.602337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m17:00:13.617914 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m17:00:13.617914 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m17:00:13.617914 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m17:00:13.633498 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m17:00:13.633498 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:00:13.633498 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m17:00:13.633498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:13.664764 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:00:13.664764 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:00:13.664764 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m17:00:13.664764 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:13.680384 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:00:13.680384 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw" rename to "bookings_raw__dbt_backup"
[0m17:00:13.680384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:13.680384 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:00:13.680384 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw__dbt_tmp" rename to "bookings_raw"
[0m17:00:13.680384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:13.699581 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:00:13.700748 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:00:13.701326 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:00:13.706525 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:00:13.712054 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:00:13.712054 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
drop table if exists "dev"."main_raw"."bookings_raw__dbt_backup" cascade
[0m17:00:13.712054 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:13.712054 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m17:00:13.743325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C5B07D0>]}
[0m17:00:13.743325 [info ] [Thread-1 (]: 3 of 15 OK created sql table model main_raw.bookings_raw ....................... [[32mOK[0m in 0.14s]
[0m17:00:13.743325 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m17:00:13.743325 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m17:00:13.743325 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m17:00:13.743325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m17:00:13.743325 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m17:00:13.758947 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m17:00:13.758947 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m17:00:13.758947 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m17:00:13.758947 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:00:13.758947 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m17:00:13.758947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:13.790187 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:00:13.790187 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:00:13.790187 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m17:00:13.805818 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:13.805818 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:00:13.805818 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw" rename to "flights_raw__dbt_backup"
[0m17:00:13.805818 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:13.821424 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:00:13.821424 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw__dbt_tmp" rename to "flights_raw"
[0m17:00:13.821424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:13.821424 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:00:13.821424 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:00:13.821424 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:00:13.837042 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:13.837042 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:00:13.837042 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
drop table if exists "dev"."main_raw"."flights_raw__dbt_backup" cascade
[0m17:00:13.837042 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:13.852667 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m17:00:13.868264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C637BD0>]}
[0m17:00:13.883903 [info ] [Thread-1 (]: 4 of 15 OK created sql table model main_raw.flights_raw ........................ [[32mOK[0m in 0.12s]
[0m17:00:13.883903 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m17:00:13.883903 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m17:00:13.883903 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m17:00:13.883903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m17:00:13.883903 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m17:00:13.883903 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m17:00:13.899524 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m17:00:13.899524 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m17:00:13.899524 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:00:13.899524 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m17:00:13.899524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:13.930770 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:00:13.930770 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:00:13.930770 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:00:13.946363 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      CREATE SCHEMA airlines_lufthansa;



select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:00:13.946363 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:00:13.946363 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m17:00:13.946363 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m17:00:13.946363 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m17:00:13.962024 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m17:00:13.962024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5AE86650>]}
[0m17:00:13.962024 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.08s]
[0m17:00:13.962024 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m17:00:13.962024 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m17:00:13.979655 [info ] [Thread-1 (]: 6 of 15 START sql view model main_stage.aircrafts_stg .......................... [RUN]
[0m17:00:13.981273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.aircrafts_stg)
[0m17:00:13.981273 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_stg
[0m17:00:13.981273 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_stg"
[0m17:00:13.981273 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_stg
[0m17:00:14.024583 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_stg"
[0m17:00:14.024583 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:00:14.024583 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: BEGIN
[0m17:00:14.024583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:14.055821 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m17:00:14.055821 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:00:14.055821 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */

  
  create view "dev"."main_stage"."aircrafts_stg__dbt_tmp" as (
    

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from "dev"."main_raw"."aircrafts_raw"
where in_service_date IS NOT null
  );

[0m17:00:14.055821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.055821 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:00:14.055821 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg" rename to "aircrafts_stg__dbt_backup"
[0m17:00:14.055821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.071427 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:00:14.071427 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg__dbt_tmp" rename to "aircrafts_stg"
[0m17:00:14.071427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.071427 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:00:14.071427 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:00:14.071427 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:00:14.087574 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:00:14.087574 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:00:14.087574 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
drop view if exists "dev"."main_stage"."aircrafts_stg__dbt_backup" cascade
[0m17:00:14.087574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.087574 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: Close
[0m17:00:14.103100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C0BCF90>]}
[0m17:00:14.118750 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main_stage.aircrafts_stg ..................... [[32mOK[0m in 0.12s]
[0m17:00:14.118750 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m17:00:14.118750 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m17:00:14.118750 [info ] [Thread-1 (]: 7 of 15 START sql view model main_stage.airports_stg ........................... [RUN]
[0m17:00:14.118750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_stg, now model.lufthansa.airports_stg)
[0m17:00:14.118750 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_stg
[0m17:00:14.118750 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_stg"
[0m17:00:14.134378 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_stg
[0m17:00:14.143149 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_stg"
[0m17:00:14.143149 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:00:14.147120 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: BEGIN
[0m17:00:14.147120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:14.183059 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:00:14.183059 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:00:14.187053 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */

  
  create view "dev"."main_stage"."airports_stg__dbt_tmp" as (
    

select
    UPPER(airport_code) as airport_code,
    airport_name,
    city,
    country,
    timezone
from "dev"."main_raw"."airports_raw"
  );

[0m17:00:14.187053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.195060 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:00:14.195060 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg" rename to "airports_stg__dbt_backup"
[0m17:00:14.199034 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.207020 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:00:14.211012 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg__dbt_tmp" rename to "airports_stg"
[0m17:00:14.211012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.216256 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:00:14.217459 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:00:14.218037 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:00:14.222771 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:00:14.226769 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:00:14.230767 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
drop view if exists "dev"."main_stage"."airports_stg__dbt_backup" cascade
[0m17:00:14.234776 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:14.238751 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: Close
[0m17:00:14.258786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C6CD790>]}
[0m17:00:14.258786 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main_stage.airports_stg ...................... [[32mOK[0m in 0.14s]
[0m17:00:14.266780 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m17:00:14.266780 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m17:00:14.266780 [info ] [Thread-1 (]: 8 of 15 START sql view model main_stage.bookings_stg ........................... [RUN]
[0m17:00:14.270797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_stg, now model.lufthansa.bookings_stg)
[0m17:00:14.270797 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_stg
[0m17:00:14.278786 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_stg"
[0m17:00:14.278786 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_stg
[0m17:00:14.286770 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_stg"
[0m17:00:14.290761 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:00:14.294737 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: BEGIN
[0m17:00:14.294737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:14.322688 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:00:14.326707 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:00:14.326707 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */

  
  create view "dev"."main_stage"."bookings_stg__dbt_tmp" as (
    

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    UPPER(booking_status) as booking_status,
    price
from "dev"."main_raw"."bookings_raw"
where booking_status is not null
  );

[0m17:00:14.330694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.334689 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:00:14.334689 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg" rename to "bookings_stg__dbt_backup"
[0m17:00:14.338681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.346648 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:00:14.346648 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg__dbt_tmp" rename to "bookings_stg"
[0m17:00:14.346648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.350643 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:00:14.350643 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:00:14.354635 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:00:14.358629 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:14.362623 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:00:14.362623 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
drop view if exists "dev"."main_stage"."bookings_stg__dbt_backup" cascade
[0m17:00:14.367845 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.370853 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: Close
[0m17:00:14.383144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C5C1B90>]}
[0m17:00:14.383144 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main_stage.bookings_stg ...................... [[32mOK[0m in 0.11s]
[0m17:00:14.387205 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m17:00:14.391180 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m17:00:14.391180 [info ] [Thread-1 (]: 9 of 15 START sql view model main_stage.flights_stg ............................ [RUN]
[0m17:00:14.391180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_stg, now model.lufthansa.flights_stg)
[0m17:00:14.395170 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_stg
[0m17:00:14.399167 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_stg"
[0m17:00:14.403159 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_stg
[0m17:00:14.411168 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_stg"
[0m17:00:14.411168 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:00:14.415138 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: BEGIN
[0m17:00:14.415138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:14.447087 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:00:14.447087 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:00:14.451077 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */

  
  create view "dev"."main_stage"."flights_stg__dbt_tmp" as (
    

select
    flight_id,
    flight_number,
    origin_airport_code as airport_from,
    destination_airport_code as airport_to,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    upper(status) as status
from "dev"."main_raw"."flights_raw"
where status is not null
  );

[0m17:00:14.459066 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:14.467052 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:00:14.471045 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg" rename to "flights_stg__dbt_backup"
[0m17:00:14.471045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.479032 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:00:14.479032 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg__dbt_tmp" rename to "flights_stg"
[0m17:00:14.483025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.488700 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:00:14.495211 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:00:14.499204 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:00:14.504362 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:00:14.511372 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:00:14.511372 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
drop view if exists "dev"."main_stage"."flights_stg__dbt_backup" cascade
[0m17:00:14.515365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.519359 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: Close
[0m17:00:14.535332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C6FB890>]}
[0m17:00:14.539326 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main_stage.flights_stg ....................... [[32mOK[0m in 0.14s]
[0m17:00:14.539326 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m17:00:14.543319 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m17:00:14.543319 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m17:00:14.543319 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m17:00:14.547309 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m17:00:14.547309 [info ] [Thread-1 (]: 11 of 15 START sql table model main_mart.daily_flights ......................... [RUN]
[0m17:00:14.547309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_stg, now model.lufthansa.daily_flights)
[0m17:00:14.551333 [debug] [Thread-1 (]: Began compiling node model.lufthansa.daily_flights
[0m17:00:14.559290 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.daily_flights"
[0m17:00:14.563284 [debug] [Thread-1 (]: Began executing node model.lufthansa.daily_flights
[0m17:00:14.663140 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.daily_flights"
[0m17:00:14.667111 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:00:14.667111 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: BEGIN
[0m17:00:14.671126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:14.703228 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:00:14.703228 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:00:14.703228 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        date(scheduled_departure_time) as flight_date,
        origin_airport,
        destination_airport,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    origin_airport,
    destination_airport,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, origin_airport, destination_airport
    );
  
  
[0m17:00:14.719224 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        date(scheduled_departure_time) as flight_date,
        origin_airport,
        destination_airport,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    origin_airport,
    destination_airport,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, origin_airport, destination_airport
    );
  
  
[0m17:00:14.723216 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:00:14.723216 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: ROLLBACK
[0m17:00:14.727206 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.daily_flights'
[0m17:00:14.727206 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: Close
[0m17:00:14.739189 [debug] [Thread-1 (]: Runtime Error in model daily_flights (models\mart\daily_flights.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  LINE 16:         date(scheduled_departure_time) as flight_date,
          origin_airport,
          destination_airport,
          status
      from "dev"."main_stage"."flights_stg"
  )
  select
      flight_date,
      origin_airport,
      destination_airport,
      count(*) as total_flights,
      sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
      sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
  from flights
  group by flight_date, origin_airport, destination_airport
      );
    
    ...
                   ^
[0m17:00:14.743188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C6FA990>]}
[0m17:00:14.743188 [error] [Thread-1 (]: 11 of 15 ERROR creating sql table model main_mart.daily_flights ................ [[31mERROR[0m in 0.20s]
[0m17:00:14.743188 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m17:00:14.747177 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m17:00:14.747177 [info ] [Thread-1 (]: 12 of 15 START sql table model main_mart.delays ................................ [RUN]
[0m17:00:14.751147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.daily_flights, now model.lufthansa.delays)
[0m17:00:14.751147 [debug] [Thread-1 (]: Began compiling node model.lufthansa.delays
[0m17:00:14.755142 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.delays"
[0m17:00:14.759135 [debug] [Thread-1 (]: Began executing node model.lufthansa.delays
[0m17:00:14.767269 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.delays"
[0m17:00:14.767269 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:00:14.767269 [debug] [Thread-1 (]: On model.lufthansa.delays: BEGIN
[0m17:00:14.767269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:14.782891 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m17:00:14.782891 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:00:14.782891 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */

  
    
    

    create  table
      "dev"."main_mart"."delays__dbt_tmp"
  
    as (
      

WITH delays AS (
    SELECT
        flight_id,
        scheduled_departure_time,
        actual_departure_time,
        EXTRACT('epoch' FROM (actual_departure_time - scheduled_departure_time)) / 60 AS departure_delay_minutes
      --EXTRACT('epoch' FROM interval) function returns the total number of seconds contained in the interval
    FROM "dev"."main_stage"."flights_stg"
    WHERE actual_departure_time IS NOT NULL
)

SELECT
    AVG(departure_delay_minutes) AS average_delay_minutes,
    MAX(departure_delay_minutes) AS max_delay_minutes,
    MIN(departure_delay_minutes) AS min_delay_minutes,
    COUNT(*) AS total_flights
FROM delays
    );
  
  
[0m17:00:14.798530 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:14.798530 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:00:14.798530 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays" rename to "delays__dbt_backup"
[0m17:00:14.798530 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.814152 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:00:14.814152 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays__dbt_tmp" rename to "delays"
[0m17:00:14.814152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.814152 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:00:14.814152 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:00:14.814152 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:00:14.829887 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:00:14.829887 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:00:14.829887 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
drop table if exists "dev"."main_mart"."delays__dbt_backup" cascade
[0m17:00:14.829887 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:14.829887 [debug] [Thread-1 (]: On model.lufthansa.delays: Close
[0m17:00:14.861132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C711B90>]}
[0m17:00:14.861132 [info ] [Thread-1 (]: 12 of 15 OK created sql table model main_mart.delays ........................... [[32mOK[0m in 0.11s]
[0m17:00:14.861132 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m17:00:14.861132 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m17:00:14.861132 [info ] [Thread-1 (]: 13 of 15 START sql table model main_mart.flight_effectiveness .................. [RUN]
[0m17:00:14.861132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.delays, now model.lufthansa.flight_effectiveness)
[0m17:00:14.861132 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flight_effectiveness
[0m17:00:14.876754 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flight_effectiveness"
[0m17:00:14.876754 [debug] [Thread-1 (]: Began executing node model.lufthansa.flight_effectiveness
[0m17:00:14.892373 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flight_effectiveness"
[0m17:00:14.892373 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:00:14.892373 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: BEGIN
[0m17:00:14.892373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:14.923633 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:00:14.923633 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:00:14.923633 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */

  
    
    

    create  table
      "dev"."main_mart"."flight_effectiveness__dbt_tmp"
  
    as (
      

with flight_bookings as (
    select
        b.flight_id,
        count(*) AS booked_seats
    from "dev"."main_stage"."bookings_stg" b
    group by b.flight_id
),
flight_capacity as (
    select
        f.flight_id,
        f.aircraft_id,
        a.capacity
    from "dev"."main_stage"."flights_stg" f
    INNER JOIN "dev"."main_stage"."aircrafts_stg" a ON f.aircraft_id = a.aircraft_id
)
select
    fc.flight_id,
    fc.aircraft_id,
    fc.capacity,
    fb.booked_seats,
    (fb.booked_seats::float / fc.capacity) * 100 AS effectiveness_percentage -- typecast to float
from flight_capacity fc
LEFT JOIN flight_bookings fb ON fc.flight_id = fb.flight_id
    );
  
  
[0m17:00:14.939236 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:00:14.939236 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:00:14.939236 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness" rename to "flight_effectiveness__dbt_backup"
[0m17:00:14.939236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.954854 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:00:14.954854 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness__dbt_tmp" rename to "flight_effectiveness"
[0m17:00:14.954854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:14.954854 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:00:14.954854 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:00:14.954854 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:00:14.970494 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:00:14.970494 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:00:14.970494 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
drop table if exists "dev"."main_mart"."flight_effectiveness__dbt_backup" cascade
[0m17:00:14.970494 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:14.986095 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: Close
[0m17:00:15.001715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C52B890>]}
[0m17:00:15.001715 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main_mart.flight_effectiveness ............. [[32mOK[0m in 0.14s]
[0m17:00:15.001715 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m17:00:15.001715 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m17:00:15.001715 [info ] [Thread-1 (]: 14 of 15 START sql table model main_mart.top_routes ............................ [RUN]
[0m17:00:15.017341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flight_effectiveness, now model.lufthansa.top_routes)
[0m17:00:15.017341 [debug] [Thread-1 (]: Began compiling node model.lufthansa.top_routes
[0m17:00:15.017341 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.top_routes"
[0m17:00:15.017341 [debug] [Thread-1 (]: Began executing node model.lufthansa.top_routes
[0m17:00:15.033029 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.top_routes"
[0m17:00:15.033029 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:00:15.033029 [debug] [Thread-1 (]: On model.lufthansa.top_routes: BEGIN
[0m17:00:15.033029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:15.064196 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:00:15.064196 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:00:15.064196 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */

  
    
    

    create  table
      "dev"."main_mart"."top_routes__dbt_tmp"
  
    as (
      

SELECT
    airport_from,
    airport_to,
    COUNT(*) AS total_flights
FROM "dev"."main_stage"."flights_stg"
GROUP BY airport_from, airport_to
ORDER BY total_flights DESC
LIMIT 10
    );
  
  
[0m17:00:15.079814 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:00:15.079814 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:00:15.079814 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes" rename to "top_routes__dbt_backup"
[0m17:00:15.079814 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:15.095456 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:00:15.095456 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes__dbt_tmp" rename to "top_routes"
[0m17:00:15.095456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:00:15.095456 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:00:15.095456 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:00:15.095456 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:00:15.095456 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:15.111056 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:00:15.111056 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
drop table if exists "dev"."main_mart"."top_routes__dbt_backup" cascade
[0m17:00:15.111056 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:00:15.111056 [debug] [Thread-1 (]: On model.lufthansa.top_routes: Close
[0m17:00:15.142320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c248974-7569-4e50-8ce6-516df909cdb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5C52B450>]}
[0m17:00:15.142320 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main_mart.top_routes ....................... [[32mOK[0m in 0.14s]
[0m17:00:15.142320 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m17:00:15.142320 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m17:00:15.142320 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m17:00:15.142320 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m17:00:15.142320 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:15.142320 [debug] [MainThread]: On master: BEGIN
[0m17:00:15.142320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:15.173536 [debug] [MainThread]: SQL status: OK in 0.030 seconds
[0m17:00:15.173536 [debug] [MainThread]: On master: COMMIT
[0m17:00:15.173536 [debug] [MainThread]: Using duckdb connection "master"
[0m17:00:15.189157 [debug] [MainThread]: On master: COMMIT
[0m17:00:15.189157 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:00:15.189157 [debug] [MainThread]: On master: Close
[0m17:00:15.189157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:15.189157 [debug] [MainThread]: Connection 'create_dev_main_stage' was properly closed.
[0m17:00:15.189157 [debug] [MainThread]: Connection 'list_dev_main_stage' was properly closed.
[0m17:00:15.189157 [debug] [MainThread]: Connection 'model.lufthansa.top_routes' was properly closed.
[0m17:00:15.189157 [info ] [MainThread]: 
[0m17:00:15.189157 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m17:00:15.204811 [debug] [MainThread]: Command end result
[0m17:00:15.267449 [info ] [MainThread]: 
[0m17:00:15.267449 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:00:15.283086 [info ] [MainThread]: 
[0m17:00:15.283086 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Parser Error: syntax error at or near "CREATE"
[0m17:00:15.283086 [info ] [MainThread]: 
[0m17:00:15.283086 [error] [MainThread]:   Runtime Error in model daily_flights (models\mart\daily_flights.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  LINE 16:         date(scheduled_departure_time) as flight_date,
          origin_airport,
          destination_airport,
          status
      from "dev"."main_stage"."flights_stg"
  )
  select
      flight_date,
      origin_airport,
      destination_airport,
      count(*) as total_flights,
      sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
      sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
  from flights
  group by flight_date, origin_airport, destination_airport
      );
    
    ...
                   ^
[0m17:00:15.283086 [info ] [MainThread]: 
[0m17:00:15.283086 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=2 TOTAL=15
[0m17:00:15.283086 [debug] [MainThread]: Command `dbt run` failed at 17:00:15.283086 after 4.49 seconds
[0m17:00:15.283086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5456E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5456E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5483D8D0>]}
[0m17:00:15.283086 [debug] [MainThread]: Flushing usage events
[0m17:01:15.521331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D045DA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D045D1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D045DC50>]}


============================== 17:01:15.521331 | 6ac927cc-a13e-40e7-addb-8d3feb7c7c5e ==============================
[0m17:01:15.521331 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:01:15.521331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:01:15.981324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D07EAD50>]}
[0m17:01:16.100196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CD8FDF10>]}
[0m17:01:16.115837 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:01:16.131466 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:01:16.428250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:01:16.428250 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\raw\passengers_raw.sql
[0m17:01:16.849962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D186F7D0>]}
[0m17:01:17.053275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D1B167D0>]}
[0m17:01:17.053275 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:01:17.053275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D18BA990>]}
[0m17:01:17.068861 [info ] [MainThread]: 
[0m17:01:17.068861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:01:17.088058 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:01:17.288072 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:01:17.288072 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:01:17.288072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:17.319312 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:01:17.319312 [debug] [ThreadPool]: On list_dev: Close
[0m17:01:17.319312 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:01:17.319312 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:01:17.319312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:17.350549 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:01:17.350549 [debug] [ThreadPool]: On list_dev: Close
[0m17:01:17.366159 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:01:17.366159 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:01:17.366159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:17.381793 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:01:17.397398 [debug] [ThreadPool]: On list_dev: Close
[0m17:01:17.397398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_stage)
[0m17:01:17.397398 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m17:01:17.413022 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:01:17.413022 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:01:17.413022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:17.428654 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:01:17.444256 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:01:17.444256 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m17:01:17.444256 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:01:17.444256 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:01:17.444256 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m17:01:17.444256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:01:17.444256 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:01:17.444256 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:01:17.444256 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:01:17.444256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:01:17.444256 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m17:01:17.459875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_raw)
[0m17:01:17.459875 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m17:01:17.459875 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:01:17.459875 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:01:17.459875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:17.491097 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:01:17.491097 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:01:17.491097 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m17:01:17.491097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:01:17.491097 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:01:17.491097 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m17:01:17.491097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:01:17.491097 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:01:17.491097 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:01:17.491097 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:01:17.491097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:01:17.506716 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m17:01:17.506716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_mart)
[0m17:01:17.506716 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m17:01:17.506716 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:01:17.506716 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:01:17.506716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:17.537976 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:01:17.537976 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:01:17.537976 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m17:01:17.537976 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:01:17.537976 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:01:17.537976 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m17:01:17.537976 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:01:17.537976 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:01:17.537976 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:01:17.553596 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:01:17.553596 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:01:17.553596 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m17:01:17.553596 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_stage'
[0m17:01:17.569196 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:01:17.569196 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m17:01:17.569196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:17.584817 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:01:17.600436 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:01:17.600436 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m17:01:17.678559 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m17:01:17.678559 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m17:01:17.678559 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m17:01:17.678559 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m17:01:17.694179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main)
[0m17:01:17.694179 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:01:17.694179 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:01:17.694179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:17.709779 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:01:17.709779 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:01:17.709779 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:01:17.787877 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m17:01:17.803497 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:01:17.803497 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:01:17.803497 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:01:17.803497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_raw)
[0m17:01:17.819116 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:01:17.819116 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m17:01:17.819116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:17.834740 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:01:17.834740 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:01:17.834740 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m17:01:17.912836 [debug] [ThreadPool]: SQL status: OK in 0.074 seconds
[0m17:01:17.912836 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m17:01:17.912836 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m17:01:17.912836 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m17:01:17.928457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_mart)
[0m17:01:17.928457 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:01:17.928457 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m17:01:17.928457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:17.959790 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:01:17.959790 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:01:17.959790 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m17:01:18.037921 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m17:01:18.037921 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m17:01:18.037921 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m17:01:18.037921 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m17:01:18.056998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D050A510>]}
[0m17:01:18.058162 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:18.058745 [debug] [MainThread]: On master: BEGIN
[0m17:01:18.059848 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:18.069376 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m17:01:18.069376 [debug] [MainThread]: On master: COMMIT
[0m17:01:18.069376 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:18.069376 [debug] [MainThread]: On master: COMMIT
[0m17:01:18.085023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:01:18.085023 [debug] [MainThread]: On master: Close
[0m17:01:18.085023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:01:18.085023 [info ] [MainThread]: 
[0m17:01:18.085023 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m17:01:18.100660 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m17:01:18.100660 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m17:01:18.100660 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m17:01:18.116263 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m17:01:18.116263 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m17:01:18.194344 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m17:01:18.194344 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:01:18.194344 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m17:01:18.194344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:01:18.225584 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m17:01:18.225584 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:01:18.225584 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m17:01:18.225584 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:01:18.241211 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:01:18.241211 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw" rename to "aircrafts_raw__dbt_backup"
[0m17:01:18.241211 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.256825 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:01:18.256825 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw__dbt_tmp" rename to "aircrafts_raw"
[0m17:01:18.256825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.303705 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:01:18.303705 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:01:18.303705 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:01:18.320011 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:01:18.320011 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:01:18.320011 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
drop table if exists "dev"."main_raw"."aircrafts_raw__dbt_backup" cascade
[0m17:01:18.335856 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:01:18.335856 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m17:01:18.366883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D1EE4250>]}
[0m17:01:18.366883 [info ] [Thread-1 (]: 1 of 15 OK created sql table model main_raw.aircrafts_raw ...................... [[32mOK[0m in 0.27s]
[0m17:01:18.366883 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m17:01:18.366883 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m17:01:18.366883 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m17:01:18.366883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m17:01:18.382611 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m17:01:18.382611 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m17:01:18.382611 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m17:01:18.398144 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m17:01:18.398144 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:01:18.398144 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m17:01:18.398144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:18.429400 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:01:18.429400 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:01:18.429400 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m17:01:18.429400 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:18.444983 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:01:18.444983 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw" rename to "airports_raw__dbt_backup"
[0m17:01:18.444983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.444983 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:01:18.461318 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw__dbt_tmp" rename to "airports_raw"
[0m17:01:18.462943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.466701 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:01:18.466701 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:01:18.466701 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:01:18.474152 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:01:18.476662 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:01:18.476662 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
drop table if exists "dev"."main_raw"."airports_raw__dbt_backup" cascade
[0m17:01:18.476662 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:18.476662 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m17:01:18.508320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D1F6DC50>]}
[0m17:01:18.508320 [info ] [Thread-1 (]: 2 of 15 OK created sql table model main_raw.airports_raw ....................... [[32mOK[0m in 0.14s]
[0m17:01:18.508320 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m17:01:18.508320 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m17:01:18.523550 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m17:01:18.523550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m17:01:18.523550 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m17:01:18.523550 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m17:01:18.523550 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m17:01:18.539150 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m17:01:18.539150 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:01:18.539150 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m17:01:18.539150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:18.570414 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:01:18.570414 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:01:18.570414 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m17:01:18.586043 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:18.586043 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:01:18.586043 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw" rename to "bookings_raw__dbt_backup"
[0m17:01:18.586043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.601649 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:01:18.601649 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw__dbt_tmp" rename to "bookings_raw"
[0m17:01:18.601649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.601649 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:01:18.601649 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:01:18.601649 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:01:18.622853 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:01:18.622853 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:01:18.622853 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
drop table if exists "dev"."main_raw"."bookings_raw__dbt_backup" cascade
[0m17:01:18.633360 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:18.633360 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m17:01:18.648987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D20E8790>]}
[0m17:01:18.648987 [info ] [Thread-1 (]: 3 of 15 OK created sql table model main_raw.bookings_raw ....................... [[32mOK[0m in 0.13s]
[0m17:01:18.664606 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m17:01:18.664606 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m17:01:18.664606 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m17:01:18.664606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m17:01:18.664606 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m17:01:18.664606 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m17:01:18.680227 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m17:01:18.680227 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m17:01:18.680227 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:01:18.680227 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m17:01:18.680227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:18.727129 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:01:18.727129 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:01:18.727129 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m17:01:18.727129 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:01:18.727129 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:01:18.727129 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw" rename to "flights_raw__dbt_backup"
[0m17:01:18.742708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.742708 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:01:18.742708 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw__dbt_tmp" rename to "flights_raw"
[0m17:01:18.742708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.742708 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:01:18.742708 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:01:18.742708 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:01:18.762442 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:01:18.762442 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:01:18.762442 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
drop table if exists "dev"."main_raw"."flights_raw__dbt_backup" cascade
[0m17:01:18.762442 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:18.774448 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m17:01:18.790076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D1ED48D0>]}
[0m17:01:18.805700 [info ] [Thread-1 (]: 4 of 15 OK created sql table model main_raw.flights_raw ........................ [[32mOK[0m in 0.13s]
[0m17:01:18.805700 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m17:01:18.805700 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m17:01:18.805700 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m17:01:18.805700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m17:01:18.805700 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m17:01:18.821317 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m17:01:18.821317 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m17:01:18.821317 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m17:01:18.821317 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:01:18.821317 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m17:01:18.836961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:18.868175 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:01:18.868175 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:01:18.868175 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:01:18.868175 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:18.868175 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:01:18.868175 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "dev"."main_raw"."passengers_raw__dbt_tmp" rename to "passengers_raw"
[0m17:01:18.868175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.883817 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:01:18.883817 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:01:18.883817 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:01:18.883817 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:18.883817 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:01:18.899436 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
drop table if exists "dev"."main_raw"."passengers_raw__dbt_backup" cascade
[0m17:01:18.899436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:18.899436 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m17:01:18.915040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D20DA550>]}
[0m17:01:18.930657 [info ] [Thread-1 (]: 5 of 15 OK created sql table model main_raw.passengers_raw ..................... [[32mOK[0m in 0.11s]
[0m17:01:18.930657 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m17:01:18.930657 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m17:01:18.930657 [info ] [Thread-1 (]: 6 of 15 START sql view model main_stage.aircrafts_stg .......................... [RUN]
[0m17:01:18.930657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.aircrafts_stg)
[0m17:01:18.930657 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_stg
[0m17:01:18.946279 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_stg"
[0m17:01:18.946279 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_stg
[0m17:01:19.071602 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_stg"
[0m17:01:19.071602 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:01:19.087240 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: BEGIN
[0m17:01:19.087240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:19.102863 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:01:19.118496 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:01:19.118496 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */

  
  create view "dev"."main_stage"."aircrafts_stg__dbt_tmp" as (
    

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from "dev"."main_raw"."aircrafts_raw"
where in_service_date IS NOT null
  );

[0m17:01:19.118496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.118496 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:01:19.118496 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg" rename to "aircrafts_stg__dbt_backup"
[0m17:01:19.118496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.134083 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:01:19.134083 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg__dbt_tmp" rename to "aircrafts_stg"
[0m17:01:19.134083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.134083 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:01:19.134083 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:01:19.134083 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:01:19.149465 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:01:19.153957 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:01:19.157979 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
drop view if exists "dev"."main_stage"."aircrafts_stg__dbt_backup" cascade
[0m17:01:19.161951 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.161951 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: Close
[0m17:01:19.189926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D20C6150>]}
[0m17:01:19.193900 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main_stage.aircrafts_stg ..................... [[32mOK[0m in 0.26s]
[0m17:01:19.197931 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m17:01:19.197931 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m17:01:19.201885 [info ] [Thread-1 (]: 7 of 15 START sql view model main_stage.airports_stg ........................... [RUN]
[0m17:01:19.201885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_stg, now model.lufthansa.airports_stg)
[0m17:01:19.205899 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_stg
[0m17:01:19.213866 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_stg"
[0m17:01:19.213866 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_stg
[0m17:01:19.225846 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_stg"
[0m17:01:19.229861 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:01:19.229861 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: BEGIN
[0m17:01:19.233853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:19.265798 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m17:01:19.269792 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:01:19.269792 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */

  
  create view "dev"."main_stage"."airports_stg__dbt_tmp" as (
    

select
    UPPER(airport_code) as airport_code,
    airport_name,
    city,
    country,
    timezone
from "dev"."main_raw"."airports_raw"
  );

[0m17:01:19.273767 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:19.281753 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:01:19.285746 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg" rename to "airports_stg__dbt_backup"
[0m17:01:19.285746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.295783 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:01:19.297786 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg__dbt_tmp" rename to "airports_stg"
[0m17:01:19.297786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.305782 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:01:19.305782 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:01:19.309773 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:01:19.313750 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:01:19.321747 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:01:19.321747 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
drop view if exists "dev"."main_stage"."airports_stg__dbt_backup" cascade
[0m17:01:19.325736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.329733 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: Close
[0m17:01:19.345705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D1841E90>]}
[0m17:01:19.349697 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main_stage.airports_stg ...................... [[32mOK[0m in 0.14s]
[0m17:01:19.349697 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m17:01:19.353695 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m17:01:19.353695 [info ] [Thread-1 (]: 8 of 15 START sql view model main_stage.bookings_stg ........................... [RUN]
[0m17:01:19.357686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_stg, now model.lufthansa.bookings_stg)
[0m17:01:19.357686 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_stg
[0m17:01:19.365672 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_stg"
[0m17:01:19.369665 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_stg
[0m17:01:19.377671 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_stg"
[0m17:01:19.381709 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:01:19.381709 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: BEGIN
[0m17:01:19.381709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:19.413610 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:01:19.417605 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:01:19.417605 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */

  
  create view "dev"."main_stage"."bookings_stg__dbt_tmp" as (
    

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    UPPER(booking_status) as booking_status,
    price
from "dev"."main_raw"."bookings_raw"
where booking_status is not null
  );

[0m17:01:19.417605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.429591 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:01:19.429591 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg" rename to "bookings_stg__dbt_backup"
[0m17:01:19.433559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.441568 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:01:19.441568 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg__dbt_tmp" rename to "bookings_stg"
[0m17:01:19.445538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.449552 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:01:19.449552 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:01:19.449552 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:01:19.458867 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:01:19.465920 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:01:19.465920 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
drop view if exists "dev"."main_stage"."bookings_stg__dbt_backup" cascade
[0m17:01:19.469890 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:19.473907 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: Close
[0m17:01:19.494519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CFA6F650>]}
[0m17:01:19.494519 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main_stage.bookings_stg ...................... [[32mOK[0m in 0.14s]
[0m17:01:19.498492 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m17:01:19.498492 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m17:01:19.502490 [info ] [Thread-1 (]: 9 of 15 START sql view model main_stage.flights_stg ............................ [RUN]
[0m17:01:19.506480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_stg, now model.lufthansa.flights_stg)
[0m17:01:19.506480 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_stg
[0m17:01:19.514467 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_stg"
[0m17:01:19.514467 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_stg
[0m17:01:19.522527 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_stg"
[0m17:01:19.526469 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:01:19.526469 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: BEGIN
[0m17:01:19.530444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:19.562384 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:01:19.566400 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:01:19.566400 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */

  
  create view "dev"."main_stage"."flights_stg__dbt_tmp" as (
    

select
    flight_id,
    flight_number,
    origin_airport_code as airport_from,
    destination_airport_code as airport_to,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    upper(status) as status
from "dev"."main_raw"."flights_raw"
where status is not null
  );

[0m17:01:19.570371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.578360 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:01:19.578360 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg" rename to "flights_stg__dbt_backup"
[0m17:01:19.582352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.586365 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:01:19.590358 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg__dbt_tmp" rename to "flights_stg"
[0m17:01:19.590358 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.595520 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:01:19.595520 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:01:19.598544 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:01:19.602790 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:01:19.606811 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:01:19.610782 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
drop view if exists "dev"."main_stage"."flights_stg__dbt_backup" cascade
[0m17:01:19.614777 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:19.614777 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: Close
[0m17:01:19.634745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D18E3FD0>]}
[0m17:01:19.638765 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main_stage.flights_stg ....................... [[32mOK[0m in 0.13s]
[0m17:01:19.642731 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m17:01:19.642731 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m17:01:19.642731 [info ] [Thread-1 (]: 10 of 15 START sql view model main_stage.passengers_stg ........................ [RUN]
[0m17:01:19.646723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_stg, now model.lufthansa.passengers_stg)
[0m17:01:19.646723 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_stg
[0m17:01:19.654748 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_stg"
[0m17:01:19.658703 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_stg
[0m17:01:19.666691 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_stg"
[0m17:01:19.670683 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:01:19.670683 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: BEGIN
[0m17:01:19.674678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:19.706624 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:01:19.706624 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:01:19.710618 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */

  
  create view "dev"."main_stage"."passengers_stg__dbt_tmp" as (
    

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    LOWER(email) as email,
    phone_number
from "dev"."main_raw"."passengers_raw"
  );

[0m17:01:19.710618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.718631 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:01:19.718631 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "dev"."main_stage"."passengers_stg__dbt_tmp" rename to "passengers_stg"
[0m17:01:19.722620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.726617 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:01:19.726617 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:01:19.726617 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:01:19.730583 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:01:19.738572 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:01:19.738572 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
drop view if exists "dev"."main_stage"."passengers_stg__dbt_backup" cascade
[0m17:01:19.742567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.746559 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: Close
[0m17:01:19.766708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D18E0110>]}
[0m17:01:19.766708 [info ] [Thread-1 (]: 10 of 15 OK created sql view model main_stage.passengers_stg ................... [[32mOK[0m in 0.12s]
[0m17:01:19.770701 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m17:01:19.770701 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m17:01:19.774694 [info ] [Thread-1 (]: 11 of 15 START sql table model main_mart.daily_flights ......................... [RUN]
[0m17:01:19.774694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_stg, now model.lufthansa.daily_flights)
[0m17:01:19.774694 [debug] [Thread-1 (]: Began compiling node model.lufthansa.daily_flights
[0m17:01:19.786677 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.daily_flights"
[0m17:01:19.786677 [debug] [Thread-1 (]: Began executing node model.lufthansa.daily_flights
[0m17:01:19.794686 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.daily_flights"
[0m17:01:19.798675 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:01:19.798675 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: BEGIN
[0m17:01:19.802838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:19.818480 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:01:19.834122 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:01:19.834122 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        date(scheduled_departure_time) as flight_date,
        origin_airport,
        destination_airport,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    origin_airport,
    destination_airport,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, origin_airport, destination_airport
    );
  
  
[0m17:01:19.834122 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        date(scheduled_departure_time) as flight_date,
        origin_airport,
        destination_airport,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    origin_airport,
    destination_airport,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, origin_airport, destination_airport
    );
  
  
[0m17:01:19.849726 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:01:19.849726 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: ROLLBACK
[0m17:01:19.849726 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.daily_flights'
[0m17:01:19.849726 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: Close
[0m17:01:19.871297 [debug] [Thread-1 (]: Runtime Error in model daily_flights (models\mart\daily_flights.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  LINE 16:         date(scheduled_departure_time) as flight_date,
          origin_airport,
          destination_airport,
          status
      from "dev"."main_stage"."flights_stg"
  )
  select
      flight_date,
      origin_airport,
      destination_airport,
      count(*) as total_flights,
      sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
      sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
  from flights
  group by flight_date, origin_airport, destination_airport
      );
    
    ...
                   ^
[0m17:01:19.871297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D1E4C950>]}
[0m17:01:19.871297 [error] [Thread-1 (]: 11 of 15 ERROR creating sql table model main_mart.daily_flights ................ [[31mERROR[0m in 0.10s]
[0m17:01:19.871297 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m17:01:19.881304 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m17:01:19.881304 [info ] [Thread-1 (]: 12 of 15 START sql table model main_mart.delays ................................ [RUN]
[0m17:01:19.881304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.daily_flights, now model.lufthansa.delays)
[0m17:01:19.881304 [debug] [Thread-1 (]: Began compiling node model.lufthansa.delays
[0m17:01:19.881304 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.delays"
[0m17:01:19.881304 [debug] [Thread-1 (]: Began executing node model.lufthansa.delays
[0m17:01:19.896932 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.delays"
[0m17:01:19.896932 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:01:19.896932 [debug] [Thread-1 (]: On model.lufthansa.delays: BEGIN
[0m17:01:19.896932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:19.928172 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m17:01:19.930703 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:01:19.931730 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */

  
    
    

    create  table
      "dev"."main_mart"."delays__dbt_tmp"
  
    as (
      

WITH delays AS (
    SELECT
        flight_id,
        scheduled_departure_time,
        actual_departure_time,
        EXTRACT('epoch' FROM (actual_departure_time - scheduled_departure_time)) / 60 AS departure_delay_minutes
      --EXTRACT('epoch' FROM interval) function returns the total number of seconds contained in the interval
    FROM "dev"."main_stage"."flights_stg"
    WHERE actual_departure_time IS NOT NULL
)

SELECT
    AVG(departure_delay_minutes) AS average_delay_minutes,
    MAX(departure_delay_minutes) AS max_delay_minutes,
    MIN(departure_delay_minutes) AS min_delay_minutes,
    COUNT(*) AS total_flights
FROM delays
    );
  
  
[0m17:01:19.931730 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:01:19.931730 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:01:19.944259 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays" rename to "delays__dbt_backup"
[0m17:01:19.944259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.944259 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:01:19.944259 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays__dbt_tmp" rename to "delays"
[0m17:01:19.944259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:19.944259 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:01:19.959897 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:01:19.959897 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:01:19.959897 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:01:19.959897 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:01:19.959897 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
drop table if exists "dev"."main_mart"."delays__dbt_backup" cascade
[0m17:01:19.975507 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:19.975507 [debug] [Thread-1 (]: On model.lufthansa.delays: Close
[0m17:01:19.991514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D1EF6A10>]}
[0m17:01:19.991514 [info ] [Thread-1 (]: 12 of 15 OK created sql table model main_mart.delays ........................... [[32mOK[0m in 0.11s]
[0m17:01:19.991514 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m17:01:19.991514 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m17:01:19.991514 [info ] [Thread-1 (]: 13 of 15 START sql table model main_mart.flight_effectiveness .................. [RUN]
[0m17:01:19.991514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.delays, now model.lufthansa.flight_effectiveness)
[0m17:01:19.991514 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flight_effectiveness
[0m17:01:20.006747 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flight_effectiveness"
[0m17:01:20.006747 [debug] [Thread-1 (]: Began executing node model.lufthansa.flight_effectiveness
[0m17:01:20.022388 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flight_effectiveness"
[0m17:01:20.022388 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:01:20.022388 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: BEGIN
[0m17:01:20.022388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:20.053628 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:01:20.053628 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:01:20.053628 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */

  
    
    

    create  table
      "dev"."main_mart"."flight_effectiveness__dbt_tmp"
  
    as (
      

with flight_bookings as (
    select
        b.flight_id,
        count(*) AS booked_seats
    from "dev"."main_stage"."bookings_stg" b
    group by b.flight_id
),
flight_capacity as (
    select
        f.flight_id,
        f.aircraft_id,
        a.capacity
    from "dev"."main_stage"."flights_stg" f
    INNER JOIN "dev"."main_stage"."aircrafts_stg" a ON f.aircraft_id = a.aircraft_id
)
select
    fc.flight_id,
    fc.aircraft_id,
    fc.capacity,
    fb.booked_seats,
    (fb.booked_seats::float / fc.capacity) * 100 AS effectiveness_percentage -- typecast to float
from flight_capacity fc
LEFT JOIN flight_bookings fb ON fc.flight_id = fb.flight_id
    );
  
  
[0m17:01:20.053628 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:01:20.069227 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:01:20.069227 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness" rename to "flight_effectiveness__dbt_backup"
[0m17:01:20.069227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:20.084869 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:01:20.084869 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness__dbt_tmp" rename to "flight_effectiveness"
[0m17:01:20.084869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:20.084869 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:01:20.084869 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:01:20.084869 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:01:20.084869 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:01:20.100469 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:01:20.100469 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
drop table if exists "dev"."main_mart"."flight_effectiveness__dbt_backup" cascade
[0m17:01:20.100469 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:01:20.100469 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: Close
[0m17:01:20.131729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D0767810>]}
[0m17:01:20.131729 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main_mart.flight_effectiveness ............. [[32mOK[0m in 0.14s]
[0m17:01:20.131729 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m17:01:20.131729 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m17:01:20.131729 [info ] [Thread-1 (]: 14 of 15 START sql table model main_mart.top_routes ............................ [RUN]
[0m17:01:20.131729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flight_effectiveness, now model.lufthansa.top_routes)
[0m17:01:20.131729 [debug] [Thread-1 (]: Began compiling node model.lufthansa.top_routes
[0m17:01:20.147328 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.top_routes"
[0m17:01:20.147328 [debug] [Thread-1 (]: Began executing node model.lufthansa.top_routes
[0m17:01:20.162949 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.top_routes"
[0m17:01:20.162949 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:01:20.162949 [debug] [Thread-1 (]: On model.lufthansa.top_routes: BEGIN
[0m17:01:20.162949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:20.194640 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:01:20.194640 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:01:20.194640 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */

  
    
    

    create  table
      "dev"."main_mart"."top_routes__dbt_tmp"
  
    as (
      

SELECT
    airport_from,
    airport_to,
    COUNT(*) AS total_flights
FROM "dev"."main_stage"."flights_stg"
GROUP BY airport_from, airport_to
ORDER BY total_flights DESC
LIMIT 10
    );
  
  
[0m17:01:20.194640 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:01:20.210257 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:01:20.210257 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes" rename to "top_routes__dbt_backup"
[0m17:01:20.210257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:20.225880 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:01:20.227057 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes__dbt_tmp" rename to "top_routes"
[0m17:01:20.228670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:20.231891 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:01:20.231891 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:01:20.231891 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:01:20.237933 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:01:20.241939 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:01:20.241939 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
drop table if exists "dev"."main_mart"."top_routes__dbt_backup" cascade
[0m17:01:20.241939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:20.241939 [debug] [Thread-1 (]: On model.lufthansa.top_routes: Close
[0m17:01:20.273187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CDE1A7D0>]}
[0m17:01:20.273187 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main_mart.top_routes ....................... [[32mOK[0m in 0.14s]
[0m17:01:20.273187 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m17:01:20.273187 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m17:01:20.273187 [info ] [Thread-1 (]: 15 of 15 START sql table model main_mart.revenue_from_passengers ............... [RUN]
[0m17:01:20.273187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.top_routes, now model.lufthansa.revenue_from_passengers)
[0m17:01:20.273187 [debug] [Thread-1 (]: Began compiling node model.lufthansa.revenue_from_passengers
[0m17:01:20.288806 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.revenue_from_passengers"
[0m17:01:20.288806 [debug] [Thread-1 (]: Began executing node model.lufthansa.revenue_from_passengers
[0m17:01:20.288806 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.revenue_from_passengers"
[0m17:01:20.304426 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:01:20.304426 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: BEGIN
[0m17:01:20.304426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:20.335707 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:01:20.335707 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:01:20.335707 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */

  
    
    

    create  table
      "dev"."main_mart"."revenue_from_passengers__dbt_tmp"
  
    as (
      

select
    p.passenger_id,
    p.first_name,
    p.last_name,
    sum(b.price) as total_revenue,
    count(*) as total_bookings
from "dev"."main_stage"."passengers_stg" p
INNER JOIN "dev"."main_stage"."bookings_stg" b on p.passenger_id = b.passenger_id
group BY p.passenger_id, p.first_name, p.last_name
    );
  
  
[0m17:01:20.335707 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:01:20.351285 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:01:20.351285 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "dev"."main_mart"."revenue_from_passengers__dbt_tmp" rename to "revenue_from_passengers"
[0m17:01:20.351285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:20.351285 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:01:20.351285 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:01:20.351285 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:01:20.366907 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:01:20.366907 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:01:20.366907 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
drop table if exists "dev"."main_mart"."revenue_from_passengers__dbt_backup" cascade
[0m17:01:20.366907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:01:20.382529 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: Close
[0m17:01:20.398147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac927cc-a13e-40e7-addb-8d3feb7c7c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D04D4A90>]}
[0m17:01:20.413768 [info ] [Thread-1 (]: 15 of 15 OK created sql table model main_mart.revenue_from_passengers .......... [[32mOK[0m in 0.12s]
[0m17:01:20.413768 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m17:01:20.413768 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:20.413768 [debug] [MainThread]: On master: BEGIN
[0m17:01:20.413768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:20.460626 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m17:01:20.460626 [debug] [MainThread]: On master: COMMIT
[0m17:01:20.460626 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:20.460626 [debug] [MainThread]: On master: COMMIT
[0m17:01:20.460626 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:01:20.460626 [debug] [MainThread]: On master: Close
[0m17:01:20.460626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:20.460626 [debug] [MainThread]: Connection 'create_dev_main_mart' was properly closed.
[0m17:01:20.476267 [debug] [MainThread]: Connection 'list_dev_main_mart' was properly closed.
[0m17:01:20.476267 [debug] [MainThread]: Connection 'model.lufthansa.revenue_from_passengers' was properly closed.
[0m17:01:20.476267 [info ] [MainThread]: 
[0m17:01:20.476267 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m17:01:20.476267 [debug] [MainThread]: Command end result
[0m17:01:20.554351 [info ] [MainThread]: 
[0m17:01:20.554351 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:01:20.554351 [info ] [MainThread]: 
[0m17:01:20.554351 [error] [MainThread]:   Runtime Error in model daily_flights (models\mart\daily_flights.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  LINE 16:         date(scheduled_departure_time) as flight_date,
          origin_airport,
          destination_airport,
          status
      from "dev"."main_stage"."flights_stg"
  )
  select
      flight_date,
      origin_airport,
      destination_airport,
      count(*) as total_flights,
      sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
      sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
  from flights
  group by flight_date, origin_airport, destination_airport
      );
    
    ...
                   ^
[0m17:01:20.554351 [info ] [MainThread]: 
[0m17:01:20.569966 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m17:01:20.569966 [debug] [MainThread]: Command `dbt run` failed at 17:01:20.569966 after 5.19 seconds
[0m17:01:20.569966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C9F2E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CA1FD990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6CA1FD850>]}
[0m17:01:20.569966 [debug] [MainThread]: Flushing usage events
[0m17:06:06.371240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F62D110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F62F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F62CED0>]}


============================== 17:06:06.371240 | 4d40b1c8-7d83-4d19-86f6-f69bffcef7f4 ==============================
[0m17:06:06.371240 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:06:06.386838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:06:06.824686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F62CD90>]}
[0m17:06:06.934064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720CAC9CD0>]}
[0m17:06:06.949684 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:06:06.965291 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:06:07.277670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:06:07.277670 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\mart\daily_flights.sql
[0m17:06:07.715034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017210A07950>]}
[0m17:06:07.918288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017210D0A790>]}
[0m17:06:07.918288 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:06:07.918288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F6D7610>]}
[0m17:06:07.918288 [info ] [MainThread]: 
[0m17:06:07.933912 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:06:07.949528 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:06:08.121901 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:06:08.121901 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:06:08.121901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:08.153106 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m17:06:08.153106 [debug] [ThreadPool]: On list_dev: Close
[0m17:06:08.168744 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:06:08.168744 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:06:08.168744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:08.200000 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:06:08.200000 [debug] [ThreadPool]: On list_dev: Close
[0m17:06:08.200000 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:06:08.215607 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:06:08.215607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:08.231206 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:06:08.231206 [debug] [ThreadPool]: On list_dev: Close
[0m17:06:08.246845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_stage)
[0m17:06:08.246845 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m17:06:08.262484 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:06:08.262484 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:06:08.262484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:08.278109 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:06:08.293686 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:06:08.293686 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m17:06:08.293686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:06:08.293686 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:06:08.293686 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m17:06:08.293686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:06:08.293686 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:06:08.293686 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:06:08.293686 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:06:08.293686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:06:08.293686 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m17:06:08.309328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_mart)
[0m17:06:08.309328 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m17:06:08.309328 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:06:08.309328 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:06:08.309328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:08.340545 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:06:08.340545 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:06:08.340545 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m17:06:08.340545 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:06:08.340545 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:06:08.340545 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m17:06:08.340545 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:06:08.356164 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:06:08.356164 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:06:08.356164 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:06:08.356164 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:06:08.356164 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m17:06:08.356164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_mart, now create_dev_main_raw)
[0m17:06:08.356164 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m17:06:08.371785 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:06:08.371785 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:06:08.371785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:08.403026 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:06:08.403026 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:06:08.403026 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m17:06:08.403026 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:06:08.403026 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:06:08.403026 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m17:06:08.403026 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:06:08.403026 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:06:08.418646 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:06:08.418646 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:06:08.418646 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:06:08.418646 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m17:06:08.418646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_stage'
[0m17:06:08.434287 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:06:08.434287 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m17:06:08.434287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:08.465508 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:06:08.465508 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:06:08.465508 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m17:06:08.543652 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m17:06:08.543652 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m17:06:08.543652 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m17:06:08.543652 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m17:06:08.559250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_mart)
[0m17:06:08.559250 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:06:08.559250 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m17:06:08.559250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:08.590500 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:06:08.590500 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:06:08.590500 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m17:06:08.668590 [debug] [ThreadPool]: SQL status: OK in 0.074 seconds
[0m17:06:08.668590 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m17:06:08.668590 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m17:06:08.668590 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m17:06:08.668590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main)
[0m17:06:08.684207 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:06:08.684207 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:06:08.684207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:08.699841 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:06:08.699841 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:06:08.715447 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:06:08.793527 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m17:06:08.793527 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:06:08.793527 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:06:08.793527 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:06:08.793527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_raw)
[0m17:06:08.809148 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:06:08.809148 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m17:06:08.809148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:08.824788 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:06:08.824788 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:06:08.824788 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m17:06:08.902901 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m17:06:08.918521 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m17:06:08.918521 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m17:06:08.918521 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m17:06:08.918521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F4AF410>]}
[0m17:06:08.918521 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:08.918521 [debug] [MainThread]: On master: BEGIN
[0m17:06:08.934108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:08.949732 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m17:06:08.949732 [debug] [MainThread]: On master: COMMIT
[0m17:06:08.949732 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:08.949732 [debug] [MainThread]: On master: COMMIT
[0m17:06:08.949732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:06:08.949732 [debug] [MainThread]: On master: Close
[0m17:06:08.965348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:08.965348 [info ] [MainThread]: 
[0m17:06:08.965348 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m17:06:08.965348 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m17:06:08.965348 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m17:06:08.981003 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m17:06:08.996608 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m17:06:08.996608 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m17:06:09.074722 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m17:06:09.074722 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:06:09.074722 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m17:06:09.074722 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:09.090309 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m17:06:09.090309 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:06:09.090309 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m17:06:09.105949 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:09.105949 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:06:09.121570 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw" rename to "aircrafts_raw__dbt_backup"
[0m17:06:09.121570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.121570 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:06:09.121570 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw__dbt_tmp" rename to "aircrafts_raw"
[0m17:06:09.121570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.181571 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:06:09.185587 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:06:09.185587 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:06:09.191705 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:06:09.201744 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:06:09.201744 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
drop table if exists "dev"."main_raw"."aircrafts_raw__dbt_backup" cascade
[0m17:06:09.207703 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:09.210209 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m17:06:09.238026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F978CD0>]}
[0m17:06:09.238026 [info ] [Thread-1 (]: 1 of 15 OK created sql table model main_raw.aircrafts_raw ...................... [[32mOK[0m in 0.27s]
[0m17:06:09.242020 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m17:06:09.242020 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m17:06:09.246012 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m17:06:09.246012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m17:06:09.250004 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m17:06:09.261986 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m17:06:09.261986 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m17:06:09.273965 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m17:06:09.277960 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:06:09.277960 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m17:06:09.277960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:09.310201 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:06:09.310201 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:06:09.314197 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m17:06:09.318189 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:09.322183 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:06:09.322183 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw" rename to "airports_raw__dbt_backup"
[0m17:06:09.326180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.334162 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:06:09.334162 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw__dbt_tmp" rename to "airports_raw"
[0m17:06:09.334162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.338155 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:06:09.338155 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:06:09.342148 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:06:09.346150 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:06:09.350135 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:06:09.354128 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
drop table if exists "dev"."main_raw"."airports_raw__dbt_backup" cascade
[0m17:06:09.354128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.358122 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m17:06:09.412124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017211264810>]}
[0m17:06:09.416116 [info ] [Thread-1 (]: 2 of 15 OK created sql table model main_raw.airports_raw ....................... [[32mOK[0m in 0.17s]
[0m17:06:09.416116 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m17:06:09.420110 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m17:06:09.420110 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m17:06:09.424104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m17:06:09.428098 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m17:06:09.436086 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m17:06:09.440075 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m17:06:09.476016 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m17:06:09.480008 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:06:09.480008 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m17:06:09.480008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:09.515967 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:06:09.515967 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:06:09.519969 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m17:06:09.519969 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:09.531947 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:06:09.531947 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw" rename to "bookings_raw__dbt_backup"
[0m17:06:09.535942 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.539935 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:06:09.543927 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw__dbt_tmp" rename to "bookings_raw"
[0m17:06:09.543927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.547920 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:06:09.551914 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:06:09.551914 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:06:09.557001 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:06:09.564003 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:06:09.564003 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
drop table if exists "dev"."main_raw"."bookings_raw__dbt_backup" cascade
[0m17:06:09.564003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.567997 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m17:06:09.591959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172112B8D50>]}
[0m17:06:09.595953 [info ] [Thread-1 (]: 3 of 15 OK created sql table model main_raw.bookings_raw ....................... [[32mOK[0m in 0.17s]
[0m17:06:09.595953 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m17:06:09.599966 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m17:06:09.599966 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m17:06:09.599966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m17:06:09.603939 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m17:06:09.611927 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m17:06:09.615920 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m17:06:09.623906 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m17:06:09.627936 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:06:09.627936 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m17:06:09.631893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:09.663840 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:06:09.667833 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:06:09.667833 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m17:06:09.671825 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:06:09.675821 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:06:09.679812 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw" rename to "flights_raw__dbt_backup"
[0m17:06:09.683805 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.692455 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:06:09.694039 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw__dbt_tmp" rename to "flights_raw"
[0m17:06:09.695660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.699660 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:06:09.699660 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:06:09.703654 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:06:09.714840 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:06:09.720348 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:06:09.720348 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
drop table if exists "dev"."main_raw"."flights_raw__dbt_backup" cascade
[0m17:06:09.724340 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:09.724340 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m17:06:09.756567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017210A6F810>]}
[0m17:06:09.760594 [info ] [Thread-1 (]: 4 of 15 OK created sql table model main_raw.flights_raw ........................ [[32mOK[0m in 0.16s]
[0m17:06:09.760594 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m17:06:09.764723 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m17:06:09.764723 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m17:06:09.764723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m17:06:09.764723 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m17:06:09.764723 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m17:06:09.764723 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m17:06:09.780344 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m17:06:09.780344 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:06:09.780344 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m17:06:09.780344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:09.811604 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:06:09.811604 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:06:09.811604 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:06:09.827241 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:09.827241 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:06:09.827241 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "dev"."main_raw"."passengers_raw" rename to "passengers_raw__dbt_backup"
[0m17:06:09.827241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.842844 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:06:09.842844 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "dev"."main_raw"."passengers_raw__dbt_tmp" rename to "passengers_raw"
[0m17:06:09.842844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.842844 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:06:09.842844 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:06:09.842844 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:06:09.842844 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:09.858463 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:06:09.858463 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
drop table if exists "dev"."main_raw"."passengers_raw__dbt_backup" cascade
[0m17:06:09.858463 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:09.858463 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m17:06:09.889702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017210BC1F10>]}
[0m17:06:09.889702 [info ] [Thread-1 (]: 5 of 15 OK created sql table model main_raw.passengers_raw ..................... [[32mOK[0m in 0.12s]
[0m17:06:09.889702 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m17:06:09.889702 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m17:06:09.889702 [info ] [Thread-1 (]: 6 of 15 START sql view model main_stage.aircrafts_stg .......................... [RUN]
[0m17:06:09.905325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.aircrafts_stg)
[0m17:06:09.905325 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_stg
[0m17:06:10.004339 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_stg"
[0m17:06:10.004339 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_stg
[0m17:06:10.048191 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_stg"
[0m17:06:10.048191 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:06:10.048191 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: BEGIN
[0m17:06:10.048191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:10.078392 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:06:10.078392 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:06:10.078392 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */

  
  create view "dev"."main_stage"."aircrafts_stg__dbt_tmp" as (
    

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from "dev"."main_raw"."aircrafts_raw"
where in_service_date IS NOT null
  );

[0m17:06:10.078392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.093997 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:06:10.093997 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg" rename to "aircrafts_stg__dbt_backup"
[0m17:06:10.093997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.093997 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:06:10.093997 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg__dbt_tmp" rename to "aircrafts_stg"
[0m17:06:10.093997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.109615 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:06:10.109615 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:06:10.109615 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:06:10.109615 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:06:10.109615 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:06:10.109615 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
drop view if exists "dev"."main_stage"."aircrafts_stg__dbt_backup" cascade
[0m17:06:10.125233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.125233 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: Close
[0m17:06:10.140848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017210AB1710>]}
[0m17:06:10.140848 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main_stage.aircrafts_stg ..................... [[32mOK[0m in 0.24s]
[0m17:06:10.140848 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m17:06:10.140848 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m17:06:10.140848 [info ] [Thread-1 (]: 7 of 15 START sql view model main_stage.airports_stg ........................... [RUN]
[0m17:06:10.140848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_stg, now model.lufthansa.airports_stg)
[0m17:06:10.140848 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_stg
[0m17:06:10.156451 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_stg"
[0m17:06:10.156451 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_stg
[0m17:06:10.172098 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_stg"
[0m17:06:10.172098 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:06:10.172098 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: BEGIN
[0m17:06:10.172098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:10.203347 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:06:10.203347 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:06:10.203347 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */

  
  create view "dev"."main_stage"."airports_stg__dbt_tmp" as (
    

select
    UPPER(airport_code) as airport_code,
    airport_name,
    city,
    country,
    timezone
from "dev"."main_raw"."airports_raw"
  );

[0m17:06:10.203347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.218956 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:06:10.218956 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg" rename to "airports_stg__dbt_backup"
[0m17:06:10.218956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.218956 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:06:10.218956 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg__dbt_tmp" rename to "airports_stg"
[0m17:06:10.218956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.235365 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:06:10.236524 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:06:10.237607 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:06:10.243271 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:06:10.250298 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:06:10.250298 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
drop view if exists "dev"."main_stage"."airports_stg__dbt_backup" cascade
[0m17:06:10.250298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.250298 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: Close
[0m17:06:10.265944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017210A5F9D0>]}
[0m17:06:10.265944 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main_stage.airports_stg ...................... [[32mOK[0m in 0.13s]
[0m17:06:10.265944 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m17:06:10.265944 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m17:06:10.265944 [info ] [Thread-1 (]: 8 of 15 START sql view model main_stage.bookings_stg ........................... [RUN]
[0m17:06:10.281548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_stg, now model.lufthansa.bookings_stg)
[0m17:06:10.281548 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_stg
[0m17:06:10.281548 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_stg"
[0m17:06:10.281548 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_stg
[0m17:06:10.297189 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_stg"
[0m17:06:10.297189 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:06:10.297189 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: BEGIN
[0m17:06:10.297189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:10.328427 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:06:10.328427 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:06:10.328427 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */

  
  create view "dev"."main_stage"."bookings_stg__dbt_tmp" as (
    

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    UPPER(booking_status) as booking_status,
    price
from "dev"."main_raw"."bookings_raw"
where booking_status is not null
  );

[0m17:06:10.328427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.344027 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:06:10.344027 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg" rename to "bookings_stg__dbt_backup"
[0m17:06:10.344027 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.344027 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:06:10.359667 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg__dbt_tmp" rename to "bookings_stg"
[0m17:06:10.359667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.359667 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:06:10.359667 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:06:10.359667 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:06:10.359667 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:10.375288 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:06:10.375288 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
drop view if exists "dev"."main_stage"."bookings_stg__dbt_backup" cascade
[0m17:06:10.375288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.375288 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: Close
[0m17:06:10.390928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720EC3EC90>]}
[0m17:06:10.390928 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main_stage.bookings_stg ...................... [[32mOK[0m in 0.11s]
[0m17:06:10.390928 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m17:06:10.390928 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m17:06:10.406504 [info ] [Thread-1 (]: 9 of 15 START sql view model main_stage.flights_stg ............................ [RUN]
[0m17:06:10.406504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_stg, now model.lufthansa.flights_stg)
[0m17:06:10.406504 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_stg
[0m17:06:10.406504 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_stg"
[0m17:06:10.406504 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_stg
[0m17:06:10.422148 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_stg"
[0m17:06:10.422148 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:06:10.422148 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: BEGIN
[0m17:06:10.422148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:10.453395 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:06:10.453395 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:06:10.453395 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */

  
  create view "dev"."main_stage"."flights_stg__dbt_tmp" as (
    

select
    flight_id,
    flight_number,
    origin_airport_code as airport_from,
    destination_airport_code as airport_to,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    upper(status) as status
from "dev"."main_raw"."flights_raw"
where status is not null
  );

[0m17:06:10.453395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.469012 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:06:10.469012 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg" rename to "flights_stg__dbt_backup"
[0m17:06:10.469012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.469012 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:06:10.469012 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg__dbt_tmp" rename to "flights_stg"
[0m17:06:10.469012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.484628 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:06:10.484628 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:06:10.484628 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:06:10.484628 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:10.484628 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:06:10.484628 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
drop view if exists "dev"."main_stage"."flights_stg__dbt_backup" cascade
[0m17:06:10.500274 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:10.500274 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: Close
[0m17:06:10.515870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F7148D0>]}
[0m17:06:10.515870 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main_stage.flights_stg ....................... [[32mOK[0m in 0.11s]
[0m17:06:10.515870 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m17:06:10.515870 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m17:06:10.531474 [info ] [Thread-1 (]: 10 of 15 START sql view model main_stage.passengers_stg ........................ [RUN]
[0m17:06:10.531474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_stg, now model.lufthansa.passengers_stg)
[0m17:06:10.531474 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_stg
[0m17:06:10.531474 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_stg"
[0m17:06:10.547087 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_stg
[0m17:06:10.547087 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_stg"
[0m17:06:10.562710 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:06:10.562710 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: BEGIN
[0m17:06:10.562710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:10.593979 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:06:10.593979 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:06:10.593979 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */

  
  create view "dev"."main_stage"."passengers_stg__dbt_tmp" as (
    

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    LOWER(email) as email,
    phone_number
from "dev"."main_raw"."passengers_raw"
  );

[0m17:06:10.593979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.609568 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:06:10.609568 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "dev"."main_stage"."passengers_stg" rename to "passengers_stg__dbt_backup"
[0m17:06:10.609568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.609568 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:06:10.609568 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "dev"."main_stage"."passengers_stg__dbt_tmp" rename to "passengers_stg"
[0m17:06:10.609568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.625188 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:06:10.625188 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:06:10.625188 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:06:10.625188 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:10.640827 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:06:10.640827 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
drop view if exists "dev"."main_stage"."passengers_stg__dbt_backup" cascade
[0m17:06:10.640827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.640827 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: Close
[0m17:06:10.656471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720D018710>]}
[0m17:06:10.656471 [info ] [Thread-1 (]: 10 of 15 OK created sql view model main_stage.passengers_stg ................... [[32mOK[0m in 0.12s]
[0m17:06:10.656471 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m17:06:10.656471 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m17:06:10.672126 [info ] [Thread-1 (]: 11 of 15 START sql table model main_mart.daily_flights ......................... [RUN]
[0m17:06:10.672126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_stg, now model.lufthansa.daily_flights)
[0m17:06:10.672126 [debug] [Thread-1 (]: Began compiling node model.lufthansa.daily_flights
[0m17:06:10.672126 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.daily_flights"
[0m17:06:10.672126 [debug] [Thread-1 (]: Began executing node model.lufthansa.daily_flights
[0m17:06:10.687692 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.daily_flights"
[0m17:06:10.687692 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:06:10.687692 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: BEGIN
[0m17:06:10.687692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:10.718947 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:06:10.718947 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:06:10.718947 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        -- date(scheduled_departure_time) as flight_date,
        -- Function with name date does not exist! Did you mean "datesub"?
        CAST (scheduled_departure_time AS DATE) as flight_date,
        origin_airport,
        destination_airport,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    origin_airport,
    destination_airport,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, origin_airport, destination_airport
    );
  
  
[0m17:06:10.718947 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        -- date(scheduled_departure_time) as flight_date,
        -- Function with name date does not exist! Did you mean "datesub"?
        CAST (scheduled_departure_time AS DATE) as flight_date,
        origin_airport,
        destination_airport,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    origin_airport,
    destination_airport,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, origin_airport, destination_airport
    );
  
  
[0m17:06:10.718947 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:06:10.734548 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: ROLLBACK
[0m17:06:10.734548 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.daily_flights'
[0m17:06:10.734548 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: Close
[0m17:06:10.750169 [debug] [Thread-1 (]: Runtime Error in model daily_flights (models\mart\daily_flights.sql)
  Binder Error: Referenced column "origin_airport" not found in FROM clause!
  Candidate bindings: "flights_stg.airport_to", "flights_stg.aircraft_id", "flights_stg.airport_from", "flights_stg.flight_number"
  LINE 19:         origin_airport,
                   ^
[0m17:06:10.750169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017210BFBA90>]}
[0m17:06:10.750169 [error] [Thread-1 (]: 11 of 15 ERROR creating sql table model main_mart.daily_flights ................ [[31mERROR[0m in 0.08s]
[0m17:06:10.750169 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m17:06:10.750169 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m17:06:10.750169 [info ] [Thread-1 (]: 12 of 15 START sql table model main_mart.delays ................................ [RUN]
[0m17:06:10.765765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.daily_flights, now model.lufthansa.delays)
[0m17:06:10.765765 [debug] [Thread-1 (]: Began compiling node model.lufthansa.delays
[0m17:06:10.765765 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.delays"
[0m17:06:10.765765 [debug] [Thread-1 (]: Began executing node model.lufthansa.delays
[0m17:06:10.781409 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.delays"
[0m17:06:10.781409 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:06:10.781409 [debug] [Thread-1 (]: On model.lufthansa.delays: BEGIN
[0m17:06:10.781409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:10.797027 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m17:06:10.797027 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:06:10.812648 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */

  
    
    

    create  table
      "dev"."main_mart"."delays__dbt_tmp"
  
    as (
      

WITH delays AS (
    SELECT
        flight_id,
        scheduled_departure_time,
        actual_departure_time,
        EXTRACT('epoch' FROM (actual_departure_time - scheduled_departure_time)) / 60 AS departure_delay_minutes
      --EXTRACT('epoch' FROM interval) function returns the total number of seconds contained in the interval
    FROM "dev"."main_stage"."flights_stg"
    WHERE actual_departure_time IS NOT NULL
)

SELECT
    AVG(departure_delay_minutes) AS average_delay_minutes,
    MAX(departure_delay_minutes) AS max_delay_minutes,
    MIN(departure_delay_minutes) AS min_delay_minutes,
    COUNT(*) AS total_flights
FROM delays
    );
  
  
[0m17:06:10.812648 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:06:10.812648 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:06:10.812648 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays" rename to "delays__dbt_backup"
[0m17:06:10.812648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.830118 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:06:10.830118 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays__dbt_tmp" rename to "delays"
[0m17:06:10.830118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.830118 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:06:10.830118 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:06:10.830118 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:06:10.844965 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:06:10.844965 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:06:10.844965 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
drop table if exists "dev"."main_mart"."delays__dbt_backup" cascade
[0m17:06:10.844965 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:10.859495 [debug] [Thread-1 (]: On model.lufthansa.delays: Close
[0m17:06:10.875244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017210CCD0D0>]}
[0m17:06:10.875244 [info ] [Thread-1 (]: 12 of 15 OK created sql table model main_mart.delays ........................... [[32mOK[0m in 0.11s]
[0m17:06:10.875244 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m17:06:10.875244 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m17:06:10.875244 [info ] [Thread-1 (]: 13 of 15 START sql table model main_mart.flight_effectiveness .................. [RUN]
[0m17:06:10.875244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.delays, now model.lufthansa.flight_effectiveness)
[0m17:06:10.875244 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flight_effectiveness
[0m17:06:10.890763 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flight_effectiveness"
[0m17:06:10.890763 [debug] [Thread-1 (]: Began executing node model.lufthansa.flight_effectiveness
[0m17:06:10.906387 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flight_effectiveness"
[0m17:06:10.906387 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:06:10.906387 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: BEGIN
[0m17:06:10.906387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:10.937624 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:06:10.937624 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:06:10.937624 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */

  
    
    

    create  table
      "dev"."main_mart"."flight_effectiveness__dbt_tmp"
  
    as (
      

with flight_bookings as (
    select
        b.flight_id,
        count(*) AS booked_seats
    from "dev"."main_stage"."bookings_stg" b
    group by b.flight_id
),
flight_capacity as (
    select
        f.flight_id,
        f.aircraft_id,
        a.capacity
    from "dev"."main_stage"."flights_stg" f
    INNER JOIN "dev"."main_stage"."aircrafts_stg" a ON f.aircraft_id = a.aircraft_id
)
select
    fc.flight_id,
    fc.aircraft_id,
    fc.capacity,
    fb.booked_seats,
    (fb.booked_seats::float / fc.capacity) * 100 AS effectiveness_percentage -- typecast to float
from flight_capacity fc
LEFT JOIN flight_bookings fb ON fc.flight_id = fb.flight_id
    );
  
  
[0m17:06:10.937624 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:06:10.953223 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:06:10.953223 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness" rename to "flight_effectiveness__dbt_backup"
[0m17:06:10.953223 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.968872 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:06:10.968872 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness__dbt_tmp" rename to "flight_effectiveness"
[0m17:06:10.968872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:10.968872 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:06:10.968872 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:06:10.968872 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:06:10.984483 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:06:10.984483 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:06:10.984483 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
drop table if exists "dev"."main_mart"."flight_effectiveness__dbt_backup" cascade
[0m17:06:10.984483 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:10.984483 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: Close
[0m17:06:11.015723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F9D0B50>]}
[0m17:06:11.015723 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main_mart.flight_effectiveness ............. [[32mOK[0m in 0.14s]
[0m17:06:11.015723 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m17:06:11.015723 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m17:06:11.015723 [info ] [Thread-1 (]: 14 of 15 START sql table model main_mart.top_routes ............................ [RUN]
[0m17:06:11.015723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flight_effectiveness, now model.lufthansa.top_routes)
[0m17:06:11.031344 [debug] [Thread-1 (]: Began compiling node model.lufthansa.top_routes
[0m17:06:11.031344 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.top_routes"
[0m17:06:11.031344 [debug] [Thread-1 (]: Began executing node model.lufthansa.top_routes
[0m17:06:11.046963 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.top_routes"
[0m17:06:11.046963 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:06:11.046963 [debug] [Thread-1 (]: On model.lufthansa.top_routes: BEGIN
[0m17:06:11.046963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:11.078203 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:06:11.078203 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:06:11.078203 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */

  
    
    

    create  table
      "dev"."main_mart"."top_routes__dbt_tmp"
  
    as (
      

SELECT
    airport_from,
    airport_to,
    COUNT(*) AS total_flights
FROM "dev"."main_stage"."flights_stg"
GROUP BY airport_from, airport_to
ORDER BY total_flights DESC
LIMIT 10
    );
  
  
[0m17:06:11.078203 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:06:11.093830 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:06:11.093830 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes" rename to "top_routes__dbt_backup"
[0m17:06:11.093830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:11.093830 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:06:11.093830 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes__dbt_tmp" rename to "top_routes"
[0m17:06:11.109424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:11.109424 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:06:11.109424 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:06:11.109424 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:06:11.109424 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:11.125065 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:06:11.125065 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
drop table if exists "dev"."main_mart"."top_routes__dbt_backup" cascade
[0m17:06:11.125065 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:11.125065 [debug] [Thread-1 (]: On model.lufthansa.top_routes: Close
[0m17:06:11.140684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720F9BCC90>]}
[0m17:06:11.156305 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main_mart.top_routes ....................... [[32mOK[0m in 0.12s]
[0m17:06:11.156305 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m17:06:11.156305 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m17:06:11.156305 [info ] [Thread-1 (]: 15 of 15 START sql table model main_mart.revenue_from_passengers ............... [RUN]
[0m17:06:11.156305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.top_routes, now model.lufthansa.revenue_from_passengers)
[0m17:06:11.156305 [debug] [Thread-1 (]: Began compiling node model.lufthansa.revenue_from_passengers
[0m17:06:11.156305 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.revenue_from_passengers"
[0m17:06:11.171904 [debug] [Thread-1 (]: Began executing node model.lufthansa.revenue_from_passengers
[0m17:06:11.171904 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.revenue_from_passengers"
[0m17:06:11.171904 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:06:11.171904 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: BEGIN
[0m17:06:11.171904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:11.203169 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:06:11.203169 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:06:11.203169 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */

  
    
    

    create  table
      "dev"."main_mart"."revenue_from_passengers__dbt_tmp"
  
    as (
      

select
    p.passenger_id,
    p.first_name,
    p.last_name,
    sum(b.price) as total_revenue,
    count(*) as total_bookings
from "dev"."main_stage"."passengers_stg" p
INNER JOIN "dev"."main_stage"."bookings_stg" b on p.passenger_id = b.passenger_id
group BY p.passenger_id, p.first_name, p.last_name
    );
  
  
[0m17:06:11.218767 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:06:11.218767 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:06:11.218767 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "dev"."main_mart"."revenue_from_passengers" rename to "revenue_from_passengers__dbt_backup"
[0m17:06:11.218767 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:11.234405 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:06:11.234405 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "dev"."main_mart"."revenue_from_passengers__dbt_tmp" rename to "revenue_from_passengers"
[0m17:06:11.234405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:06:11.234405 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:06:11.234405 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:06:11.234405 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:06:11.260675 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:06:11.265705 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:06:11.265705 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
drop table if exists "dev"."main_mart"."revenue_from_passengers__dbt_backup" cascade
[0m17:06:11.265705 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:06:11.265705 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: Close
[0m17:06:11.296952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d40b1c8-7d83-4d19-86f6-f69bffcef7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017210B85610>]}
[0m17:06:11.296952 [info ] [Thread-1 (]: 15 of 15 OK created sql table model main_mart.revenue_from_passengers .......... [[32mOK[0m in 0.14s]
[0m17:06:11.296952 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m17:06:11.296952 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:11.296952 [debug] [MainThread]: On master: BEGIN
[0m17:06:11.296952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:11.328713 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m17:06:11.328713 [debug] [MainThread]: On master: COMMIT
[0m17:06:11.328713 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:11.344221 [debug] [MainThread]: On master: COMMIT
[0m17:06:11.344221 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:06:11.344221 [debug] [MainThread]: On master: Close
[0m17:06:11.344221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:11.344221 [debug] [MainThread]: Connection 'create_dev_main_raw' was properly closed.
[0m17:06:11.344221 [debug] [MainThread]: Connection 'list_dev_main_raw' was properly closed.
[0m17:06:11.344221 [debug] [MainThread]: Connection 'model.lufthansa.revenue_from_passengers' was properly closed.
[0m17:06:11.344221 [info ] [MainThread]: 
[0m17:06:11.344221 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m17:06:11.359885 [debug] [MainThread]: Command end result
[0m17:06:11.438244 [info ] [MainThread]: 
[0m17:06:11.438244 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:06:11.438244 [info ] [MainThread]: 
[0m17:06:11.438244 [error] [MainThread]:   Runtime Error in model daily_flights (models\mart\daily_flights.sql)
  Binder Error: Referenced column "origin_airport" not found in FROM clause!
  Candidate bindings: "flights_stg.airport_to", "flights_stg.aircraft_id", "flights_stg.airport_from", "flights_stg.flight_number"
  LINE 19:         origin_airport,
                   ^
[0m17:06:11.438244 [info ] [MainThread]: 
[0m17:06:11.438244 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m17:06:11.438244 [debug] [MainThread]: Command `dbt run` failed at 17:06:11.438244 after 5.22 seconds
[0m17:06:11.438244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172090FE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172093CD8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172093CD850>]}
[0m17:06:11.438244 [debug] [MainThread]: Flushing usage events
[0m17:07:47.993464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB185C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB185D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB185CBD0>]}


============================== 17:07:48.009084 | cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c ==============================
[0m17:07:48.009084 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:07:48.009084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:07:48.477685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB18F4F10>]}
[0m17:07:48.587532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAECFDD50>]}
[0m17:07:48.587532 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:07:48.603113 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:07:48.915549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:48.915549 [debug] [MainThread]: Partial parsing: updated file: lufthansa://models\mart\daily_flights.sql
[0m17:07:49.399466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB1853490>]}
[0m17:07:49.606997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB2C9F790>]}
[0m17:07:49.610990 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:07:49.610990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB2C38810>]}
[0m17:07:49.615017 [info ] [MainThread]: 
[0m17:07:49.619015 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:07:49.640147 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:07:49.822224 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:07:49.822224 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:07:49.822224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:49.853430 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m17:07:49.853430 [debug] [ThreadPool]: On list_dev: Close
[0m17:07:49.869071 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:07:49.869071 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:07:49.869071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:49.884693 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:07:49.900310 [debug] [ThreadPool]: On list_dev: Close
[0m17:07:49.900310 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:07:49.900310 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:07:49.900310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:49.931557 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:07:49.931557 [debug] [ThreadPool]: On list_dev: Close
[0m17:07:49.947171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_raw)
[0m17:07:49.947171 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m17:07:49.962810 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:07:49.962810 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:07:49.962810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:49.979075 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:07:49.994746 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:07:49.994746 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m17:07:49.994746 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:07:49.994746 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:07:49.994746 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m17:07:49.994746 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:49.994746 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:07:49.994746 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:07:49.994746 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:07:49.994746 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:49.994746 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m17:07:50.010362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_stage)
[0m17:07:50.010362 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m17:07:50.010362 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:07:50.010362 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:07:50.010362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:50.041601 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:07:50.041601 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:07:50.041601 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m17:07:50.041601 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:50.041601 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:07:50.041601 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m17:07:50.041601 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:50.041601 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:07:50.041601 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:07:50.057221 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:07:50.057221 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:50.057221 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m17:07:50.057221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_mart)
[0m17:07:50.057221 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m17:07:50.057221 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:07:50.072844 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:07:50.072844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:50.088467 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:07:50.088467 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:07:50.088467 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m17:07:50.088467 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:07:50.088467 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:07:50.104082 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m17:07:50.104082 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:50.104082 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:07:50.104082 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:07:50.104082 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:07:50.104082 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:50.104082 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m17:07:50.119701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_raw'
[0m17:07:50.119701 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:07:50.135326 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m17:07:50.135326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:50.150923 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:07:50.150923 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:07:50.150923 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m17:07:50.244661 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m17:07:50.244661 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m17:07:50.244661 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m17:07:50.244661 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m17:07:50.260282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main)
[0m17:07:50.260282 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:07:50.260282 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:07:50.260282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:50.291520 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:07:50.291520 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:07:50.291520 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:07:50.369623 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m17:07:50.369623 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:07:50.369623 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:07:50.369623 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:07:50.385257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_stage)
[0m17:07:50.385257 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:07:50.385257 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m17:07:50.385257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:50.416496 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:07:50.416496 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:07:50.416496 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m17:07:50.494563 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:07:50.510183 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m17:07:50.510183 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m17:07:50.510183 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m17:07:50.510183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_mart)
[0m17:07:50.525823 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:07:50.525823 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m17:07:50.525823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:50.541447 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:07:50.541447 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:07:50.541447 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m17:07:50.619965 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m17:07:50.635603 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m17:07:50.635603 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m17:07:50.635603 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m17:07:50.635603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB2FD8610>]}
[0m17:07:50.635603 [debug] [MainThread]: Using duckdb connection "master"
[0m17:07:50.651210 [debug] [MainThread]: On master: BEGIN
[0m17:07:50.651210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:50.666844 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m17:07:50.666844 [debug] [MainThread]: On master: COMMIT
[0m17:07:50.666844 [debug] [MainThread]: Using duckdb connection "master"
[0m17:07:50.666844 [debug] [MainThread]: On master: COMMIT
[0m17:07:50.666844 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:07:50.666844 [debug] [MainThread]: On master: Close
[0m17:07:50.682446 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:50.682446 [info ] [MainThread]: 
[0m17:07:50.682446 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m17:07:50.682446 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m17:07:50.700211 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m17:07:50.700754 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m17:07:50.713784 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m17:07:50.713784 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m17:07:50.807533 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m17:07:50.807533 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:07:50.807533 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m17:07:50.807533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:07:50.823158 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m17:07:50.823158 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:07:50.838752 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m17:07:50.838752 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:50.854399 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:07:50.854399 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw" rename to "aircrafts_raw__dbt_backup"
[0m17:07:50.854399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:50.854399 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:07:50.870502 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw__dbt_tmp" rename to "aircrafts_raw"
[0m17:07:50.870502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:50.917298 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:07:50.917298 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:07:50.917298 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:07:50.928895 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:07:50.933420 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:07:50.933420 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
drop table if exists "dev"."main_raw"."aircrafts_raw__dbt_backup" cascade
[0m17:07:50.933420 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:50.949066 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m17:07:50.980480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB2C90990>]}
[0m17:07:50.980480 [info ] [Thread-1 (]: 1 of 15 OK created sql table model main_raw.aircrafts_raw ...................... [[32mOK[0m in 0.28s]
[0m17:07:50.995928 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m17:07:50.995928 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m17:07:50.995928 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m17:07:50.995928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m17:07:50.995928 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m17:07:50.995928 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m17:07:51.011527 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m17:07:51.011527 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m17:07:51.011527 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:07:51.011527 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m17:07:51.011527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:51.058407 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:07:51.058407 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:07:51.058407 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m17:07:51.058407 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:51.058407 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:07:51.058407 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw" rename to "airports_raw__dbt_backup"
[0m17:07:51.074028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.074028 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:07:51.074028 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw__dbt_tmp" rename to "airports_raw"
[0m17:07:51.074028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.074028 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:07:51.090281 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:07:51.091370 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:07:51.099200 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:07:51.105734 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:07:51.105734 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
drop table if exists "dev"."main_raw"."airports_raw__dbt_backup" cascade
[0m17:07:51.105734 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:51.105734 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m17:07:51.136982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB2CC3650>]}
[0m17:07:51.136982 [info ] [Thread-1 (]: 2 of 15 OK created sql table model main_raw.airports_raw ....................... [[32mOK[0m in 0.14s]
[0m17:07:51.152623 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m17:07:51.152623 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m17:07:51.152623 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m17:07:51.152623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m17:07:51.152623 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m17:07:51.152623 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m17:07:51.168247 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m17:07:51.168247 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m17:07:51.168247 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:07:51.168247 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m17:07:51.168247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:51.199484 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:07:51.215103 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:07:51.215103 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m17:07:51.215103 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:51.215103 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:07:51.230703 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw" rename to "bookings_raw__dbt_backup"
[0m17:07:51.230703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.230703 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:07:51.246953 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw__dbt_tmp" rename to "bookings_raw"
[0m17:07:51.248025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.248025 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:07:51.248025 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:07:51.248025 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:07:51.262336 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:07:51.262336 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:07:51.262336 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
drop table if exists "dev"."main_raw"."bookings_raw__dbt_backup" cascade
[0m17:07:51.262336 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:51.262336 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m17:07:51.293584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB2DE9750>]}
[0m17:07:51.293584 [info ] [Thread-1 (]: 3 of 15 OK created sql table model main_raw.bookings_raw ....................... [[32mOK[0m in 0.14s]
[0m17:07:51.293584 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m17:07:51.309206 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m17:07:51.309206 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m17:07:51.309206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m17:07:51.309206 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m17:07:51.309206 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m17:07:51.324847 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m17:07:51.324847 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m17:07:51.324847 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:07:51.324847 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m17:07:51.340446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:51.371721 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:07:51.371721 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:07:51.371721 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m17:07:51.371721 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:07:51.387310 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:07:51.387310 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw" rename to "flights_raw__dbt_backup"
[0m17:07:51.387310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.387310 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:07:51.387310 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw__dbt_tmp" rename to "flights_raw"
[0m17:07:51.387310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.405921 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:07:51.407082 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:07:51.407082 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:07:51.411809 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:07:51.411809 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:07:51.418837 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
drop table if exists "dev"."main_raw"."flights_raw__dbt_backup" cascade
[0m17:07:51.418837 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:51.418837 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m17:07:51.450088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB34CDCD0>]}
[0m17:07:51.465727 [info ] [Thread-1 (]: 4 of 15 OK created sql table model main_raw.flights_raw ........................ [[32mOK[0m in 0.14s]
[0m17:07:51.465727 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m17:07:51.465727 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m17:07:51.465727 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m17:07:51.465727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m17:07:51.465727 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m17:07:51.465727 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m17:07:51.481329 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m17:07:51.481329 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m17:07:51.481329 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:07:51.481329 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m17:07:51.497010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:51.528222 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:07:51.528222 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:07:51.528222 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:07:51.528222 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:51.528222 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:07:51.528222 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "dev"."main_raw"."passengers_raw" rename to "passengers_raw__dbt_backup"
[0m17:07:51.543808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.543808 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:07:51.543808 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "dev"."main_raw"."passengers_raw__dbt_tmp" rename to "passengers_raw"
[0m17:07:51.543808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.543808 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:07:51.543808 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:07:51.560635 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:07:51.566799 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:07:51.566799 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:07:51.566799 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
drop table if exists "dev"."main_raw"."passengers_raw__dbt_backup" cascade
[0m17:07:51.575326 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:51.575326 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m17:07:51.606616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB34E9050>]}
[0m17:07:51.606616 [info ] [Thread-1 (]: 5 of 15 OK created sql table model main_raw.passengers_raw ..................... [[32mOK[0m in 0.14s]
[0m17:07:51.606616 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m17:07:51.606616 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m17:07:51.606616 [info ] [Thread-1 (]: 6 of 15 START sql view model main_stage.aircrafts_stg .......................... [RUN]
[0m17:07:51.606616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.aircrafts_stg)
[0m17:07:51.622220 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_stg
[0m17:07:51.622220 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_stg"
[0m17:07:51.622220 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_stg
[0m17:07:51.763400 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_stg"
[0m17:07:51.763400 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:07:51.779001 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: BEGIN
[0m17:07:51.779001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:51.810258 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:07:51.810258 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:07:51.810258 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */

  
  create view "dev"."main_stage"."aircrafts_stg__dbt_tmp" as (
    

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from "dev"."main_raw"."aircrafts_raw"
where in_service_date IS NOT null
  );

[0m17:07:51.810258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.810258 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:07:51.810258 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg" rename to "aircrafts_stg__dbt_backup"
[0m17:07:51.810258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.825863 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:07:51.825863 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg__dbt_tmp" rename to "aircrafts_stg"
[0m17:07:51.825863 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.825863 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:07:51.825863 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:07:51.825863 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:07:51.842509 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:07:51.842509 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:07:51.842509 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
drop view if exists "dev"."main_stage"."aircrafts_stg__dbt_backup" cascade
[0m17:07:51.842509 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.842509 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: Close
[0m17:07:51.873186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB350BA50>]}
[0m17:07:51.873186 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main_stage.aircrafts_stg ..................... [[32mOK[0m in 0.27s]
[0m17:07:51.873186 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m17:07:51.873186 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m17:07:51.873186 [info ] [Thread-1 (]: 7 of 15 START sql view model main_stage.airports_stg ........................... [RUN]
[0m17:07:51.873186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_stg, now model.lufthansa.airports_stg)
[0m17:07:51.873186 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_stg
[0m17:07:51.888803 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_stg"
[0m17:07:51.888803 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_stg
[0m17:07:51.888803 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_stg"
[0m17:07:51.904422 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:07:51.904422 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: BEGIN
[0m17:07:51.904422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:51.935675 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:07:51.935675 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:07:51.935675 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */

  
  create view "dev"."main_stage"."airports_stg__dbt_tmp" as (
    

select
    UPPER(airport_code) as airport_code,
    airport_name,
    city,
    country,
    timezone
from "dev"."main_raw"."airports_raw"
  );

[0m17:07:51.935675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.935675 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:07:51.935675 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg" rename to "airports_stg__dbt_backup"
[0m17:07:51.935675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.951286 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:07:51.951286 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg__dbt_tmp" rename to "airports_stg"
[0m17:07:51.951286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:51.951286 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:07:51.951286 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:07:51.951286 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:07:51.966883 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:07:51.966883 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:07:51.966883 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
drop view if exists "dev"."main_stage"."airports_stg__dbt_backup" cascade
[0m17:07:51.966883 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:51.966883 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: Close
[0m17:07:51.998247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB130E290>]}
[0m17:07:51.998247 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main_stage.airports_stg ...................... [[32mOK[0m in 0.13s]
[0m17:07:51.998247 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m17:07:51.998247 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m17:07:51.998247 [info ] [Thread-1 (]: 8 of 15 START sql view model main_stage.bookings_stg ........................... [RUN]
[0m17:07:51.998247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_stg, now model.lufthansa.bookings_stg)
[0m17:07:51.998247 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_stg
[0m17:07:52.013763 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_stg"
[0m17:07:52.013763 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_stg
[0m17:07:52.013763 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_stg"
[0m17:07:52.029386 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:07:52.029386 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: BEGIN
[0m17:07:52.029386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:52.060603 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:07:52.060603 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:07:52.060603 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */

  
  create view "dev"."main_stage"."bookings_stg__dbt_tmp" as (
    

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    UPPER(booking_status) as booking_status,
    price
from "dev"."main_raw"."bookings_raw"
where booking_status is not null
  );

[0m17:07:52.060603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.076243 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:07:52.076243 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg" rename to "bookings_stg__dbt_backup"
[0m17:07:52.076243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.076243 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:07:52.076243 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg__dbt_tmp" rename to "bookings_stg"
[0m17:07:52.076243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.091864 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:07:52.091864 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:07:52.091864 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:07:52.091864 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:07:52.091864 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:07:52.091864 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
drop view if exists "dev"."main_stage"."bookings_stg__dbt_backup" cascade
[0m17:07:52.107484 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:52.107484 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: Close
[0m17:07:52.123125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB1966C10>]}
[0m17:07:52.123125 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main_stage.bookings_stg ...................... [[32mOK[0m in 0.12s]
[0m17:07:52.123125 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m17:07:52.138704 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m17:07:52.138704 [info ] [Thread-1 (]: 9 of 15 START sql view model main_stage.flights_stg ............................ [RUN]
[0m17:07:52.138704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_stg, now model.lufthansa.flights_stg)
[0m17:07:52.138704 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_stg
[0m17:07:52.138704 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_stg"
[0m17:07:52.138704 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_stg
[0m17:07:52.154325 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_stg"
[0m17:07:52.154325 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:07:52.154325 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: BEGIN
[0m17:07:52.154325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:52.185595 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:07:52.185595 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:07:52.185595 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */

  
  create view "dev"."main_stage"."flights_stg__dbt_tmp" as (
    

select
    flight_id,
    flight_number,
    origin_airport_code as airport_from,
    destination_airport_code as airport_to,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    upper(status) as status
from "dev"."main_raw"."flights_raw"
where status is not null
  );

[0m17:07:52.185595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.201209 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:07:52.201209 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg" rename to "flights_stg__dbt_backup"
[0m17:07:52.201209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.201209 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:07:52.216826 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg__dbt_tmp" rename to "flights_stg"
[0m17:07:52.216826 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.216826 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:07:52.216826 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:07:52.216826 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:07:52.216826 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:52.232444 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:07:52.232444 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
drop view if exists "dev"."main_stage"."flights_stg__dbt_backup" cascade
[0m17:07:52.232444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.232444 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: Close
[0m17:07:52.248053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB1C4DCD0>]}
[0m17:07:52.248053 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main_stage.flights_stg ....................... [[32mOK[0m in 0.11s]
[0m17:07:52.248053 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m17:07:52.263685 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m17:07:52.263685 [info ] [Thread-1 (]: 10 of 15 START sql view model main_stage.passengers_stg ........................ [RUN]
[0m17:07:52.263685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_stg, now model.lufthansa.passengers_stg)
[0m17:07:52.263685 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_stg
[0m17:07:52.263685 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_stg"
[0m17:07:52.263685 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_stg
[0m17:07:52.279348 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_stg"
[0m17:07:52.279348 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:07:52.279348 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: BEGIN
[0m17:07:52.279348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:52.310528 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:07:52.326167 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:07:52.326167 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */

  
  create view "dev"."main_stage"."passengers_stg__dbt_tmp" as (
    

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    LOWER(email) as email,
    phone_number
from "dev"."main_raw"."passengers_raw"
  );

[0m17:07:52.326167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.326167 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:07:52.326167 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "dev"."main_stage"."passengers_stg" rename to "passengers_stg__dbt_backup"
[0m17:07:52.341763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.341763 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:07:52.341763 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "dev"."main_stage"."passengers_stg__dbt_tmp" rename to "passengers_stg"
[0m17:07:52.341763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.358535 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:07:52.360100 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:07:52.361133 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:07:52.364985 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:07:52.373491 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:07:52.373491 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
drop view if exists "dev"."main_stage"."passengers_stg__dbt_backup" cascade
[0m17:07:52.373491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.373491 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: Close
[0m17:07:52.404763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB3381710>]}
[0m17:07:52.404763 [info ] [Thread-1 (]: 10 of 15 OK created sql view model main_stage.passengers_stg ................... [[32mOK[0m in 0.14s]
[0m17:07:52.404763 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m17:07:52.404763 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m17:07:52.404763 [info ] [Thread-1 (]: 11 of 15 START sql table model main_mart.daily_flights ......................... [RUN]
[0m17:07:52.404763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_stg, now model.lufthansa.daily_flights)
[0m17:07:52.404763 [debug] [Thread-1 (]: Began compiling node model.lufthansa.daily_flights
[0m17:07:52.420384 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.daily_flights"
[0m17:07:52.420384 [debug] [Thread-1 (]: Began executing node model.lufthansa.daily_flights
[0m17:07:52.420384 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.daily_flights"
[0m17:07:52.420384 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:07:52.420384 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: BEGIN
[0m17:07:52.420384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:52.467257 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:07:52.467257 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:07:52.467257 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        -- date(scheduled_departure_time) as flight_date,
        -- Function with name date does not exist! Did you mean "datesub"?
        CAST (scheduled_departure_time AS DATE) AS flight_date,
        airport_from,
        airport_to,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    airport_from,
    airport_to,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, airport_from, airport_to
    );
  
  
[0m17:07:52.467257 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:07:52.482861 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:07:52.482861 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
alter table "dev"."main_mart"."daily_flights__dbt_tmp" rename to "daily_flights"
[0m17:07:52.482861 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.482861 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: COMMIT
[0m17:07:52.482861 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:07:52.482861 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: COMMIT
[0m17:07:52.498493 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:52.498493 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:07:52.498493 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
drop table if exists "dev"."main_mart"."daily_flights__dbt_backup" cascade
[0m17:07:52.498493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.498493 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: Close
[0m17:07:52.529720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB3300CD0>]}
[0m17:07:52.529720 [info ] [Thread-1 (]: 11 of 15 OK created sql table model main_mart.daily_flights .................... [[32mOK[0m in 0.12s]
[0m17:07:52.529720 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m17:07:52.529720 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m17:07:52.529720 [info ] [Thread-1 (]: 12 of 15 START sql table model main_mart.delays ................................ [RUN]
[0m17:07:52.529720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.daily_flights, now model.lufthansa.delays)
[0m17:07:52.529720 [debug] [Thread-1 (]: Began compiling node model.lufthansa.delays
[0m17:07:52.545341 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.delays"
[0m17:07:52.545341 [debug] [Thread-1 (]: Began executing node model.lufthansa.delays
[0m17:07:52.545341 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.delays"
[0m17:07:52.560940 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:07:52.560940 [debug] [Thread-1 (]: On model.lufthansa.delays: BEGIN
[0m17:07:52.560940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:52.592200 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:07:52.592200 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:07:52.592200 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */

  
    
    

    create  table
      "dev"."main_mart"."delays__dbt_tmp"
  
    as (
      

WITH delays AS (
    SELECT
        flight_id,
        scheduled_departure_time,
        actual_departure_time,
        EXTRACT('epoch' FROM (actual_departure_time - scheduled_departure_time)) / 60 AS departure_delay_minutes
      --EXTRACT('epoch' FROM interval) function returns the total number of seconds contained in the interval
    FROM "dev"."main_stage"."flights_stg"
    WHERE actual_departure_time IS NOT NULL
)

SELECT
    AVG(departure_delay_minutes) AS average_delay_minutes,
    MAX(departure_delay_minutes) AS max_delay_minutes,
    MIN(departure_delay_minutes) AS min_delay_minutes,
    COUNT(*) AS total_flights
FROM delays
    );
  
  
[0m17:07:52.592200 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:07:52.607802 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:07:52.607802 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays" rename to "delays__dbt_backup"
[0m17:07:52.607802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.607802 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:07:52.607802 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays__dbt_tmp" rename to "delays"
[0m17:07:52.607802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.625722 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:07:52.626799 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:07:52.627867 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:07:52.631265 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:07:52.631265 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:07:52.639293 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
drop table if exists "dev"."main_mart"."delays__dbt_backup" cascade
[0m17:07:52.639293 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:52.639293 [debug] [Thread-1 (]: On model.lufthansa.delays: Close
[0m17:07:52.670570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB2CD2D90>]}
[0m17:07:52.670570 [info ] [Thread-1 (]: 12 of 15 OK created sql table model main_mart.delays ........................... [[32mOK[0m in 0.14s]
[0m17:07:52.670570 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m17:07:52.670570 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m17:07:52.670570 [info ] [Thread-1 (]: 13 of 15 START sql table model main_mart.flight_effectiveness .................. [RUN]
[0m17:07:52.670570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.delays, now model.lufthansa.flight_effectiveness)
[0m17:07:52.670570 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flight_effectiveness
[0m17:07:52.686183 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flight_effectiveness"
[0m17:07:52.686183 [debug] [Thread-1 (]: Began executing node model.lufthansa.flight_effectiveness
[0m17:07:52.686183 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flight_effectiveness"
[0m17:07:52.686183 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:07:52.701781 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: BEGIN
[0m17:07:52.701781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:52.733042 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:07:52.733042 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:07:52.733042 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */

  
    
    

    create  table
      "dev"."main_mart"."flight_effectiveness__dbt_tmp"
  
    as (
      

with flight_bookings as (
    select
        b.flight_id,
        count(*) AS booked_seats
    from "dev"."main_stage"."bookings_stg" b
    group by b.flight_id
),
flight_capacity as (
    select
        f.flight_id,
        f.aircraft_id,
        a.capacity
    from "dev"."main_stage"."flights_stg" f
    INNER JOIN "dev"."main_stage"."aircrafts_stg" a ON f.aircraft_id = a.aircraft_id
)
select
    fc.flight_id,
    fc.aircraft_id,
    fc.capacity,
    fb.booked_seats,
    (fb.booked_seats::float / fc.capacity) * 100 AS effectiveness_percentage -- typecast to float
from flight_capacity fc
LEFT JOIN flight_bookings fb ON fc.flight_id = fb.flight_id
    );
  
  
[0m17:07:52.733042 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:07:52.748663 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:07:52.748663 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness" rename to "flight_effectiveness__dbt_backup"
[0m17:07:52.748663 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.748663 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:07:52.764285 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness__dbt_tmp" rename to "flight_effectiveness"
[0m17:07:52.764285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.764285 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:07:52.764285 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:07:52.764285 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:07:52.764285 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:07:52.779902 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:07:52.779902 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
drop table if exists "dev"."main_mart"."flight_effectiveness__dbt_backup" cascade
[0m17:07:52.779902 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:52.779902 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: Close
[0m17:07:52.811120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB1C384D0>]}
[0m17:07:52.811120 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main_mart.flight_effectiveness ............. [[32mOK[0m in 0.14s]
[0m17:07:52.811120 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m17:07:52.811120 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m17:07:52.811120 [info ] [Thread-1 (]: 14 of 15 START sql table model main_mart.top_routes ............................ [RUN]
[0m17:07:52.811120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flight_effectiveness, now model.lufthansa.top_routes)
[0m17:07:52.811120 [debug] [Thread-1 (]: Began compiling node model.lufthansa.top_routes
[0m17:07:52.826761 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.top_routes"
[0m17:07:52.826761 [debug] [Thread-1 (]: Began executing node model.lufthansa.top_routes
[0m17:07:52.826761 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.top_routes"
[0m17:07:52.842391 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:07:52.842391 [debug] [Thread-1 (]: On model.lufthansa.top_routes: BEGIN
[0m17:07:52.842391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:52.873602 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:07:52.873602 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:07:52.873602 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */

  
    
    

    create  table
      "dev"."main_mart"."top_routes__dbt_tmp"
  
    as (
      

SELECT
    airport_from,
    airport_to,
    COUNT(*) AS total_flights
FROM "dev"."main_stage"."flights_stg"
GROUP BY airport_from, airport_to
ORDER BY total_flights DESC
LIMIT 10
    );
  
  
[0m17:07:52.873602 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:07:52.889244 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:07:52.889244 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes" rename to "top_routes__dbt_backup"
[0m17:07:52.889244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.889244 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:07:52.889244 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes__dbt_tmp" rename to "top_routes"
[0m17:07:52.889244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:52.906769 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:07:52.908457 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:07:52.909041 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:07:52.916920 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:07:52.920952 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:07:52.920952 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
drop table if exists "dev"."main_mart"."top_routes__dbt_backup" cascade
[0m17:07:52.920952 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:52.920952 [debug] [Thread-1 (]: On model.lufthansa.top_routes: Close
[0m17:07:52.968008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB1BFA310>]}
[0m17:07:52.968008 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main_mart.top_routes ....................... [[32mOK[0m in 0.16s]
[0m17:07:52.983440 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m17:07:52.983440 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m17:07:52.983440 [info ] [Thread-1 (]: 15 of 15 START sql table model main_mart.revenue_from_passengers ............... [RUN]
[0m17:07:52.983440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.top_routes, now model.lufthansa.revenue_from_passengers)
[0m17:07:52.983440 [debug] [Thread-1 (]: Began compiling node model.lufthansa.revenue_from_passengers
[0m17:07:52.983440 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.revenue_from_passengers"
[0m17:07:52.999060 [debug] [Thread-1 (]: Began executing node model.lufthansa.revenue_from_passengers
[0m17:07:52.999060 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.revenue_from_passengers"
[0m17:07:52.999060 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:07:52.999060 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: BEGIN
[0m17:07:52.999060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:53.030300 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:07:53.030300 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:07:53.030300 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */

  
    
    

    create  table
      "dev"."main_mart"."revenue_from_passengers__dbt_tmp"
  
    as (
      

select
    p.passenger_id,
    p.first_name,
    p.last_name,
    sum(b.price) as total_revenue,
    count(*) as total_bookings
from "dev"."main_stage"."passengers_stg" p
INNER JOIN "dev"."main_stage"."bookings_stg" b on p.passenger_id = b.passenger_id
group BY p.passenger_id, p.first_name, p.last_name
    );
  
  
[0m17:07:53.045942 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:07:53.045942 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:07:53.061561 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "dev"."main_mart"."revenue_from_passengers" rename to "revenue_from_passengers__dbt_backup"
[0m17:07:53.061561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:53.061561 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:07:53.061561 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "dev"."main_mart"."revenue_from_passengers__dbt_tmp" rename to "revenue_from_passengers"
[0m17:07:53.061561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:53.061561 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:07:53.077180 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:07:53.077180 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:07:53.077180 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:53.077180 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:07:53.077180 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
drop table if exists "dev"."main_mart"."revenue_from_passengers__dbt_backup" cascade
[0m17:07:53.092798 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:53.092798 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: Close
[0m17:07:53.108420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc39a1e-8d7d-4218-9725-1fb6a4dcf81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EB33A1150>]}
[0m17:07:53.124021 [info ] [Thread-1 (]: 15 of 15 OK created sql table model main_mart.revenue_from_passengers .......... [[32mOK[0m in 0.12s]
[0m17:07:53.124021 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m17:07:53.124021 [debug] [MainThread]: Using duckdb connection "master"
[0m17:07:53.124021 [debug] [MainThread]: On master: BEGIN
[0m17:07:53.124021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:53.155286 [debug] [MainThread]: SQL status: OK in 0.032 seconds
[0m17:07:53.155286 [debug] [MainThread]: On master: COMMIT
[0m17:07:53.155286 [debug] [MainThread]: Using duckdb connection "master"
[0m17:07:53.155286 [debug] [MainThread]: On master: COMMIT
[0m17:07:53.155286 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:07:53.155286 [debug] [MainThread]: On master: Close
[0m17:07:53.170902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:53.170902 [debug] [MainThread]: Connection 'create_dev_main_mart' was properly closed.
[0m17:07:53.170902 [debug] [MainThread]: Connection 'list_dev_main_mart' was properly closed.
[0m17:07:53.170902 [debug] [MainThread]: Connection 'model.lufthansa.revenue_from_passengers' was properly closed.
[0m17:07:53.170902 [info ] [MainThread]: 
[0m17:07:53.170902 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m17:07:53.186499 [debug] [MainThread]: Command end result
[0m17:07:53.249497 [info ] [MainThread]: 
[0m17:07:53.249497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:53.249497 [info ] [MainThread]: 
[0m17:07:53.249497 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m17:07:53.249497 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:53.249497 after 5.42 seconds
[0m17:07:53.249497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAB39E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAB3DB610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAB3DB5D0>]}
[0m17:07:53.265095 [debug] [MainThread]: Flushing usage events
[0m17:12:06.378011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C62D2F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C62DCD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C62DFFD0>]}


============================== 17:12:06.393652 | 277ec865-bc78-489a-8cce-a410b62887ad ==============================
[0m17:12:06.393652 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:12:06.393652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:12:06.878252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C6386D90>]}
[0m17:12:06.972005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C377A190>]}
[0m17:12:06.987627 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:12:07.003213 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:12:07.315637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:07.331267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:07.393715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C7770450>]}
[0m17:12:07.612988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C637A510>]}
[0m17:12:07.612988 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:12:07.612988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C6612C90>]}
[0m17:12:07.612988 [info ] [MainThread]: 
[0m17:12:07.612988 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:12:07.628608 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:12:07.816047 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:12:07.816047 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:12:07.816047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:07.847290 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m17:12:07.862929 [debug] [ThreadPool]: On list_dev: Close
[0m17:12:07.862929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:12:07.862929 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:12:07.878552 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:12:07.878552 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:12:07.878552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:07.909768 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m17:12:07.909768 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:12:07.909768 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:12:07.925390 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:07.925390 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:12:07.925390 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:12:07.925390 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:07.925390 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:12:07.925390 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:12:07.925390 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:12:07.925390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:07.925390 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:12:07.941009 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_raw'
[0m17:12:07.956628 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:12:07.956628 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m17:12:07.956628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:07.987869 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:12:07.987869 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:12:07.987869 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m17:12:08.065988 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m17:12:08.065988 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m17:12:08.065988 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m17:12:08.065988 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m17:12:08.081589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_stage)
[0m17:12:08.081589 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:12:08.081589 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m17:12:08.081589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:08.112830 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:12:08.112830 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:12:08.112830 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m17:12:08.190927 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m17:12:08.190927 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m17:12:08.190927 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m17:12:08.190927 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m17:12:08.206575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_mart)
[0m17:12:08.206575 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:12:08.206575 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m17:12:08.206575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:08.237790 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:12:08.237790 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:12:08.237790 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m17:12:08.315890 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m17:12:08.315890 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m17:12:08.315890 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m17:12:08.315890 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m17:12:08.331509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main)
[0m17:12:08.331509 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:12:08.331509 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:12:08.331509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:08.362751 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:12:08.362751 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:12:08.362751 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:12:08.440883 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m17:12:08.440883 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:12:08.440883 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:12:08.440883 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:12:08.456470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C791BD50>]}
[0m17:12:08.456470 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:08.456470 [debug] [MainThread]: On master: BEGIN
[0m17:12:08.456470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:08.487730 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m17:12:08.487730 [debug] [MainThread]: On master: COMMIT
[0m17:12:08.487730 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:08.487730 [debug] [MainThread]: On master: COMMIT
[0m17:12:08.487730 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:08.487730 [debug] [MainThread]: On master: Close
[0m17:12:08.487730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:08.503332 [info ] [MainThread]: 
[0m17:12:08.503332 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_aircrafts
[0m17:12:08.503332 [info ] [Thread-1 (]: 1 of 5 START seed file main.raw_aircrafts ...................................... [RUN]
[0m17:12:08.503332 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.lufthansa.raw_aircrafts'
[0m17:12:08.503332 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_aircrafts
[0m17:12:08.503332 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_aircrafts
[0m17:12:08.581431 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m17:12:08.581431 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: BEGIN
[0m17:12:08.581431 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:12:08.597076 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m17:12:08.612670 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m17:12:08.612670 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_aircrafts"} */
truncate table "dev"."main"."raw_aircrafts"
[0m17:12:08.616407 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:12:08.644098 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m17:12:08.644098 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: 
          COPY "dev"."main"."raw_aircrafts" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_aircrafts.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:12:08.644098 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:12:08.659708 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_aircrafts"
[0m17:12:08.690926 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: COMMIT
[0m17:12:08.690926 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m17:12:08.690926 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: COMMIT
[0m17:12:08.706544 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:12:08.706544 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: Close
[0m17:12:08.737809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C63813D0>]}
[0m17:12:08.737809 [info ] [Thread-1 (]: 1 of 5 OK loaded seed file main.raw_aircrafts .................................. [[32mINSERT 10[0m in 0.23s]
[0m17:12:08.753407 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_aircrafts
[0m17:12:08.753407 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_airports
[0m17:12:08.753407 [info ] [Thread-1 (]: 2 of 5 START seed file main.raw_airports ....................................... [RUN]
[0m17:12:08.753407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_aircrafts, now seed.lufthansa.raw_airports)
[0m17:12:08.753407 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_airports
[0m17:12:08.753407 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_airports
[0m17:12:08.769026 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m17:12:08.769026 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: BEGIN
[0m17:12:08.769026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:08.800268 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:12:08.800268 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m17:12:08.800268 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_airports"} */
truncate table "dev"."main"."raw_airports"
[0m17:12:08.800268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:08.815885 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m17:12:08.815885 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: 
          COPY "dev"."main"."raw_airports" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_airports.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:12:08.815885 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:08.815885 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_airports"
[0m17:12:08.815885 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: COMMIT
[0m17:12:08.831506 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m17:12:08.831506 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: COMMIT
[0m17:12:08.831506 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:08.831506 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: Close
[0m17:12:08.863195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C51291D0>]}
[0m17:12:08.863195 [info ] [Thread-1 (]: 2 of 5 OK loaded seed file main.raw_airports ................................... [[32mINSERT 15[0m in 0.11s]
[0m17:12:08.863195 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_airports
[0m17:12:08.863195 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_bookings
[0m17:12:08.878839 [info ] [Thread-1 (]: 3 of 5 START seed file main.raw_bookings ....................................... [RUN]
[0m17:12:08.878839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_airports, now seed.lufthansa.raw_bookings)
[0m17:12:08.878839 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_bookings
[0m17:12:08.878839 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_bookings
[0m17:12:08.894438 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m17:12:08.894438 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: BEGIN
[0m17:12:08.894438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:08.925702 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:12:08.925702 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m17:12:08.925702 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_bookings"} */
truncate table "dev"."main"."raw_bookings"
[0m17:12:08.925702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:08.941318 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m17:12:08.941318 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: 
          COPY "dev"."main"."raw_bookings" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_bookings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:12:08.941318 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:12:08.941318 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_bookings"
[0m17:12:08.956920 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: COMMIT
[0m17:12:08.956920 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m17:12:08.956920 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: COMMIT
[0m17:12:08.956920 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:08.956920 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: Close
[0m17:12:08.988179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C7869CD0>]}
[0m17:12:08.988179 [info ] [Thread-1 (]: 3 of 5 OK loaded seed file main.raw_bookings ................................... [[32mINSERT 20[0m in 0.11s]
[0m17:12:09.003780 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_bookings
[0m17:12:09.003780 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_flights
[0m17:12:09.003780 [info ] [Thread-1 (]: 4 of 5 START seed file main.raw_flights ........................................ [RUN]
[0m17:12:09.003780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_bookings, now seed.lufthansa.raw_flights)
[0m17:12:09.003780 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_flights
[0m17:12:09.003780 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_flights
[0m17:12:09.035083 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m17:12:09.035083 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: BEGIN
[0m17:12:09.035083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:09.066280 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:12:09.066280 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m17:12:09.066280 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_flights"} */
truncate table "dev"."main"."raw_flights"
[0m17:12:09.066280 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:09.081879 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m17:12:09.081879 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: 
          COPY "dev"."main"."raw_flights" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_flights.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:12:09.081879 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:12:09.081879 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_flights"
[0m17:12:09.098140 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: COMMIT
[0m17:12:09.098140 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m17:12:09.098140 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: COMMIT
[0m17:12:09.108485 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:12:09.108485 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: Close
[0m17:12:09.161243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C7C2F690>]}
[0m17:12:09.161243 [info ] [Thread-1 (]: 4 of 5 OK loaded seed file main.raw_flights .................................... [[32mINSERT 15[0m in 0.16s]
[0m17:12:09.165235 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_flights
[0m17:12:09.165235 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_passengers
[0m17:12:09.169228 [info ] [Thread-1 (]: 5 of 5 START seed file main.raw_passengers ..................................... [RUN]
[0m17:12:09.169228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_flights, now seed.lufthansa.raw_passengers)
[0m17:12:09.169228 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_passengers
[0m17:12:09.173223 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_passengers
[0m17:12:09.193188 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m17:12:09.193188 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: BEGIN
[0m17:12:09.193188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:09.229127 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:12:09.229127 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m17:12:09.229127 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_passengers"} */
truncate table "dev"."main"."raw_passengers"
[0m17:12:09.233124 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:09.237114 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m17:12:09.237114 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: 
          COPY "dev"."main"."raw_passengers" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_passengers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:12:09.245101 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:12:09.249095 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_passengers"
[0m17:12:09.253087 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: COMMIT
[0m17:12:09.253087 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m17:12:09.253087 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: COMMIT
[0m17:12:09.261857 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:12:09.264862 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: Close
[0m17:12:09.297451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ec865-bc78-489a-8cce-a410b62887ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C7CE2450>]}
[0m17:12:09.301473 [info ] [Thread-1 (]: 5 of 5 OK loaded seed file main.raw_passengers ................................. [[32mINSERT 20[0m in 0.13s]
[0m17:12:09.301473 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_passengers
[0m17:12:09.307580 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:09.309608 [debug] [MainThread]: On master: BEGIN
[0m17:12:09.309608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:09.341580 [debug] [MainThread]: SQL status: OK in 0.032 seconds
[0m17:12:09.341580 [debug] [MainThread]: On master: COMMIT
[0m17:12:09.341580 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:09.341580 [debug] [MainThread]: On master: COMMIT
[0m17:12:09.345574 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:09.345574 [debug] [MainThread]: On master: Close
[0m17:12:09.349547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:09.353566 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m17:12:09.353566 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m17:12:09.353566 [debug] [MainThread]: Connection 'seed.lufthansa.raw_passengers' was properly closed.
[0m17:12:09.353566 [info ] [MainThread]: 
[0m17:12:09.357545 [info ] [MainThread]: Finished running 5 seeds in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m17:12:09.361564 [debug] [MainThread]: Command end result
[0m17:12:09.433409 [info ] [MainThread]: 
[0m17:12:09.433409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:09.437384 [info ] [MainThread]: 
[0m17:12:09.437384 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:12:09.441376 [debug] [MainThread]: Command `dbt seed` succeeded at 17:12:09.441376 after 3.20 seconds
[0m17:12:09.441376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223BFDCE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223BFE0B610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223BFE0B5D0>]}
[0m17:12:09.441376 [debug] [MainThread]: Flushing usage events
[0m17:12:18.475681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E65ED8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E65EE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E65ED410>]}


============================== 17:12:18.481434 | fc4d0831-5b07-4e9b-94b6-f86726a13196 ==============================
[0m17:12:18.481434 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:12:18.490940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:12:18.959583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E6688D10>]}
[0m17:12:19.068923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E3A8DD90>]}
[0m17:12:19.068923 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:12:19.100153 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:12:19.415085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:19.415085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:19.499284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E7B1C490>]}
[0m17:12:19.718610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E691FCD0>]}
[0m17:12:19.722601 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:12:19.722601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E633DC90>]}
[0m17:12:19.730588 [info ] [MainThread]: 
[0m17:12:19.738635 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:12:19.754616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:12:19.955073 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:12:19.955073 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:12:19.955073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:20.001935 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m17:12:20.001935 [debug] [ThreadPool]: On list_dev: Close
[0m17:12:20.001935 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:12:20.001935 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:12:20.017574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.033200 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:12:20.033200 [debug] [ThreadPool]: On list_dev: Close
[0m17:12:20.048814 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:12:20.048814 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:12:20.048814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.080054 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:12:20.080054 [debug] [ThreadPool]: On list_dev: Close
[0m17:12:20.080054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_mart)
[0m17:12:20.080054 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m17:12:20.095676 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:12:20.095676 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:12:20.111309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.126932 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:12:20.126932 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:12:20.126932 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m17:12:20.126932 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:20.126932 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:12:20.126932 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m17:12:20.142548 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:20.142548 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:12:20.142548 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:12:20.142548 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:12:20.142548 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:20.142548 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m17:12:20.142548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_mart, now create_dev_main_raw)
[0m17:12:20.142548 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m17:12:20.158155 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:12:20.158155 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:12:20.158155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.173779 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:12:20.189411 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:12:20.189411 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m17:12:20.189411 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:20.189411 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:12:20.189411 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m17:12:20.189411 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:20.189411 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:12:20.189411 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:12:20.189411 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:12:20.189411 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:20.189411 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m17:12:20.205015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_raw, now create_dev_main_stage)
[0m17:12:20.205015 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m17:12:20.205015 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:12:20.205015 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:12:20.205015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.236235 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:12:20.236235 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:12:20.236235 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m17:12:20.236235 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:20.236235 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:12:20.236235 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m17:12:20.236235 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:20.236235 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:12:20.236235 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:12:20.251875 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:12:20.251875 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:20.251875 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m17:12:20.251875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_mart'
[0m17:12:20.267475 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:12:20.267475 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m17:12:20.267475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:20.298749 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:12:20.298749 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:12:20.298749 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m17:12:20.376818 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:12:20.392436 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m17:12:20.392436 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m17:12:20.392436 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m17:12:20.392436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main)
[0m17:12:20.408055 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:12:20.408055 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:12:20.408055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.428227 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:12:20.428227 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:12:20.428227 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:12:20.502752 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m17:12:20.518405 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:12:20.518405 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:12:20.518405 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:12:20.518405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_raw)
[0m17:12:20.533990 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:12:20.533990 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m17:12:20.533990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.549611 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:12:20.549611 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:12:20.549611 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m17:12:20.643487 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m17:12:20.643487 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m17:12:20.643487 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m17:12:20.643487 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m17:12:20.643487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main_stage)
[0m17:12:20.659129 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:12:20.659129 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m17:12:20.659129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.690388 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:12:20.690388 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:12:20.690388 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m17:12:20.768458 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m17:12:20.784089 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m17:12:20.784089 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m17:12:20.784089 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m17:12:20.784089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E66CBBD0>]}
[0m17:12:20.784089 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:20.784089 [debug] [MainThread]: On master: BEGIN
[0m17:12:20.784089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:20.815309 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m17:12:20.815309 [debug] [MainThread]: On master: COMMIT
[0m17:12:20.815309 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:20.815309 [debug] [MainThread]: On master: COMMIT
[0m17:12:20.815309 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:20.815309 [debug] [MainThread]: On master: Close
[0m17:12:20.830955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:20.830955 [info ] [MainThread]: 
[0m17:12:20.830955 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m17:12:20.830955 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m17:12:20.830955 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m17:12:20.830955 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m17:12:20.862187 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m17:12:20.862187 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m17:12:20.940319 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m17:12:20.940319 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:12:20.940319 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m17:12:20.940319 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:12:20.971745 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m17:12:20.971745 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:12:20.971745 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m17:12:20.981615 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:12:21.003257 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:12:21.003257 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw" rename to "aircrafts_raw__dbt_backup"
[0m17:12:21.003257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:21.003257 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:12:21.003257 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw__dbt_tmp" rename to "aircrafts_raw"
[0m17:12:21.018874 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:21.065754 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:12:21.065754 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:12:21.065754 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:12:21.065754 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:21.081355 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:12:21.081355 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
drop table if exists "dev"."main_raw"."aircrafts_raw__dbt_backup" cascade
[0m17:12:21.081355 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:21.081355 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m17:12:21.144029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E69DE710>]}
[0m17:12:21.144029 [info ] [Thread-1 (]: 1 of 15 OK created sql table model main_raw.aircrafts_raw ...................... [[32mOK[0m in 0.31s]
[0m17:12:21.159454 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m17:12:21.159454 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m17:12:21.159454 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m17:12:21.159454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m17:12:21.159454 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m17:12:21.159454 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m17:12:21.175096 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m17:12:21.175096 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m17:12:21.175096 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:12:21.175096 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m17:12:21.175096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:21.221970 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:12:21.221970 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:12:21.221970 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m17:12:21.221970 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:21.221970 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:12:21.237580 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw" rename to "airports_raw__dbt_backup"
[0m17:12:21.237580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:21.237580 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:12:21.237580 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw__dbt_tmp" rename to "airports_raw"
[0m17:12:21.237580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:21.256169 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:12:21.257391 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:12:21.257914 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:12:21.261838 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:21.268850 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:12:21.268850 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
drop table if exists "dev"."main_raw"."airports_raw__dbt_backup" cascade
[0m17:12:21.268850 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:21.268850 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m17:12:21.300495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E80FAD10>]}
[0m17:12:21.300495 [info ] [Thread-1 (]: 2 of 15 OK created sql table model main_raw.airports_raw ....................... [[32mOK[0m in 0.14s]
[0m17:12:21.315739 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m17:12:21.315739 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m17:12:21.315739 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m17:12:21.315739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m17:12:21.315739 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m17:12:21.315739 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m17:12:21.331350 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m17:12:21.331350 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m17:12:21.331350 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:12:21.331350 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m17:12:21.331350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:21.378218 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:12:21.378218 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:12:21.378218 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m17:12:21.378218 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:21.378218 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:12:21.378218 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw" rename to "bookings_raw__dbt_backup"
[0m17:12:21.378218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:21.393838 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:12:21.393838 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw__dbt_tmp" rename to "bookings_raw"
[0m17:12:21.393838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:21.393838 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:12:21.393838 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:12:21.393838 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:12:21.441137 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m17:12:21.456575 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:12:21.456575 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
drop table if exists "dev"."main_raw"."bookings_raw__dbt_backup" cascade
[0m17:12:21.472190 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:21.472190 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m17:12:21.519057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E80DD390>]}
[0m17:12:21.519057 [info ] [Thread-1 (]: 3 of 15 OK created sql table model main_raw.bookings_raw ....................... [[32mOK[0m in 0.20s]
[0m17:12:21.519057 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m17:12:21.519057 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m17:12:21.519057 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m17:12:21.519057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m17:12:21.519057 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m17:12:21.534699 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m17:12:21.534699 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m17:12:21.550315 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m17:12:21.550315 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:12:21.550315 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m17:12:21.550315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:21.581530 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:12:21.581530 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:12:21.581530 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m17:12:21.597149 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:21.597149 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:12:21.597149 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw" rename to "flights_raw__dbt_backup"
[0m17:12:21.597149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:21.612772 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:12:21.612772 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw__dbt_tmp" rename to "flights_raw"
[0m17:12:21.615781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:21.615781 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:12:21.615781 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:12:21.615781 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:12:21.615781 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:21.628789 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:12:21.628789 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
drop table if exists "dev"."main_raw"."flights_raw__dbt_backup" cascade
[0m17:12:21.628789 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:21.628789 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m17:12:21.691278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E80DD390>]}
[0m17:12:21.691278 [info ] [Thread-1 (]: 4 of 15 OK created sql table model main_raw.flights_raw ........................ [[32mOK[0m in 0.17s]
[0m17:12:21.691278 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m17:12:21.691278 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m17:12:21.691278 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m17:12:21.691278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m17:12:21.691278 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m17:12:21.706900 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m17:12:21.706900 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m17:12:21.722542 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m17:12:21.722542 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:12:21.722542 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m17:12:21.722542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:21.753787 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:12:21.753787 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:12:21.753787 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:12:21.753787 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:21.769381 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:12:21.769381 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "dev"."main_raw"."passengers_raw" rename to "passengers_raw__dbt_backup"
[0m17:12:21.769381 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:21.769381 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:12:21.769381 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "dev"."main_raw"."passengers_raw__dbt_tmp" rename to "passengers_raw"
[0m17:12:21.786336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:21.790408 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:12:21.790988 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:12:21.791511 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:12:21.795758 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:21.800771 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:12:21.800771 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
drop table if exists "dev"."main_raw"."passengers_raw__dbt_backup" cascade
[0m17:12:21.800771 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:21.800771 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m17:12:21.863258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E7F43FD0>]}
[0m17:12:21.863258 [info ] [Thread-1 (]: 5 of 15 OK created sql table model main_raw.passengers_raw ..................... [[32mOK[0m in 0.17s]
[0m17:12:21.863258 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m17:12:21.878911 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m17:12:21.878911 [info ] [Thread-1 (]: 6 of 15 START sql view model main_stage.aircrafts_stg .......................... [RUN]
[0m17:12:21.878911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.aircrafts_stg)
[0m17:12:21.878911 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_stg
[0m17:12:21.894504 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_stg"
[0m17:12:21.910122 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_stg
[0m17:12:21.973032 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_stg"
[0m17:12:21.973032 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:12:21.973032 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: BEGIN
[0m17:12:21.973032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:22.004279 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:12:22.004279 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:12:22.004279 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */

  
  create view "dev"."main_stage"."aircrafts_stg__dbt_tmp" as (
    

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from "dev"."main_raw"."aircrafts_raw"
where in_service_date IS NOT null
  );

[0m17:12:22.004279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.019900 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:12:22.019900 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg" rename to "aircrafts_stg__dbt_backup"
[0m17:12:22.019900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.019900 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:12:22.035543 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg__dbt_tmp" rename to "aircrafts_stg"
[0m17:12:22.035543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.035543 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:12:22.035543 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:12:22.035543 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:12:22.051456 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:22.051456 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:12:22.051456 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
drop view if exists "dev"."main_stage"."aircrafts_stg__dbt_backup" cascade
[0m17:12:22.051456 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:22.051456 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: Close
[0m17:12:22.082704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E7F540D0>]}
[0m17:12:22.082704 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main_stage.aircrafts_stg ..................... [[32mOK[0m in 0.20s]
[0m17:12:22.098325 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m17:12:22.098325 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m17:12:22.098325 [info ] [Thread-1 (]: 7 of 15 START sql view model main_stage.airports_stg ........................... [RUN]
[0m17:12:22.113946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_stg, now model.lufthansa.airports_stg)
[0m17:12:22.113946 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_stg
[0m17:12:22.129566 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_stg"
[0m17:12:22.129566 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_stg
[0m17:12:22.145187 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_stg"
[0m17:12:22.145187 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:12:22.145187 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: BEGIN
[0m17:12:22.145187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:22.176426 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:12:22.176426 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:12:22.176426 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */

  
  create view "dev"."main_stage"."airports_stg__dbt_tmp" as (
    

select
    UPPER(airport_code) as airport_code,
    airport_name,
    city,
    country,
    timezone
from "dev"."main_raw"."airports_raw"
  );

[0m17:12:22.176426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.192707 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:12:22.192707 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg" rename to "airports_stg__dbt_backup"
[0m17:12:22.192707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.192707 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:12:22.192707 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg__dbt_tmp" rename to "airports_stg"
[0m17:12:22.207713 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.207713 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:12:22.207713 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:12:22.207713 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:12:22.217310 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:22.223818 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:12:22.223818 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
drop view if exists "dev"."main_stage"."airports_stg__dbt_backup" cascade
[0m17:12:22.223818 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.223818 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: Close
[0m17:12:22.255086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E80B14D0>]}
[0m17:12:22.255086 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main_stage.airports_stg ...................... [[32mOK[0m in 0.13s]
[0m17:12:22.255086 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m17:12:22.255086 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m17:12:22.255086 [info ] [Thread-1 (]: 8 of 15 START sql view model main_stage.bookings_stg ........................... [RUN]
[0m17:12:22.255086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_stg, now model.lufthansa.bookings_stg)
[0m17:12:22.255086 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_stg
[0m17:12:22.270706 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_stg"
[0m17:12:22.270706 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_stg
[0m17:12:22.270706 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_stg"
[0m17:12:22.270706 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:12:22.286327 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: BEGIN
[0m17:12:22.286327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:22.317582 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:12:22.317582 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:12:22.317582 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */

  
  create view "dev"."main_stage"."bookings_stg__dbt_tmp" as (
    

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    UPPER(booking_status) as booking_status,
    price
from "dev"."main_raw"."bookings_raw"
where booking_status is not null
  );

[0m17:12:22.317582 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.317582 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:12:22.317582 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg" rename to "bookings_stg__dbt_backup"
[0m17:12:22.317582 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.333186 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:12:22.333186 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg__dbt_tmp" rename to "bookings_stg"
[0m17:12:22.333186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.333186 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:12:22.333186 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:12:22.333186 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:12:22.354993 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:12:22.354993 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:12:22.354993 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
drop view if exists "dev"."main_stage"."bookings_stg__dbt_backup" cascade
[0m17:12:22.364497 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:22.364497 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: Close
[0m17:12:22.395746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E7B794D0>]}
[0m17:12:22.395746 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main_stage.bookings_stg ...................... [[32mOK[0m in 0.14s]
[0m17:12:22.395746 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m17:12:22.395746 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m17:12:22.395746 [info ] [Thread-1 (]: 9 of 15 START sql view model main_stage.flights_stg ............................ [RUN]
[0m17:12:22.395746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_stg, now model.lufthansa.flights_stg)
[0m17:12:22.395746 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_stg
[0m17:12:22.411368 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_stg"
[0m17:12:22.411368 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_stg
[0m17:12:22.411368 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_stg"
[0m17:12:22.411368 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:12:22.411368 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: BEGIN
[0m17:12:22.427005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:22.458225 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:12:22.458225 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:12:22.458225 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */

  
  create view "dev"."main_stage"."flights_stg__dbt_tmp" as (
    

select
    flight_id,
    flight_number,
    origin_airport_code as airport_from,
    destination_airport_code as airport_to,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    upper(status) as status
from "dev"."main_raw"."flights_raw"
where status is not null
  );

[0m17:12:22.458225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.458225 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:12:22.458225 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg" rename to "flights_stg__dbt_backup"
[0m17:12:22.458225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.473865 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:12:22.473865 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg__dbt_tmp" rename to "flights_stg"
[0m17:12:22.473865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.473865 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:12:22.489485 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:12:22.489485 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:12:22.489485 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:22.489485 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:12:22.489485 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
drop view if exists "dev"."main_stage"."flights_stg__dbt_backup" cascade
[0m17:12:22.489485 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:22.583193 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: Close
[0m17:12:22.614783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E609E210>]}
[0m17:12:22.614783 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main_stage.flights_stg ....................... [[32mOK[0m in 0.22s]
[0m17:12:22.614783 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m17:12:22.614783 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m17:12:22.614783 [info ] [Thread-1 (]: 10 of 15 START sql view model main_stage.passengers_stg ........................ [RUN]
[0m17:12:22.630411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_stg, now model.lufthansa.passengers_stg)
[0m17:12:22.630411 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_stg
[0m17:12:22.630411 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_stg"
[0m17:12:22.630411 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_stg
[0m17:12:22.646029 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_stg"
[0m17:12:22.646029 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:12:22.646029 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: BEGIN
[0m17:12:22.646029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:22.677272 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:12:22.677272 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:12:22.692910 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */

  
  create view "dev"."main_stage"."passengers_stg__dbt_tmp" as (
    

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    LOWER(email) as email,
    phone_number
from "dev"."main_raw"."passengers_raw"
  );

[0m17:12:22.692910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.692910 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:12:22.692910 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "dev"."main_stage"."passengers_stg" rename to "passengers_stg__dbt_backup"
[0m17:12:22.692910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.708532 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:12:22.708532 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "dev"."main_stage"."passengers_stg__dbt_tmp" rename to "passengers_stg"
[0m17:12:22.708532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.708532 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:12:22.708532 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:12:22.708532 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:12:22.708532 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:22.724130 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:12:22.724130 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
drop view if exists "dev"."main_stage"."passengers_stg__dbt_backup" cascade
[0m17:12:22.724130 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:22.724130 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: Close
[0m17:12:22.755369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E8123610>]}
[0m17:12:22.755369 [info ] [Thread-1 (]: 10 of 15 OK created sql view model main_stage.passengers_stg ................... [[32mOK[0m in 0.12s]
[0m17:12:22.755369 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m17:12:22.755369 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m17:12:22.755369 [info ] [Thread-1 (]: 11 of 15 START sql table model main_mart.daily_flights ......................... [RUN]
[0m17:12:22.755369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_stg, now model.lufthansa.daily_flights)
[0m17:12:22.755369 [debug] [Thread-1 (]: Began compiling node model.lufthansa.daily_flights
[0m17:12:22.771010 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.daily_flights"
[0m17:12:22.771010 [debug] [Thread-1 (]: Began executing node model.lufthansa.daily_flights
[0m17:12:22.786653 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.daily_flights"
[0m17:12:22.786653 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:12:22.786653 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: BEGIN
[0m17:12:22.786653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:22.817872 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:12:22.817872 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:12:22.817872 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        -- date(scheduled_departure_time) as flight_date,
        -- Function with name date does not exist! Did you mean "datesub"?
        CAST (scheduled_departure_time AS DATE) AS flight_date,
        airport_from,
        airport_to,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    airport_from,
    airport_to,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, airport_from, airport_to
    );
  
  
[0m17:12:22.833493 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:12:22.833493 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:12:22.833493 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
alter table "dev"."main_mart"."daily_flights" rename to "daily_flights__dbt_backup"
[0m17:12:22.833493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.851560 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:12:22.853241 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
alter table "dev"."main_mart"."daily_flights__dbt_tmp" rename to "daily_flights"
[0m17:12:22.854474 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.855586 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: COMMIT
[0m17:12:22.855586 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:12:22.855586 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: COMMIT
[0m17:12:22.865123 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:22.865123 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:12:22.865123 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
drop table if exists "dev"."main_mart"."daily_flights__dbt_backup" cascade
[0m17:12:22.865123 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:22.865123 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: Close
[0m17:12:22.911993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E5422B10>]}
[0m17:12:22.911993 [info ] [Thread-1 (]: 11 of 15 OK created sql table model main_mart.daily_flights .................... [[32mOK[0m in 0.16s]
[0m17:12:22.911993 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m17:12:22.911993 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m17:12:22.911993 [info ] [Thread-1 (]: 12 of 15 START sql table model main_mart.delays ................................ [RUN]
[0m17:12:22.911993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.daily_flights, now model.lufthansa.delays)
[0m17:12:22.911993 [debug] [Thread-1 (]: Began compiling node model.lufthansa.delays
[0m17:12:22.927614 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.delays"
[0m17:12:22.927614 [debug] [Thread-1 (]: Began executing node model.lufthansa.delays
[0m17:12:22.927614 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.delays"
[0m17:12:22.943258 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:12:22.943258 [debug] [Thread-1 (]: On model.lufthansa.delays: BEGIN
[0m17:12:22.943258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:22.974505 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:12:22.974505 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:12:22.974505 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */

  
    
    

    create  table
      "dev"."main_mart"."delays__dbt_tmp"
  
    as (
      

WITH delays AS (
    SELECT
        flight_id,
        scheduled_departure_time,
        actual_departure_time,
        EXTRACT('epoch' FROM (actual_departure_time - scheduled_departure_time)) / 60 AS departure_delay_minutes
      --EXTRACT('epoch' FROM interval) function returns the total number of seconds contained in the interval
    FROM "dev"."main_stage"."flights_stg"
    WHERE actual_departure_time IS NOT NULL
)

SELECT
    AVG(departure_delay_minutes) AS average_delay_minutes,
    MAX(departure_delay_minutes) AS max_delay_minutes,
    MIN(departure_delay_minutes) AS min_delay_minutes,
    COUNT(*) AS total_flights
FROM delays
    );
  
  
[0m17:12:22.974505 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:22.990112 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:12:22.990112 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays" rename to "delays__dbt_backup"
[0m17:12:22.990112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:22.990112 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:12:22.990112 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays__dbt_tmp" rename to "delays"
[0m17:12:22.990112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:23.006941 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:12:23.008014 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:12:23.008551 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:12:23.012877 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:23.012877 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:12:23.021388 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
drop table if exists "dev"."main_mart"."delays__dbt_backup" cascade
[0m17:12:23.021388 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:23.021388 [debug] [Thread-1 (]: On model.lufthansa.delays: Close
[0m17:12:23.052662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E8139B10>]}
[0m17:12:23.052662 [info ] [Thread-1 (]: 12 of 15 OK created sql table model main_mart.delays ........................... [[32mOK[0m in 0.14s]
[0m17:12:23.052662 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m17:12:23.052662 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m17:12:23.052662 [info ] [Thread-1 (]: 13 of 15 START sql table model main_mart.flight_effectiveness .................. [RUN]
[0m17:12:23.052662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.delays, now model.lufthansa.flight_effectiveness)
[0m17:12:23.052662 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flight_effectiveness
[0m17:12:23.068258 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flight_effectiveness"
[0m17:12:23.068258 [debug] [Thread-1 (]: Began executing node model.lufthansa.flight_effectiveness
[0m17:12:23.068258 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flight_effectiveness"
[0m17:12:23.083978 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:12:23.083978 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: BEGIN
[0m17:12:23.083978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:23.115137 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:12:23.115137 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:12:23.115137 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */

  
    
    

    create  table
      "dev"."main_mart"."flight_effectiveness__dbt_tmp"
  
    as (
      

with flight_bookings as (
    select
        b.flight_id,
        count(*) AS booked_seats
    from "dev"."main_stage"."bookings_stg" b
    group by b.flight_id
),
flight_capacity as (
    select
        f.flight_id,
        f.aircraft_id,
        a.capacity
    from "dev"."main_stage"."flights_stg" f
    INNER JOIN "dev"."main_stage"."aircrafts_stg" a ON f.aircraft_id = a.aircraft_id
)
select
    fc.flight_id,
    fc.aircraft_id,
    fc.capacity,
    fb.booked_seats,
    (fb.booked_seats::float / fc.capacity) * 100 AS effectiveness_percentage -- typecast to float
from flight_capacity fc
LEFT JOIN flight_bookings fb ON fc.flight_id = fb.flight_id
    );
  
  
[0m17:12:23.130737 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:12:23.130737 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:12:23.130737 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness" rename to "flight_effectiveness__dbt_backup"
[0m17:12:23.146985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:23.147513 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:12:23.147513 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness__dbt_tmp" rename to "flight_effectiveness"
[0m17:12:23.147513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:23.162052 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:12:23.162052 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:12:23.162052 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:12:23.174011 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:23.178047 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:12:23.178047 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
drop table if exists "dev"."main_mart"."flight_effectiveness__dbt_backup" cascade
[0m17:12:23.178047 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:23.178047 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: Close
[0m17:12:23.224916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E80FF810>]}
[0m17:12:23.224916 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main_mart.flight_effectiveness ............. [[32mOK[0m in 0.17s]
[0m17:12:23.224916 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m17:12:23.224916 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m17:12:23.224916 [info ] [Thread-1 (]: 14 of 15 START sql table model main_mart.top_routes ............................ [RUN]
[0m17:12:23.224916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flight_effectiveness, now model.lufthansa.top_routes)
[0m17:12:23.224916 [debug] [Thread-1 (]: Began compiling node model.lufthansa.top_routes
[0m17:12:23.240559 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.top_routes"
[0m17:12:23.240559 [debug] [Thread-1 (]: Began executing node model.lufthansa.top_routes
[0m17:12:23.240559 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.top_routes"
[0m17:12:23.256176 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:12:23.256176 [debug] [Thread-1 (]: On model.lufthansa.top_routes: BEGIN
[0m17:12:23.256176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:23.287431 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:12:23.287431 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:12:23.287431 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */

  
    
    

    create  table
      "dev"."main_mart"."top_routes__dbt_tmp"
  
    as (
      

SELECT
    airport_from,
    airport_to,
    COUNT(*) AS total_flights
FROM "dev"."main_stage"."flights_stg"
GROUP BY airport_from, airport_to
ORDER BY total_flights DESC
LIMIT 10
    );
  
  
[0m17:12:23.287431 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:23.303039 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:12:23.303039 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes" rename to "top_routes__dbt_backup"
[0m17:12:23.303039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:23.303039 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:12:23.303039 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes__dbt_tmp" rename to "top_routes"
[0m17:12:23.319949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:23.323434 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:12:23.324515 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:12:23.325086 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:12:23.330080 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:23.334587 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:12:23.334587 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
drop table if exists "dev"."main_mart"."top_routes__dbt_backup" cascade
[0m17:12:23.334587 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:23.334587 [debug] [Thread-1 (]: On model.lufthansa.top_routes: Close
[0m17:12:23.365833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E6A2AF50>]}
[0m17:12:23.365833 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main_mart.top_routes ....................... [[32mOK[0m in 0.14s]
[0m17:12:23.365833 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m17:12:23.365833 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m17:12:23.381455 [info ] [Thread-1 (]: 15 of 15 START sql table model main_mart.revenue_from_passengers ............... [RUN]
[0m17:12:23.381455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.top_routes, now model.lufthansa.revenue_from_passengers)
[0m17:12:23.381455 [debug] [Thread-1 (]: Began compiling node model.lufthansa.revenue_from_passengers
[0m17:12:23.381455 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.revenue_from_passengers"
[0m17:12:23.381455 [debug] [Thread-1 (]: Began executing node model.lufthansa.revenue_from_passengers
[0m17:12:23.397094 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.revenue_from_passengers"
[0m17:12:23.397094 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:12:23.397094 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: BEGIN
[0m17:12:23.397094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:23.428315 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:12:23.428315 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:12:23.428315 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */

  
    
    

    create  table
      "dev"."main_mart"."revenue_from_passengers__dbt_tmp"
  
    as (
      

select
    p.passenger_id,
    p.first_name,
    p.last_name,
    sum(b.price) as total_revenue,
    count(*) as total_bookings
from "dev"."main_stage"."passengers_stg" p
INNER JOIN "dev"."main_stage"."bookings_stg" b on p.passenger_id = b.passenger_id
group BY p.passenger_id, p.first_name, p.last_name
    );
  
  
[0m17:12:23.443957 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:12:23.443957 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:12:23.443957 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "dev"."main_mart"."revenue_from_passengers" rename to "revenue_from_passengers__dbt_backup"
[0m17:12:23.459555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:23.459555 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:12:23.459555 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "dev"."main_mart"."revenue_from_passengers__dbt_tmp" rename to "revenue_from_passengers"
[0m17:12:23.459555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:23.459555 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:12:23.459555 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:12:23.475809 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:12:23.479583 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:23.479583 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:12:23.479583 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
drop table if exists "dev"."main_mart"."revenue_from_passengers__dbt_backup" cascade
[0m17:12:23.479583 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:23.491090 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: Close
[0m17:12:23.522362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d0831-5b07-4e9b-94b6-f86726a13196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E80C1E90>]}
[0m17:12:23.522362 [info ] [Thread-1 (]: 15 of 15 OK created sql table model main_mart.revenue_from_passengers .......... [[32mOK[0m in 0.14s]
[0m17:12:23.522362 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m17:12:23.522362 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:23.522362 [debug] [MainThread]: On master: BEGIN
[0m17:12:23.522362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:23.553600 [debug] [MainThread]: SQL status: OK in 0.030 seconds
[0m17:12:23.553600 [debug] [MainThread]: On master: COMMIT
[0m17:12:23.553600 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:23.553600 [debug] [MainThread]: On master: COMMIT
[0m17:12:23.553600 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:23.553600 [debug] [MainThread]: On master: Close
[0m17:12:23.569219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:23.569219 [debug] [MainThread]: Connection 'create_dev_main_stage' was properly closed.
[0m17:12:23.569219 [debug] [MainThread]: Connection 'list_dev_main_stage' was properly closed.
[0m17:12:23.569219 [debug] [MainThread]: Connection 'model.lufthansa.revenue_from_passengers' was properly closed.
[0m17:12:23.569219 [info ] [MainThread]: 
[0m17:12:23.569219 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m17:12:23.584819 [debug] [MainThread]: Command end result
[0m17:12:23.647962 [info ] [MainThread]: 
[0m17:12:23.663590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:23.663590 [info ] [MainThread]: 
[0m17:12:23.663590 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m17:12:23.663590 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:23.663590 after 5.34 seconds
[0m17:12:23.663590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E56F6FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E014E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E018B610>]}
[0m17:12:23.663590 [debug] [MainThread]: Flushing usage events
[0m17:17:39.190122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D906EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D906C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D906D610>]}


============================== 17:17:39.206098 | 05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4 ==============================
[0m17:17:39.206098 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:17:39.210088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:17:39.749188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9407110>]}
[0m17:17:39.852102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D650A2D0>]}
[0m17:17:39.868136 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:17:39.891051 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:17:40.181158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:40.181158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:40.259329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DA5B03D0>]}
[0m17:17:40.462712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D6993FD0>]}
[0m17:17:40.462712 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:17:40.462712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9116A50>]}
[0m17:17:40.478313 [info ] [MainThread]: 
[0m17:17:40.478313 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:17:40.509578 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:17:40.697103 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:17:40.697103 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:17:40.697103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:40.728342 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m17:17:40.728342 [debug] [ThreadPool]: On list_dev: Close
[0m17:17:40.743923 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:17:40.743923 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:17:40.743923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:40.775182 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:17:40.775182 [debug] [ThreadPool]: On list_dev: Close
[0m17:17:40.790783 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:17:40.790783 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:17:40.790783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:40.806405 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:17:40.822023 [debug] [ThreadPool]: On list_dev: Close
[0m17:17:40.822023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_mart)
[0m17:17:40.822023 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_mart"
"
[0m17:17:40.837643 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:17:40.837643 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:17:40.837643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:40.868917 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:17:40.868917 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:17:40.868917 [debug] [ThreadPool]: On create_dev_main_mart: BEGIN
[0m17:17:40.868917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:40.868917 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:17:40.868917 [debug] [ThreadPool]: On create_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_mart"} */

    
    
        create schema if not exists "dev"."main_mart"
    
[0m17:17:40.868917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:40.868917 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:17:40.868917 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_mart"
[0m17:17:40.868917 [debug] [ThreadPool]: On create_dev_main_mart: COMMIT
[0m17:17:40.868917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:40.884524 [debug] [ThreadPool]: On create_dev_main_mart: Close
[0m17:17:40.884524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_mart, now create_dev_main_stage)
[0m17:17:40.884524 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_stage"
"
[0m17:17:40.884524 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:17:40.884524 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:17:40.884524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:40.915744 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:17:40.915744 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:17:40.915744 [debug] [ThreadPool]: On create_dev_main_stage: BEGIN
[0m17:17:40.915744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:40.915744 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:17:40.915744 [debug] [ThreadPool]: On create_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_stage"} */

    
    
        create schema if not exists "dev"."main_stage"
    
[0m17:17:40.915744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:40.915744 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:17:40.915744 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_stage"
[0m17:17:40.931364 [debug] [ThreadPool]: On create_dev_main_stage: COMMIT
[0m17:17:40.931364 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:40.931364 [debug] [ThreadPool]: On create_dev_main_stage: Close
[0m17:17:40.931364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_stage, now create_dev_main_raw)
[0m17:17:40.931364 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_raw"
"
[0m17:17:40.931364 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:17:40.946984 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:17:40.946984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:40.962629 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:17:40.962629 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:17:40.962629 [debug] [ThreadPool]: On create_dev_main_raw: BEGIN
[0m17:17:40.962629 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:40.962629 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:17:40.962629 [debug] [ThreadPool]: On create_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_dev_main_raw"} */

    
    
        create schema if not exists "dev"."main_raw"
    
[0m17:17:40.978230 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:40.978230 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:17:40.978230 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_raw"
[0m17:17:40.978230 [debug] [ThreadPool]: On create_dev_main_raw: COMMIT
[0m17:17:40.978230 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:40.978230 [debug] [ThreadPool]: On create_dev_main_raw: Close
[0m17:17:40.993863 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_mart'
[0m17:17:40.993863 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:17:40.993863 [debug] [ThreadPool]: On list_dev_main_mart: BEGIN
[0m17:17:40.993863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:41.025119 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:17:41.025119 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_mart"
[0m17:17:41.025119 [debug] [ThreadPool]: On list_dev_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_mart"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'dev'
  
[0m17:17:41.103233 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m17:17:41.103233 [debug] [ThreadPool]: On list_dev_main_mart: ROLLBACK
[0m17:17:41.103233 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_mart'
[0m17:17:41.118803 [debug] [ThreadPool]: On list_dev_main_mart: Close
[0m17:17:41.118803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_mart, now list_dev_main_stage)
[0m17:17:41.118803 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:17:41.134444 [debug] [ThreadPool]: On list_dev_main_stage: BEGIN
[0m17:17:41.134444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:41.150066 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:17:41.150066 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_stage"
[0m17:17:41.150066 [debug] [ThreadPool]: On list_dev_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_stage"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'dev'
  
[0m17:17:41.228163 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m17:17:41.228163 [debug] [ThreadPool]: On list_dev_main_stage: ROLLBACK
[0m17:17:41.228163 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_stage'
[0m17:17:41.228163 [debug] [ThreadPool]: On list_dev_main_stage: Close
[0m17:17:41.243784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_stage, now list_dev_main_raw)
[0m17:17:41.243784 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:17:41.243784 [debug] [ThreadPool]: On list_dev_main_raw: BEGIN
[0m17:17:41.259404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:41.275024 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:17:41.275024 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_raw"
[0m17:17:41.275024 [debug] [ThreadPool]: On list_dev_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'dev'
  
[0m17:17:41.353149 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m17:17:41.353149 [debug] [ThreadPool]: On list_dev_main_raw: ROLLBACK
[0m17:17:41.353149 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_raw'
[0m17:17:41.353149 [debug] [ThreadPool]: On list_dev_main_raw: Close
[0m17:17:41.370585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_raw, now list_dev_main)
[0m17:17:41.370585 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:17:41.384633 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:17:41.384633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:41.415882 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m17:17:41.415882 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:17:41.415882 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:17:41.495665 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m17:17:41.495665 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:17:41.495665 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:17:41.495665 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:17:41.509694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9110810>]}
[0m17:17:41.509694 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:41.509694 [debug] [MainThread]: On master: BEGIN
[0m17:17:41.509694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:41.540943 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m17:17:41.540943 [debug] [MainThread]: On master: COMMIT
[0m17:17:41.540943 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:41.540943 [debug] [MainThread]: On master: COMMIT
[0m17:17:41.540943 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:17:41.540943 [debug] [MainThread]: On master: Close
[0m17:17:41.540943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:41.556562 [info ] [MainThread]: 
[0m17:17:41.556562 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m17:17:41.572181 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m17:17:41.577284 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m17:17:41.577284 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m17:17:41.588391 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m17:17:41.588391 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m17:17:41.697761 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m17:17:41.697761 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:17:41.697761 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m17:17:41.697761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:17:41.713384 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m17:17:41.729000 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:17:41.729000 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m17:17:41.729000 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:17:41.744625 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:17:41.744625 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw" rename to "aircrafts_raw__dbt_backup"
[0m17:17:41.744625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:41.744625 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:17:41.744625 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "dev"."main_raw"."aircrafts_raw__dbt_tmp" rename to "aircrafts_raw"
[0m17:17:41.760241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:41.791754 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:17:41.791754 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:17:41.807399 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:17:41.807399 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:41.807399 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:17:41.823026 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
drop table if exists "dev"."main_raw"."aircrafts_raw__dbt_backup" cascade
[0m17:17:41.823026 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:41.823026 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m17:17:41.854260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DA448950>]}
[0m17:17:41.854260 [info ] [Thread-1 (]: 1 of 15 OK created sql table model main_raw.aircrafts_raw ...................... [[32mOK[0m in 0.28s]
[0m17:17:41.869882 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m17:17:41.869882 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m17:17:41.869882 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m17:17:41.869882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m17:17:41.869882 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m17:17:41.869882 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m17:17:41.885504 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m17:17:41.885504 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m17:17:41.885504 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:17:41.885504 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m17:17:41.885504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:41.932341 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m17:17:41.932341 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:17:41.932341 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m17:17:41.932341 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:17:41.932341 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:17:41.947981 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw" rename to "airports_raw__dbt_backup"
[0m17:17:41.947981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:41.947981 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:17:41.947981 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "dev"."main_raw"."airports_raw__dbt_tmp" rename to "airports_raw"
[0m17:17:41.947981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:41.966062 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:17:41.967226 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:17:41.968390 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:17:41.972880 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:17:41.979405 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:17:41.979405 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
drop table if exists "dev"."main_raw"."airports_raw__dbt_backup" cascade
[0m17:17:41.979405 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:41.979405 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m17:17:42.010651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DA448950>]}
[0m17:17:42.010651 [info ] [Thread-1 (]: 2 of 15 OK created sql table model main_raw.airports_raw ....................... [[32mOK[0m in 0.14s]
[0m17:17:42.010651 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m17:17:42.010651 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m17:17:42.026272 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m17:17:42.026272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m17:17:42.026272 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m17:17:42.026272 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m17:17:42.026272 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m17:17:42.041911 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m17:17:42.041911 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:17:42.041911 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m17:17:42.041911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:42.073134 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m17:17:42.073134 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:17:42.088750 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m17:17:42.088750 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:17:42.088750 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:17:42.088750 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw" rename to "bookings_raw__dbt_backup"
[0m17:17:42.088750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.104392 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:17:42.104392 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "dev"."main_raw"."bookings_raw__dbt_tmp" rename to "bookings_raw"
[0m17:17:42.104392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.104392 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:17:42.104392 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:17:42.104392 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:17:42.126771 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:17:42.126771 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:17:42.126771 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
drop table if exists "dev"."main_raw"."bookings_raw__dbt_backup" cascade
[0m17:17:42.135799 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:42.135799 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m17:17:42.167089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DAA448D0>]}
[0m17:17:42.167089 [info ] [Thread-1 (]: 3 of 15 OK created sql table model main_raw.bookings_raw ....................... [[32mOK[0m in 0.14s]
[0m17:17:42.167089 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m17:17:42.167089 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m17:17:42.167089 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m17:17:42.182670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m17:17:42.182670 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m17:17:42.182670 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m17:17:42.182670 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m17:17:42.198310 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m17:17:42.198310 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:17:42.198310 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m17:17:42.198310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:42.229548 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:17:42.229548 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:17:42.245149 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m17:17:42.245149 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:17:42.245149 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:17:42.245149 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw" rename to "flights_raw__dbt_backup"
[0m17:17:42.260769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.260769 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:17:42.260769 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "dev"."main_raw"."flights_raw__dbt_tmp" rename to "flights_raw"
[0m17:17:42.260769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.260769 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:17:42.276522 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:17:42.278169 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:17:42.284989 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:17:42.284989 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:17:42.292520 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
drop table if exists "dev"."main_raw"."flights_raw__dbt_backup" cascade
[0m17:17:42.292520 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:42.292520 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m17:17:42.323785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DAB7A890>]}
[0m17:17:42.339384 [info ] [Thread-1 (]: 4 of 15 OK created sql table model main_raw.flights_raw ........................ [[32mOK[0m in 0.14s]
[0m17:17:42.339384 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m17:17:42.339384 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m17:17:42.339384 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m17:17:42.339384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m17:17:42.339384 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m17:17:42.355007 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m17:17:42.355007 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m17:17:42.355007 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m17:17:42.370627 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:17:42.370627 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m17:17:42.370627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:42.401886 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:17:42.401886 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:17:42.401886 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "dev"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:17:42.401886 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:42.417507 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:17:42.417507 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "dev"."main_raw"."passengers_raw" rename to "passengers_raw__dbt_backup"
[0m17:17:42.417507 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.417507 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:17:42.433763 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "dev"."main_raw"."passengers_raw__dbt_tmp" rename to "passengers_raw"
[0m17:17:42.435932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.439396 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:17:42.439396 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:17:42.439396 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:17:42.455519 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:17:42.455519 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:17:42.465045 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
drop table if exists "dev"."main_raw"."passengers_raw__dbt_backup" cascade
[0m17:17:42.465045 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:42.465045 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m17:17:42.496344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DABD4110>]}
[0m17:17:42.511916 [info ] [Thread-1 (]: 5 of 15 OK created sql table model main_raw.passengers_raw ..................... [[32mOK[0m in 0.16s]
[0m17:17:42.511916 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m17:17:42.511916 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m17:17:42.511916 [info ] [Thread-1 (]: 6 of 15 START sql view model main_stage.aircrafts_stg .......................... [RUN]
[0m17:17:42.511916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.aircrafts_stg)
[0m17:17:42.511916 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_stg
[0m17:17:42.527535 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_stg"
[0m17:17:42.527535 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_stg
[0m17:17:42.574395 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_stg"
[0m17:17:42.574395 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:17:42.574395 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: BEGIN
[0m17:17:42.574395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:42.609860 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m17:17:42.609860 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:17:42.609860 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */

  
  create view "dev"."main_stage"."aircrafts_stg__dbt_tmp" as (
    

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from "dev"."main_raw"."aircrafts_raw"
where in_service_date IS NOT null
  );

[0m17:17:42.609860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.621385 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:17:42.621385 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg" rename to "aircrafts_stg__dbt_backup"
[0m17:17:42.621385 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.621385 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:17:42.621385 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "dev"."main_stage"."aircrafts_stg__dbt_tmp" rename to "aircrafts_stg"
[0m17:17:42.637033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.637033 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:17:42.637033 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:17:42.637033 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:17:42.648349 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:17:42.652876 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:17:42.652876 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
drop view if exists "dev"."main_stage"."aircrafts_stg__dbt_backup" cascade
[0m17:17:42.652876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.652876 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: Close
[0m17:17:42.684124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DAB4DDD0>]}
[0m17:17:42.684124 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main_stage.aircrafts_stg ..................... [[32mOK[0m in 0.17s]
[0m17:17:42.684124 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m17:17:42.684124 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m17:17:42.699743 [info ] [Thread-1 (]: 7 of 15 START sql view model main_stage.airports_stg ........................... [RUN]
[0m17:17:42.699743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_stg, now model.lufthansa.airports_stg)
[0m17:17:42.699743 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_stg
[0m17:17:42.699743 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_stg"
[0m17:17:42.715385 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_stg
[0m17:17:42.730984 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_stg"
[0m17:17:42.730984 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:17:42.730984 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: BEGIN
[0m17:17:42.730984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:42.779126 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m17:17:42.779126 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:17:42.779126 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */

  
  create view "dev"."main_stage"."airports_stg__dbt_tmp" as (
    

select
    UPPER(airport_code) as airport_code,
    airport_name,
    city,
    country,
    timezone
from "dev"."main_raw"."airports_raw"
  );

[0m17:17:42.779126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.779126 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:17:42.779126 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg" rename to "airports_stg__dbt_backup"
[0m17:17:42.779126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.793651 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:17:42.793651 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "dev"."main_stage"."airports_stg__dbt_tmp" rename to "airports_stg"
[0m17:17:42.793651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.793651 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:17:42.793651 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:17:42.793651 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:17:42.811674 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:17:42.811674 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:17:42.811674 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
drop view if exists "dev"."main_stage"."airports_stg__dbt_backup" cascade
[0m17:17:42.811674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.825203 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: Close
[0m17:17:42.840831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DA500E10>]}
[0m17:17:42.840831 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main_stage.airports_stg ...................... [[32mOK[0m in 0.14s]
[0m17:17:42.856452 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m17:17:42.856452 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m17:17:42.856452 [info ] [Thread-1 (]: 8 of 15 START sql view model main_stage.bookings_stg ........................... [RUN]
[0m17:17:42.856452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_stg, now model.lufthansa.bookings_stg)
[0m17:17:42.856452 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_stg
[0m17:17:42.856452 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_stg"
[0m17:17:42.872072 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_stg
[0m17:17:42.872072 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_stg"
[0m17:17:42.872072 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:17:42.872072 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: BEGIN
[0m17:17:42.887691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:42.918967 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:17:42.918967 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:17:42.918967 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */

  
  create view "dev"."main_stage"."bookings_stg__dbt_tmp" as (
    

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    UPPER(booking_status) as booking_status,
    price
from "dev"."main_raw"."bookings_raw"
where booking_status is not null
  );

[0m17:17:42.918967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.918967 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:17:42.934574 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg" rename to "bookings_stg__dbt_backup"
[0m17:17:42.934574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.934574 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:17:42.934574 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "dev"."main_stage"."bookings_stg__dbt_tmp" rename to "bookings_stg"
[0m17:17:42.934574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:42.950330 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:17:42.951495 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:17:42.952624 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:17:42.958691 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:17:42.958691 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:17:42.966217 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
drop view if exists "dev"."main_stage"."bookings_stg__dbt_backup" cascade
[0m17:17:42.966217 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:42.966217 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: Close
[0m17:17:42.997464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DAA73490>]}
[0m17:17:42.997464 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main_stage.bookings_stg ...................... [[32mOK[0m in 0.14s]
[0m17:17:42.997464 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m17:17:42.997464 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m17:17:42.997464 [info ] [Thread-1 (]: 9 of 15 START sql view model main_stage.flights_stg ............................ [RUN]
[0m17:17:42.997464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_stg, now model.lufthansa.flights_stg)
[0m17:17:42.997464 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_stg
[0m17:17:43.013105 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_stg"
[0m17:17:43.013105 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_stg
[0m17:17:43.013105 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_stg"
[0m17:17:43.013105 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:17:43.028726 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: BEGIN
[0m17:17:43.028726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:43.059965 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:17:43.059965 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:17:43.059965 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */

  
  create view "dev"."main_stage"."flights_stg__dbt_tmp" as (
    

select
    flight_id,
    flight_number,
    origin_airport_code as airport_from,
    destination_airport_code as airport_to,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    upper(status) as status
from "dev"."main_raw"."flights_raw"
where status is not null
  );

[0m17:17:43.059965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.059965 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:17:43.059965 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg" rename to "flights_stg__dbt_backup"
[0m17:17:43.075586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.075586 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:17:43.075586 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "dev"."main_stage"."flights_stg__dbt_tmp" rename to "flights_stg"
[0m17:17:43.075586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.091331 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:17:43.093021 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:17:43.093603 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:17:43.104318 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:17:43.106847 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:17:43.106847 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
drop view if exists "dev"."main_stage"."flights_stg__dbt_backup" cascade
[0m17:17:43.106847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.200618 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: Close
[0m17:17:43.231837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DA9B4E90>]}
[0m17:17:43.231837 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main_stage.flights_stg ....................... [[32mOK[0m in 0.23s]
[0m17:17:43.231837 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m17:17:43.231837 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m17:17:43.231837 [info ] [Thread-1 (]: 10 of 15 START sql view model main_stage.passengers_stg ........................ [RUN]
[0m17:17:43.231837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_stg, now model.lufthansa.passengers_stg)
[0m17:17:43.231837 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_stg
[0m17:17:43.247458 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_stg"
[0m17:17:43.247458 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_stg
[0m17:17:43.247458 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_stg"
[0m17:17:43.247458 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:17:43.247458 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: BEGIN
[0m17:17:43.247458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:43.294315 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:17:43.294315 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:17:43.294315 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */

  
  create view "dev"."main_stage"."passengers_stg__dbt_tmp" as (
    

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    LOWER(email) as email,
    phone_number
from "dev"."main_raw"."passengers_raw"
  );

[0m17:17:43.294315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.294315 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:17:43.294315 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "dev"."main_stage"."passengers_stg" rename to "passengers_stg__dbt_backup"
[0m17:17:43.294315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.309935 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:17:43.309935 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "dev"."main_stage"."passengers_stg__dbt_tmp" rename to "passengers_stg"
[0m17:17:43.309935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.309935 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:17:43.309935 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:17:43.309935 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:17:43.325534 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:17:43.325534 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:17:43.325534 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
drop view if exists "dev"."main_stage"."passengers_stg__dbt_backup" cascade
[0m17:17:43.325534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.341175 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: Close
[0m17:17:43.356794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D911CBD0>]}
[0m17:17:43.356794 [info ] [Thread-1 (]: 10 of 15 OK created sql view model main_stage.passengers_stg ................... [[32mOK[0m in 0.12s]
[0m17:17:43.372394 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m17:17:43.372394 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m17:17:43.372394 [info ] [Thread-1 (]: 11 of 15 START sql table model main_mart.daily_flights ......................... [RUN]
[0m17:17:43.372394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_stg, now model.lufthansa.daily_flights)
[0m17:17:43.372394 [debug] [Thread-1 (]: Began compiling node model.lufthansa.daily_flights
[0m17:17:43.388013 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.daily_flights"
[0m17:17:43.388013 [debug] [Thread-1 (]: Began executing node model.lufthansa.daily_flights
[0m17:17:43.388013 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.daily_flights"
[0m17:17:43.403656 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:17:43.403656 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: BEGIN
[0m17:17:43.403656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:43.434917 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:17:43.434917 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:17:43.434917 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "dev"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        -- date(scheduled_departure_time) as flight_date,
        -- Function with name date does not exist! Did you mean "datesub"?
        CAST (scheduled_departure_time AS DATE) AS flight_date,
        airport_from,
        airport_to,
        status
    from "dev"."main_stage"."flights_stg"
)
select
    flight_date,
    airport_from,
    airport_to,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, airport_from, airport_to
    );
  
  
[0m17:17:43.450493 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:17:43.450493 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:17:43.450493 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
alter table "dev"."main_mart"."daily_flights" rename to "daily_flights__dbt_backup"
[0m17:17:43.450493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.470508 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:17:43.471588 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
alter table "dev"."main_mart"."daily_flights__dbt_tmp" rename to "daily_flights"
[0m17:17:43.472132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.472132 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: COMMIT
[0m17:17:43.472132 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:17:43.472132 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: COMMIT
[0m17:17:43.484844 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:17:43.484844 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:17:43.484844 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
drop table if exists "dev"."main_mart"."daily_flights__dbt_backup" cascade
[0m17:17:43.497849 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:43.497849 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: Close
[0m17:17:43.529095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9405390>]}
[0m17:17:43.529095 [info ] [Thread-1 (]: 11 of 15 OK created sql table model main_mart.daily_flights .................... [[32mOK[0m in 0.16s]
[0m17:17:43.544718 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m17:17:43.544718 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m17:17:43.544718 [info ] [Thread-1 (]: 12 of 15 START sql table model main_mart.delays ................................ [RUN]
[0m17:17:43.544718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.daily_flights, now model.lufthansa.delays)
[0m17:17:43.544718 [debug] [Thread-1 (]: Began compiling node model.lufthansa.delays
[0m17:17:43.560337 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.delays"
[0m17:17:43.560337 [debug] [Thread-1 (]: Began executing node model.lufthansa.delays
[0m17:17:43.575979 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.delays"
[0m17:17:43.591576 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:17:43.591576 [debug] [Thread-1 (]: On model.lufthansa.delays: BEGIN
[0m17:17:43.591576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:43.622820 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m17:17:43.638438 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:17:43.638438 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */

  
    
    

    create  table
      "dev"."main_mart"."delays__dbt_tmp"
  
    as (
      

WITH delays AS (
    SELECT
        flight_id,
        scheduled_departure_time,
        actual_departure_time,
        EXTRACT('epoch' FROM (actual_departure_time - scheduled_departure_time)) / 60 AS departure_delay_minutes
      --EXTRACT('epoch' FROM interval) function returns the total number of seconds contained in the interval
    FROM "dev"."main_stage"."flights_stg"
    WHERE actual_departure_time IS NOT NULL
)

SELECT
    AVG(departure_delay_minutes) AS average_delay_minutes,
    MAX(departure_delay_minutes) AS max_delay_minutes,
    MIN(departure_delay_minutes) AS min_delay_minutes,
    COUNT(*) AS total_flights
FROM delays
    );
  
  
[0m17:17:43.638438 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:17:43.638438 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:17:43.638438 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays" rename to "delays__dbt_backup"
[0m17:17:43.654718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.663427 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:17:43.664432 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "dev"."main_mart"."delays__dbt_tmp" rename to "delays"
[0m17:17:43.664432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.669940 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:17:43.669940 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:17:43.669940 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:17:43.669940 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:17:43.685593 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:17:43.685593 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
drop table if exists "dev"."main_mart"."delays__dbt_backup" cascade
[0m17:17:43.685593 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:43.685593 [debug] [Thread-1 (]: On model.lufthansa.delays: Close
[0m17:17:43.716807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DA5FAC90>]}
[0m17:17:43.716807 [info ] [Thread-1 (]: 12 of 15 OK created sql table model main_mart.delays ........................... [[32mOK[0m in 0.17s]
[0m17:17:43.716807 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m17:17:43.716807 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m17:17:43.732430 [info ] [Thread-1 (]: 13 of 15 START sql table model main_mart.flight_effectiveness .................. [RUN]
[0m17:17:43.732430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.delays, now model.lufthansa.flight_effectiveness)
[0m17:17:43.732430 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flight_effectiveness
[0m17:17:43.732430 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flight_effectiveness"
[0m17:17:43.748069 [debug] [Thread-1 (]: Began executing node model.lufthansa.flight_effectiveness
[0m17:17:43.748069 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flight_effectiveness"
[0m17:17:43.748069 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:17:43.748069 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: BEGIN
[0m17:17:43.763671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:43.813862 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m17:17:43.813862 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:17:43.813862 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */

  
    
    

    create  table
      "dev"."main_mart"."flight_effectiveness__dbt_tmp"
  
    as (
      

with flight_bookings as (
    select
        b.flight_id,
        count(*) AS booked_seats
    from "dev"."main_stage"."bookings_stg" b
    group by b.flight_id
),
flight_capacity as (
    select
        f.flight_id,
        f.aircraft_id,
        a.capacity
    from "dev"."main_stage"."flights_stg" f
    INNER JOIN "dev"."main_stage"."aircrafts_stg" a ON f.aircraft_id = a.aircraft_id
)
select
    fc.flight_id,
    fc.aircraft_id,
    fc.capacity,
    fb.booked_seats,
    (fb.booked_seats::float / fc.capacity) * 100 AS effectiveness_percentage -- typecast to float
from flight_capacity fc
LEFT JOIN flight_bookings fb ON fc.flight_id = fb.flight_id
    );
  
  
[0m17:17:43.857619 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m17:17:43.873241 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:17:43.873241 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness" rename to "flight_effectiveness__dbt_backup"
[0m17:17:43.873241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.888913 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:17:43.888913 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "dev"."main_mart"."flight_effectiveness__dbt_tmp" rename to "flight_effectiveness"
[0m17:17:43.888913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:43.888913 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:17:43.888913 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:17:43.888913 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:17:43.904631 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:17:43.904631 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:17:43.904631 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
drop table if exists "dev"."main_mart"."flight_effectiveness__dbt_backup" cascade
[0m17:17:43.904631 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:43.904631 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: Close
[0m17:17:43.951500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DAA798D0>]}
[0m17:17:43.951500 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main_mart.flight_effectiveness ............. [[32mOK[0m in 0.22s]
[0m17:17:43.951500 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m17:17:43.951500 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m17:17:43.951500 [info ] [Thread-1 (]: 14 of 15 START sql table model main_mart.top_routes ............................ [RUN]
[0m17:17:43.951500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flight_effectiveness, now model.lufthansa.top_routes)
[0m17:17:43.967183 [debug] [Thread-1 (]: Began compiling node model.lufthansa.top_routes
[0m17:17:43.967183 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.top_routes"
[0m17:17:43.967183 [debug] [Thread-1 (]: Began executing node model.lufthansa.top_routes
[0m17:17:43.982758 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.top_routes"
[0m17:17:43.982758 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:17:43.982758 [debug] [Thread-1 (]: On model.lufthansa.top_routes: BEGIN
[0m17:17:43.982758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:44.029634 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m17:17:44.029634 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:17:44.029634 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */

  
    
    

    create  table
      "dev"."main_mart"."top_routes__dbt_tmp"
  
    as (
      

SELECT
    airport_from,
    airport_to,
    COUNT(*) AS total_flights
FROM "dev"."main_stage"."flights_stg"
GROUP BY airport_from, airport_to
ORDER BY total_flights DESC
LIMIT 10
    );
  
  
[0m17:17:44.029634 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:17:44.048365 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:17:44.049470 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes" rename to "top_routes__dbt_backup"
[0m17:17:44.051659 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:44.061169 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:17:44.061169 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "dev"."main_mart"."top_routes__dbt_tmp" rename to "top_routes"
[0m17:17:44.061169 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:44.061169 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:17:44.061169 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:17:44.076800 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:17:44.080719 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:17:44.080719 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:17:44.080719 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
drop table if exists "dev"."main_mart"."top_routes__dbt_backup" cascade
[0m17:17:44.092760 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:44.092760 [debug] [Thread-1 (]: On model.lufthansa.top_routes: Close
[0m17:17:44.124008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DA5FAC90>]}
[0m17:17:44.124008 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main_mart.top_routes ....................... [[32mOK[0m in 0.17s]
[0m17:17:44.124008 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m17:17:44.124008 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m17:17:44.124008 [info ] [Thread-1 (]: 15 of 15 START sql table model main_mart.revenue_from_passengers ............... [RUN]
[0m17:17:44.139632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.top_routes, now model.lufthansa.revenue_from_passengers)
[0m17:17:44.142060 [debug] [Thread-1 (]: Began compiling node model.lufthansa.revenue_from_passengers
[0m17:17:44.148088 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.revenue_from_passengers"
[0m17:17:44.152084 [debug] [Thread-1 (]: Began executing node model.lufthansa.revenue_from_passengers
[0m17:17:44.164041 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.revenue_from_passengers"
[0m17:17:44.168055 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:17:44.172030 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: BEGIN
[0m17:17:44.172030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:44.232162 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m17:17:44.236151 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:17:44.236151 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */

  
    
    

    create  table
      "dev"."main_mart"."revenue_from_passengers__dbt_tmp"
  
    as (
      

select
    p.passenger_id,
    p.first_name,
    p.last_name,
    sum(b.price) as total_revenue,
    count(*) as total_bookings
from "dev"."main_stage"."passengers_stg" p
INNER JOIN "dev"."main_stage"."bookings_stg" b on p.passenger_id = b.passenger_id
group BY p.passenger_id, p.first_name, p.last_name
    );
  
  
[0m17:17:44.248132 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:17:44.256142 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:17:44.260116 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "dev"."main_mart"."revenue_from_passengers" rename to "revenue_from_passengers__dbt_backup"
[0m17:17:44.260116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:44.268097 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:17:44.272111 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "dev"."main_mart"."revenue_from_passengers__dbt_tmp" rename to "revenue_from_passengers"
[0m17:17:44.272111 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:17:44.280078 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:17:44.280078 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:17:44.280078 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:17:44.288977 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:17:44.295988 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:17:44.295988 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
drop table if exists "dev"."main_mart"."revenue_from_passengers__dbt_backup" cascade
[0m17:17:44.300004 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:17:44.303995 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: Close
[0m17:17:44.334955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b0daf4-2f73-47d9-aaf1-48ae9d4e65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D93E6950>]}
[0m17:17:44.338957 [info ] [Thread-1 (]: 15 of 15 OK created sql table model main_mart.revenue_from_passengers .......... [[32mOK[0m in 0.20s]
[0m17:17:44.338957 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m17:17:44.342966 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:44.346943 [debug] [MainThread]: On master: BEGIN
[0m17:17:44.346943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:44.382918 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m17:17:44.386898 [debug] [MainThread]: On master: COMMIT
[0m17:17:44.386898 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:44.386898 [debug] [MainThread]: On master: COMMIT
[0m17:17:44.386898 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:17:44.390888 [debug] [MainThread]: On master: Close
[0m17:17:44.394883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:44.394883 [debug] [MainThread]: Connection 'create_dev_main_raw' was properly closed.
[0m17:17:44.398876 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m17:17:44.398876 [debug] [MainThread]: Connection 'model.lufthansa.revenue_from_passengers' was properly closed.
[0m17:17:44.398876 [info ] [MainThread]: 
[0m17:17:44.398876 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m17:17:44.414833 [debug] [MainThread]: Command end result
[0m17:17:44.500248 [info ] [MainThread]: 
[0m17:17:44.503256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:44.503256 [info ] [MainThread]: 
[0m17:17:44.507330 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m17:17:44.507330 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:44.507330 after 5.56 seconds
[0m17:17:44.511284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D90DFD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D2C3B610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D2C3B5D0>]}
[0m17:17:44.511284 [debug] [MainThread]: Flushing usage events
[0m17:19:25.914797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88686C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D886863190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D886862150>]}


============================== 17:19:25.930415 | 5b04730b-2ced-451a-814e-2f86049095da ==============================
[0m17:19:25.930415 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:19:25.930415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:19:26.399506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D886911F50>]}
[0m17:19:26.524492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D883D0DC90>]}
[0m17:19:26.524492 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:19:26.555732 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:19:26.727585 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:19:26.727585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8856A2F50>]}
[0m17:19:29.251401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D886863490>]}
[0m17:19:29.559007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8866EF450>]}
[0m17:19:29.559007 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:19:29.563000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D887FB4950>]}
[0m17:19:29.566993 [info ] [MainThread]: 
[0m17:19:29.574981 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:19:29.591158 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lh'
[0m17:19:29.807017 [debug] [ThreadPool]: Using duckdb connection "list_lh"
[0m17:19:29.807017 [debug] [ThreadPool]: On list_lh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lh"'
    
  
  
[0m17:19:29.807017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:29.838279 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m17:19:29.838279 [debug] [ThreadPool]: On list_lh: Close
[0m17:19:29.838279 [debug] [ThreadPool]: Using duckdb connection "list_lh"
[0m17:19:29.853879 [debug] [ThreadPool]: On list_lh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lh"'
    
  
  
[0m17:19:29.853879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:29.885137 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m17:19:29.885137 [debug] [ThreadPool]: On list_lh: Close
[0m17:19:29.900759 [debug] [ThreadPool]: Using duckdb connection "list_lh"
[0m17:19:29.900759 [debug] [ThreadPool]: On list_lh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lh"'
    
  
  
[0m17:19:29.900759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:29.916386 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:19:29.916386 [debug] [ThreadPool]: On list_lh: Close
[0m17:19:29.933238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh, now create_lh_main_mart)
[0m17:19:29.934815 [debug] [ThreadPool]: Creating schema "database: "lh"
schema: "main_mart"
"
[0m17:19:29.947902 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_mart"
[0m17:19:29.947902 [debug] [ThreadPool]: On create_lh_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lh'
        and type='sqlite'
    
  
[0m17:19:29.947902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:29.963535 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m17:19:29.963535 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_mart"
[0m17:19:29.963535 [debug] [ThreadPool]: On create_lh_main_mart: BEGIN
[0m17:19:29.963535 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:29.963535 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_mart"
[0m17:19:29.963535 [debug] [ThreadPool]: On create_lh_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_mart"} */

    
    
        create schema if not exists "lh"."main_mart"
    
[0m17:19:29.979152 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:19:29.979152 [debug] [ThreadPool]: On create_lh_main_mart: COMMIT
[0m17:19:29.979152 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_mart"
[0m17:19:29.979152 [debug] [ThreadPool]: On create_lh_main_mart: COMMIT
[0m17:19:29.986168 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:19:29.986168 [debug] [ThreadPool]: On create_lh_main_mart: Close
[0m17:19:29.995175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lh_main_mart, now create_lh_main_raw)
[0m17:19:29.995175 [debug] [ThreadPool]: Creating schema "database: "lh"
schema: "main_raw"
"
[0m17:19:29.995175 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_raw"
[0m17:19:29.995175 [debug] [ThreadPool]: On create_lh_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lh'
        and type='sqlite'
    
  
[0m17:19:29.995175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:30.042044 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m17:19:30.042044 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_raw"
[0m17:19:30.042044 [debug] [ThreadPool]: On create_lh_main_raw: BEGIN
[0m17:19:30.042044 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:30.042044 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_raw"
[0m17:19:30.042044 [debug] [ThreadPool]: On create_lh_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_raw"} */

    
    
        create schema if not exists "lh"."main_raw"
    
[0m17:19:30.042044 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:30.042044 [debug] [ThreadPool]: On create_lh_main_raw: COMMIT
[0m17:19:30.042044 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_raw"
[0m17:19:30.042044 [debug] [ThreadPool]: On create_lh_main_raw: COMMIT
[0m17:19:30.057686 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:19:30.057686 [debug] [ThreadPool]: On create_lh_main_raw: Close
[0m17:19:30.057686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lh_main_raw, now create_lh_main_stage)
[0m17:19:30.073304 [debug] [ThreadPool]: Creating schema "database: "lh"
schema: "main_stage"
"
[0m17:19:30.073304 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_stage"
[0m17:19:30.073304 [debug] [ThreadPool]: On create_lh_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lh'
        and type='sqlite'
    
  
[0m17:19:30.073304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:30.104548 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m17:19:30.104548 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_stage"
[0m17:19:30.104548 [debug] [ThreadPool]: On create_lh_main_stage: BEGIN
[0m17:19:30.104548 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:30.104548 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_stage"
[0m17:19:30.104548 [debug] [ThreadPool]: On create_lh_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_stage"} */

    
    
        create schema if not exists "lh"."main_stage"
    
[0m17:19:30.120156 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:19:30.120156 [debug] [ThreadPool]: On create_lh_main_stage: COMMIT
[0m17:19:30.120156 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_stage"
[0m17:19:30.120156 [debug] [ThreadPool]: On create_lh_main_stage: COMMIT
[0m17:19:30.120156 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:19:30.120156 [debug] [ThreadPool]: On create_lh_main_stage: Close
[0m17:19:30.135814 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lh_main_mart'
[0m17:19:30.151405 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_mart"
[0m17:19:30.151405 [debug] [ThreadPool]: On list_lh_main_mart: BEGIN
[0m17:19:30.151405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:30.182649 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m17:19:30.182649 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_mart"
[0m17:19:30.182649 [debug] [ThreadPool]: On list_lh_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main_mart"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'lh'
  
[0m17:19:30.276767 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m17:19:30.276767 [debug] [ThreadPool]: On list_lh_main_mart: ROLLBACK
[0m17:19:30.276767 [debug] [ThreadPool]: Failed to rollback 'list_lh_main_mart'
[0m17:19:30.276767 [debug] [ThreadPool]: On list_lh_main_mart: Close
[0m17:19:30.276767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh_main_mart, now list_lh_main_raw)
[0m17:19:30.292408 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_raw"
[0m17:19:30.292408 [debug] [ThreadPool]: On list_lh_main_raw: BEGIN
[0m17:19:30.292408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:30.308030 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m17:19:30.308030 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_raw"
[0m17:19:30.308030 [debug] [ThreadPool]: On list_lh_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main_raw"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'lh'
  
[0m17:19:30.386155 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m17:19:30.401766 [debug] [ThreadPool]: On list_lh_main_raw: ROLLBACK
[0m17:19:30.401766 [debug] [ThreadPool]: Failed to rollback 'list_lh_main_raw'
[0m17:19:30.401766 [debug] [ThreadPool]: On list_lh_main_raw: Close
[0m17:19:30.401766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh_main_raw, now list_lh_main)
[0m17:19:30.417370 [debug] [ThreadPool]: Using duckdb connection "list_lh_main"
[0m17:19:30.417370 [debug] [ThreadPool]: On list_lh_main: BEGIN
[0m17:19:30.417370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:30.433014 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m17:19:30.433014 [debug] [ThreadPool]: Using duckdb connection "list_lh_main"
[0m17:19:30.433014 [debug] [ThreadPool]: On list_lh_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lh'
  
[0m17:19:30.511358 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m17:19:30.511358 [debug] [ThreadPool]: On list_lh_main: ROLLBACK
[0m17:19:30.511358 [debug] [ThreadPool]: Failed to rollback 'list_lh_main'
[0m17:19:30.511358 [debug] [ThreadPool]: On list_lh_main: Close
[0m17:19:30.526976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh_main, now list_lh_main_stage)
[0m17:19:30.526976 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_stage"
[0m17:19:30.526976 [debug] [ThreadPool]: On list_lh_main_stage: BEGIN
[0m17:19:30.526976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:30.542598 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m17:19:30.542598 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_stage"
[0m17:19:30.558216 [debug] [ThreadPool]: On list_lh_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main_stage"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'lh'
  
[0m17:19:30.636750 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m17:19:30.636750 [debug] [ThreadPool]: On list_lh_main_stage: ROLLBACK
[0m17:19:30.636750 [debug] [ThreadPool]: Failed to rollback 'list_lh_main_stage'
[0m17:19:30.636750 [debug] [ThreadPool]: On list_lh_main_stage: Close
[0m17:19:30.636750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8866EEFD0>]}
[0m17:19:30.652371 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:30.652371 [debug] [MainThread]: On master: BEGIN
[0m17:19:30.652371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:30.667991 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m17:19:30.667991 [debug] [MainThread]: On master: COMMIT
[0m17:19:30.667991 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:30.667991 [debug] [MainThread]: On master: COMMIT
[0m17:19:30.667991 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:19:30.667991 [debug] [MainThread]: On master: Close
[0m17:19:30.667991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:30.683610 [info ] [MainThread]: 
[0m17:19:30.683610 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m17:19:30.683610 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m17:19:30.683610 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m17:19:30.683610 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m17:19:30.699250 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m17:19:30.714852 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m17:19:30.777366 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m17:19:30.777366 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:19:30.777366 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m17:19:30.777366 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:19:30.808597 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m17:19:30.808597 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:19:30.808597 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m17:19:30.886957 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m17:19:30.886957 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:19:30.886957 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: ROLLBACK
[0m17:19:30.902598 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.aircrafts_raw'
[0m17:19:30.902598 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m17:19:30.902598 [debug] [Thread-1 (]: Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "duckdb_databases"?
  LINE 19: from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
      );
    
    ...
                ^
[0m17:19:30.918221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D886BE25D0>]}
[0m17:19:30.918221 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model main_raw.aircrafts_raw .................. [[31mERROR[0m in 0.23s]
[0m17:19:30.918221 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m17:19:30.918221 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m17:19:30.918221 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m17:19:30.918221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m17:19:30.918221 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m17:19:30.940219 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m17:19:30.940759 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m17:19:30.949786 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m17:19:30.949786 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:19:30.949786 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m17:19:30.949786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:30.965437 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m17:19:30.965437 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:19:30.965437 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m17:19:31.027928 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m17:19:31.043553 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:19:31.043553 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: ROLLBACK
[0m17:19:31.043553 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.airports_raw'
[0m17:19:31.043553 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m17:19:31.059154 [debug] [Thread-1 (]: Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name raw_airports does not exist!
  Did you mean "pragma_database_list"?
  LINE 19: from main.raw_airports
                ^
[0m17:19:31.059154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8882AAB10>]}
[0m17:19:31.059154 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model main_raw.airports_raw ................... [[31mERROR[0m in 0.14s]
[0m17:19:31.059154 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m17:19:31.059154 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m17:19:31.059154 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m17:19:31.059154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m17:19:31.074754 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m17:19:31.074754 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m17:19:31.074754 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m17:19:31.090376 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m17:19:31.090376 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:19:31.090376 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m17:19:31.090376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:31.105996 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m17:19:31.105996 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:19:31.105996 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m17:19:31.184093 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m17:19:31.184093 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:19:31.184093 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: ROLLBACK
[0m17:19:31.184093 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.bookings_raw'
[0m17:19:31.184093 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m17:19:31.199741 [debug] [Thread-1 (]: Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name raw_bookings does not exist!
  Did you mean "duckdb_columns"?
  LINE 20: from  main.raw_bookings
                 ^
[0m17:19:31.199741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8884A5E10>]}
[0m17:19:31.199741 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model main_raw.bookings_raw ................... [[31mERROR[0m in 0.14s]
[0m17:19:31.199741 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m17:19:31.199741 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m17:19:31.199741 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m17:19:31.215334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m17:19:31.215334 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m17:19:31.215334 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m17:19:31.215334 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m17:19:31.230976 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m17:19:31.230976 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:19:31.230976 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m17:19:31.230976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:31.246596 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m17:19:31.246596 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:19:31.246596 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m17:19:31.324709 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m17:19:31.324709 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:19:31.324709 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: ROLLBACK
[0m17:19:31.324709 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.flights_raw'
[0m17:19:31.324709 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m17:19:31.340329 [debug] [Thread-1 (]: Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name raw_flights does not exist!
  Did you mean "pragma_database_list"?
  LINE 24: from main.raw_flights
                ^
[0m17:19:31.340329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8884905D0>]}
[0m17:19:31.340329 [error] [Thread-1 (]: 4 of 15 ERROR creating sql table model main_raw.flights_raw .................... [[31mERROR[0m in 0.14s]
[0m17:19:31.340329 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m17:19:31.340329 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m17:19:31.355936 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m17:19:31.355936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m17:19:31.355936 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m17:19:31.355936 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m17:19:31.355936 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m17:19:31.371534 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m17:19:31.371534 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:19:31.371534 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m17:19:31.371534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:31.387177 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m17:19:31.387177 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:19:31.387177 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:19:31.465291 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:19:31.465291 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:19:31.465291 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: ROLLBACK
[0m17:19:31.465291 [debug] [Thread-1 (]: Failed to rollback 'model.lufthansa.passengers_raw'
[0m17:19:31.465291 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m17:19:31.480897 [debug] [Thread-1 (]: Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Catalog Error: Table with name raw_passengers does not exist!
  Did you mean "pragma_database_list"?
  LINE 20: from  main.raw_passengers
                 ^
[0m17:19:31.480897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b04730b-2ced-451a-814e-2f86049095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88697E990>]}
[0m17:19:31.480897 [error] [Thread-1 (]: 5 of 15 ERROR creating sql table model main_raw.passengers_raw ................. [[31mERROR[0m in 0.12s]
[0m17:19:31.480897 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m17:19:31.480897 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m17:19:31.480897 [info ] [Thread-1 (]: 6 of 15 SKIP relation main_stage.aircrafts_stg ................................. [[33mSKIP[0m]
[0m17:19:31.496517 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m17:19:31.496517 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m17:19:31.496517 [info ] [Thread-1 (]: 7 of 15 SKIP relation main_stage.airports_stg .................................. [[33mSKIP[0m]
[0m17:19:31.496517 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m17:19:31.496517 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m17:19:31.496517 [info ] [Thread-1 (]: 8 of 15 SKIP relation main_stage.bookings_stg .................................. [[33mSKIP[0m]
[0m17:19:31.496517 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m17:19:31.496517 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m17:19:31.496517 [info ] [Thread-1 (]: 9 of 15 SKIP relation main_stage.flights_stg ................................... [[33mSKIP[0m]
[0m17:19:31.496517 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m17:19:31.496517 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m17:19:31.496517 [info ] [Thread-1 (]: 10 of 15 SKIP relation main_stage.passengers_stg ............................... [[33mSKIP[0m]
[0m17:19:31.512138 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m17:19:31.512138 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m17:19:31.512138 [info ] [Thread-1 (]: 11 of 15 SKIP relation main_mart.daily_flights ................................. [[33mSKIP[0m]
[0m17:19:31.512138 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m17:19:31.512138 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m17:19:31.512138 [info ] [Thread-1 (]: 12 of 15 SKIP relation main_mart.delays ........................................ [[33mSKIP[0m]
[0m17:19:31.512138 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m17:19:31.512138 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m17:19:31.512138 [info ] [Thread-1 (]: 13 of 15 SKIP relation main_mart.flight_effectiveness .......................... [[33mSKIP[0m]
[0m17:19:31.512138 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m17:19:31.512138 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m17:19:31.527735 [info ] [Thread-1 (]: 14 of 15 SKIP relation main_mart.top_routes .................................... [[33mSKIP[0m]
[0m17:19:31.527735 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m17:19:31.527735 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m17:19:31.527735 [info ] [Thread-1 (]: 15 of 15 SKIP relation main_mart.revenue_from_passengers ....................... [[33mSKIP[0m]
[0m17:19:31.527735 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m17:19:31.527735 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:31.527735 [debug] [MainThread]: On master: BEGIN
[0m17:19:31.527735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:31.543376 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m17:19:31.558977 [debug] [MainThread]: On master: COMMIT
[0m17:19:31.558977 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:31.558977 [debug] [MainThread]: On master: COMMIT
[0m17:19:31.558977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:19:31.558977 [debug] [MainThread]: On master: Close
[0m17:19:31.558977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:31.558977 [debug] [MainThread]: Connection 'create_lh_main_stage' was properly closed.
[0m17:19:31.558977 [debug] [MainThread]: Connection 'list_lh_main_stage' was properly closed.
[0m17:19:31.558977 [debug] [MainThread]: Connection 'model.lufthansa.passengers_raw' was properly closed.
[0m17:19:31.558977 [info ] [MainThread]: 
[0m17:19:31.558977 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m17:19:31.574593 [debug] [MainThread]: Command end result
[0m17:19:31.637100 [info ] [MainThread]: 
[0m17:19:31.652696 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:19:31.652696 [info ] [MainThread]: 
[0m17:19:31.652696 [error] [MainThread]:   Runtime Error in model aircrafts_raw (models\raw\aircrafts_raw.sql)
  Catalog Error: Table with name raw_aircrafts does not exist!
  Did you mean "duckdb_databases"?
  LINE 19: from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
      );
    
    ...
                ^
[0m17:19:31.652696 [info ] [MainThread]: 
[0m17:19:31.652696 [error] [MainThread]:   Runtime Error in model airports_raw (models\raw\airports_raw.sql)
  Catalog Error: Table with name raw_airports does not exist!
  Did you mean "pragma_database_list"?
  LINE 19: from main.raw_airports
                ^
[0m17:19:31.652696 [info ] [MainThread]: 
[0m17:19:31.652696 [error] [MainThread]:   Runtime Error in model bookings_raw (models\raw\bookings_raw.sql)
  Catalog Error: Table with name raw_bookings does not exist!
  Did you mean "duckdb_columns"?
  LINE 20: from  main.raw_bookings
                 ^
[0m17:19:31.652696 [info ] [MainThread]: 
[0m17:19:31.652696 [error] [MainThread]:   Runtime Error in model flights_raw (models\raw\flights_raw.sql)
  Catalog Error: Table with name raw_flights does not exist!
  Did you mean "pragma_database_list"?
  LINE 24: from main.raw_flights
                ^
[0m17:19:31.652696 [info ] [MainThread]: 
[0m17:19:31.652696 [error] [MainThread]:   Runtime Error in model passengers_raw (models\raw\passengers_raw.sql)
  Catalog Error: Table with name raw_passengers does not exist!
  Did you mean "pragma_database_list"?
  LINE 20: from  main.raw_passengers
                 ^
[0m17:19:31.652696 [info ] [MainThread]: 
[0m17:19:31.668336 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=10 TOTAL=15
[0m17:19:31.668336 [debug] [MainThread]: Command `dbt run` failed at 17:19:31.668336 after 5.90 seconds
[0m17:19:31.668336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88035E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88062D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88062D850>]}
[0m17:19:31.668336 [debug] [MainThread]: Flushing usage events
[0m17:19:45.826550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F0A5ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F075A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F0AA3F10>]}


============================== 17:19:45.840577 | 00f87b8b-3b22-42ea-91a8-a7b525db4352 ==============================
[0m17:19:45.840577 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:19:45.840577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:19:46.309351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F0AF4890>]}
[0m17:19:46.418711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EDEFA550>]}
[0m17:19:46.418711 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:19:46.449913 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:19:46.762351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:46.762351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:46.840449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F0AFD390>]}
[0m17:19:47.043475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F0D93D10>]}
[0m17:19:47.043475 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:19:47.059095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F0F117D0>]}
[0m17:19:47.059095 [info ] [MainThread]: 
[0m17:19:47.059095 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:19:47.074716 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lh'
[0m17:19:47.278161 [debug] [ThreadPool]: Using duckdb connection "list_lh"
[0m17:19:47.278161 [debug] [ThreadPool]: On list_lh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lh"'
    
  
  
[0m17:19:47.278161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:47.309788 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m17:19:47.309788 [debug] [ThreadPool]: On list_lh: Close
[0m17:19:47.325435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh, now create_lh_main)
[0m17:19:47.325435 [debug] [ThreadPool]: Creating schema "database: "lh"
schema: "main"
"
[0m17:19:47.341060 [debug] [ThreadPool]: Using duckdb connection "create_lh_main"
[0m17:19:47.341060 [debug] [ThreadPool]: On create_lh_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lh'
        and type='sqlite'
    
  
[0m17:19:47.341060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:47.356656 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m17:19:47.356656 [debug] [ThreadPool]: Using duckdb connection "create_lh_main"
[0m17:19:47.356656 [debug] [ThreadPool]: On create_lh_main: BEGIN
[0m17:19:47.356656 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:19:47.372300 [debug] [ThreadPool]: Using duckdb connection "create_lh_main"
[0m17:19:47.372300 [debug] [ThreadPool]: On create_lh_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main"} */

    
    
        create schema if not exists "lh"."main"
    
[0m17:19:47.372300 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:19:47.372300 [debug] [ThreadPool]: On create_lh_main: COMMIT
[0m17:19:47.372300 [debug] [ThreadPool]: Using duckdb connection "create_lh_main"
[0m17:19:47.372300 [debug] [ThreadPool]: On create_lh_main: COMMIT
[0m17:19:47.372300 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:47.372300 [debug] [ThreadPool]: On create_lh_main: Close
[0m17:19:47.387916 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lh_main_raw'
[0m17:19:47.387916 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_raw"
[0m17:19:47.387916 [debug] [ThreadPool]: On list_lh_main_raw: BEGIN
[0m17:19:47.405251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:47.419258 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m17:19:47.419258 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_raw"
[0m17:19:47.419258 [debug] [ThreadPool]: On list_lh_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main_raw"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'lh'
  
[0m17:19:47.497402 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m17:19:47.497402 [debug] [ThreadPool]: On list_lh_main_raw: ROLLBACK
[0m17:19:47.514876 [debug] [ThreadPool]: Failed to rollback 'list_lh_main_raw'
[0m17:19:47.516116 [debug] [ThreadPool]: On list_lh_main_raw: Close
[0m17:19:47.519508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh_main_raw, now list_lh_main)
[0m17:19:47.519508 [debug] [ThreadPool]: Using duckdb connection "list_lh_main"
[0m17:19:47.529017 [debug] [ThreadPool]: On list_lh_main: BEGIN
[0m17:19:47.529017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:47.544645 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m17:19:47.544645 [debug] [ThreadPool]: Using duckdb connection "list_lh_main"
[0m17:19:47.544645 [debug] [ThreadPool]: On list_lh_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lh'
  
[0m17:19:47.622745 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m17:19:47.622745 [debug] [ThreadPool]: On list_lh_main: ROLLBACK
[0m17:19:47.622745 [debug] [ThreadPool]: Failed to rollback 'list_lh_main'
[0m17:19:47.622745 [debug] [ThreadPool]: On list_lh_main: Close
[0m17:19:47.638366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh_main, now list_lh_main_stage)
[0m17:19:47.638366 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_stage"
[0m17:19:47.638366 [debug] [ThreadPool]: On list_lh_main_stage: BEGIN
[0m17:19:47.638366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:47.653988 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m17:19:47.653988 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_stage"
[0m17:19:47.653988 [debug] [ThreadPool]: On list_lh_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main_stage"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'lh'
  
[0m17:19:47.732085 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m17:19:47.732085 [debug] [ThreadPool]: On list_lh_main_stage: ROLLBACK
[0m17:19:47.747707 [debug] [ThreadPool]: Failed to rollback 'list_lh_main_stage'
[0m17:19:47.747707 [debug] [ThreadPool]: On list_lh_main_stage: Close
[0m17:19:47.747707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh_main_stage, now list_lh_main_mart)
[0m17:19:47.747707 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_mart"
[0m17:19:47.747707 [debug] [ThreadPool]: On list_lh_main_mart: BEGIN
[0m17:19:47.763409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:47.778982 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m17:19:47.778982 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_mart"
[0m17:19:47.778982 [debug] [ThreadPool]: On list_lh_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main_mart"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'lh'
  
[0m17:19:47.857049 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m17:19:47.857049 [debug] [ThreadPool]: On list_lh_main_mart: ROLLBACK
[0m17:19:47.857049 [debug] [ThreadPool]: Failed to rollback 'list_lh_main_mart'
[0m17:19:47.857049 [debug] [ThreadPool]: On list_lh_main_mart: Close
[0m17:19:47.872687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F0B440D0>]}
[0m17:19:47.872687 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:47.872687 [debug] [MainThread]: On master: BEGIN
[0m17:19:47.872687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:47.888312 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m17:19:47.888312 [debug] [MainThread]: On master: COMMIT
[0m17:19:47.888312 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:47.888312 [debug] [MainThread]: On master: COMMIT
[0m17:19:47.888312 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:19:47.888312 [debug] [MainThread]: On master: Close
[0m17:19:47.903929 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:47.903929 [info ] [MainThread]: 
[0m17:19:47.903929 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_aircrafts
[0m17:19:47.903929 [info ] [Thread-1 (]: 1 of 5 START seed file main.raw_aircrafts ...................................... [RUN]
[0m17:19:47.903929 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.lufthansa.raw_aircrafts'
[0m17:19:47.903929 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_aircrafts
[0m17:19:47.903929 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_aircrafts
[0m17:19:47.982047 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m17:19:47.982047 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: BEGIN
[0m17:19:47.982047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:19:47.997653 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m17:19:47.997653 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m17:19:47.997653 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_aircrafts"} */

    create table "lh"."main"."raw_aircrafts" ("aircraft_id" text,"aircraft_model" text,"capacity" integer,"manufacturer" text,"in_service_date" date)
  
[0m17:19:47.997653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:19:48.028901 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m17:19:48.028901 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: 
          COPY "lh"."main"."raw_aircrafts" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_aircrafts.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:19:48.028901 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:19:48.044521 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_aircrafts"
[0m17:19:48.091385 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: COMMIT
[0m17:19:48.091385 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_aircrafts"
[0m17:19:48.091385 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: COMMIT
[0m17:19:48.099839 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:19:48.099839 [debug] [Thread-1 (]: On seed.lufthansa.raw_aircrafts: Close
[0m17:19:48.123014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F23C6350>]}
[0m17:19:48.123014 [info ] [Thread-1 (]: 1 of 5 OK loaded seed file main.raw_aircrafts .................................. [[32mINSERT 10[0m in 0.22s]
[0m17:19:48.123014 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_aircrafts
[0m17:19:48.123014 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_airports
[0m17:19:48.123014 [info ] [Thread-1 (]: 2 of 5 START seed file main.raw_airports ....................................... [RUN]
[0m17:19:48.123014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_aircrafts, now seed.lufthansa.raw_airports)
[0m17:19:48.138616 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_airports
[0m17:19:48.138616 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_airports
[0m17:19:48.138616 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m17:19:48.138616 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: BEGIN
[0m17:19:48.138616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:48.169857 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:19:48.169857 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m17:19:48.169857 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_airports"} */

    create table "lh"."main"."raw_airports" ("airport_code" text,"airport_name" text,"city" text,"country" text,"timezone" text)
  
[0m17:19:48.185496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:19:48.185496 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m17:19:48.185496 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: 
          COPY "lh"."main"."raw_airports" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_airports.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:19:48.185496 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:19:48.185496 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_airports"
[0m17:19:48.201116 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: COMMIT
[0m17:19:48.201116 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_airports"
[0m17:19:48.201116 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: COMMIT
[0m17:19:48.201116 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:19:48.201116 [debug] [Thread-1 (]: On seed.lufthansa.raw_airports: Close
[0m17:19:48.232336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F207D4D0>]}
[0m17:19:48.232336 [info ] [Thread-1 (]: 2 of 5 OK loaded seed file main.raw_airports ................................... [[32mINSERT 15[0m in 0.11s]
[0m17:19:48.232336 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_airports
[0m17:19:48.232336 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_bookings
[0m17:19:48.232336 [info ] [Thread-1 (]: 3 of 5 START seed file main.raw_bookings ....................................... [RUN]
[0m17:19:48.247958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_airports, now seed.lufthansa.raw_bookings)
[0m17:19:48.247958 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_bookings
[0m17:19:48.247958 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_bookings
[0m17:19:48.263597 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m17:19:48.263597 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: BEGIN
[0m17:19:48.263597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:48.294817 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:19:48.294817 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m17:19:48.294817 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_bookings"} */

    create table "lh"."main"."raw_bookings" ("booking_id" integer,"flight_id" integer,"passenger_id" integer,"booking_date" date,"booking_status" text,"price" integer)
  
[0m17:19:48.294817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:19:48.294817 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m17:19:48.294817 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: 
          COPY "lh"."main"."raw_bookings" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_bookings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:19:48.310437 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:19:48.310437 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_bookings"
[0m17:19:48.310437 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: COMMIT
[0m17:19:48.326056 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_bookings"
[0m17:19:48.326056 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: COMMIT
[0m17:19:48.326056 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:19:48.326056 [debug] [Thread-1 (]: On seed.lufthansa.raw_bookings: Close
[0m17:19:48.341676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F2418E50>]}
[0m17:19:48.341676 [info ] [Thread-1 (]: 3 of 5 OK loaded seed file main.raw_bookings ................................... [[32mINSERT 20[0m in 0.09s]
[0m17:19:48.357297 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_bookings
[0m17:19:48.357297 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_flights
[0m17:19:48.357297 [info ] [Thread-1 (]: 4 of 5 START seed file main.raw_flights ........................................ [RUN]
[0m17:19:48.357297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_bookings, now seed.lufthansa.raw_flights)
[0m17:19:48.357297 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_flights
[0m17:19:48.372918 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_flights
[0m17:19:48.372918 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m17:19:48.388540 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: BEGIN
[0m17:19:48.388540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:48.404178 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m17:19:48.419777 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m17:19:48.419777 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_flights"} */

    create table "lh"."main"."raw_flights" ("flight_id" integer,"flight_number" text,"origin_airport_code" text,"destination_airport_code" text,"scheduled_departure_time" timestamp without time zone,"scheduled_arrival_time" timestamp without time zone,"actual_departure_time" timestamp without time zone,"actual_arrival_time" timestamp without time zone,"aircraft_id" text,"status" text)
  
[0m17:19:48.419777 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:19:48.419777 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m17:19:48.419777 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: 
          COPY "lh"."main"."raw_flights" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_flights.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:19:48.435420 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:19:48.435420 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_flights"
[0m17:19:48.435420 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: COMMIT
[0m17:19:48.435420 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_flights"
[0m17:19:48.435420 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: COMMIT
[0m17:19:48.435420 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:19:48.451017 [debug] [Thread-1 (]: On seed.lufthansa.raw_flights: Close
[0m17:19:48.466637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F24EC810>]}
[0m17:19:48.466637 [info ] [Thread-1 (]: 4 of 5 OK loaded seed file main.raw_flights .................................... [[32mINSERT 15[0m in 0.11s]
[0m17:19:48.482257 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_flights
[0m17:19:48.482257 [debug] [Thread-1 (]: Began running node seed.lufthansa.raw_passengers
[0m17:19:48.482257 [info ] [Thread-1 (]: 5 of 5 START seed file main.raw_passengers ..................................... [RUN]
[0m17:19:48.482257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.lufthansa.raw_flights, now seed.lufthansa.raw_passengers)
[0m17:19:48.482257 [debug] [Thread-1 (]: Began compiling node seed.lufthansa.raw_passengers
[0m17:19:48.482257 [debug] [Thread-1 (]: Began executing node seed.lufthansa.raw_passengers
[0m17:19:48.497878 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m17:19:48.497878 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: BEGIN
[0m17:19:48.497878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:48.529118 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m17:19:48.529118 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m17:19:48.529118 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "seed.lufthansa.raw_passengers"} */

    create table "lh"."main"."raw_passengers" ("passenger_id" integer,"first_name" text,"last_name" text,"date_of_birth" date,"email" text,"phone_number" text)
  
[0m17:19:48.529118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:19:48.529118 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m17:19:48.529118 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: 
          COPY "lh"."main"."raw_passengers" FROM 'C:\Coding\DataBases\DbtWork\lufthansa\lufthansa\seeds\raw_passengers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:19:48.544738 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:19:48.544738 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.lufthansa.raw_passengers"
[0m17:19:48.544738 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: COMMIT
[0m17:19:48.544738 [debug] [Thread-1 (]: Using duckdb connection "seed.lufthansa.raw_passengers"
[0m17:19:48.544738 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: COMMIT
[0m17:19:48.544738 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:19:48.560357 [debug] [Thread-1 (]: On seed.lufthansa.raw_passengers: Close
[0m17:19:48.575978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00f87b8b-3b22-42ea-91a8-a7b525db4352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F0D53610>]}
[0m17:19:48.575978 [info ] [Thread-1 (]: 5 of 5 OK loaded seed file main.raw_passengers ................................. [[32mINSERT 20[0m in 0.09s]
[0m17:19:48.575978 [debug] [Thread-1 (]: Finished running node seed.lufthansa.raw_passengers
[0m17:19:48.575978 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:48.575978 [debug] [MainThread]: On master: BEGIN
[0m17:19:48.575978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:48.607218 [debug] [MainThread]: SQL status: OK in 0.027 seconds
[0m17:19:48.607218 [debug] [MainThread]: On master: COMMIT
[0m17:19:48.607218 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:48.607218 [debug] [MainThread]: On master: COMMIT
[0m17:19:48.607218 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:19:48.622858 [debug] [MainThread]: On master: Close
[0m17:19:48.622858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:48.622858 [debug] [MainThread]: Connection 'create_lh_main' was properly closed.
[0m17:19:48.622858 [debug] [MainThread]: Connection 'list_lh_main_mart' was properly closed.
[0m17:19:48.622858 [debug] [MainThread]: Connection 'seed.lufthansa.raw_passengers' was properly closed.
[0m17:19:48.622858 [info ] [MainThread]: 
[0m17:19:48.622858 [info ] [MainThread]: Finished running 5 seeds in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m17:19:48.622858 [debug] [MainThread]: Command end result
[0m17:19:48.701350 [info ] [MainThread]: 
[0m17:19:48.701350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:48.701350 [info ] [MainThread]: 
[0m17:19:48.701350 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:19:48.701350 [debug] [MainThread]: Command `dbt seed` succeeded at 17:19:48.701350 after 3.02 seconds
[0m17:19:48.701350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F0ACFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EA54E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EA58B610>]}
[0m17:19:48.717000 [debug] [MainThread]: Flushing usage events
[0m17:19:57.323400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D924EEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D92522D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D925227D0>]}


============================== 17:19:57.323400 | 6dfcd795-76e8-42b4-b8d8-de6e04ac61aa ==============================
[0m17:19:57.323400 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:19:57.323400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Coding\\DataBases\\DbtWork\\lufthansa\\lufthansa\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Hanna\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:19:57.792461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D92883ED0>]}
[0m17:19:57.886182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D8F98D750>]}
[0m17:19:57.901801 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m17:19:57.917413 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:19:58.230287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:58.230287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:58.308390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D938D7090>]}
[0m17:19:58.495840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D92588DD0>]}
[0m17:19:58.495840 [info ] [MainThread]: Found 15 models, 5 seeds, 416 macros
[0m17:19:58.511470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D92566290>]}
[0m17:19:58.511470 [info ] [MainThread]: 
[0m17:19:58.511470 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:19:58.527105 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lh'
[0m17:19:58.714544 [debug] [ThreadPool]: Using duckdb connection "list_lh"
[0m17:19:58.714544 [debug] [ThreadPool]: On list_lh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lh"'
    
  
  
[0m17:19:58.714544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:58.745771 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:19:58.745771 [debug] [ThreadPool]: On list_lh: Close
[0m17:19:58.761372 [debug] [ThreadPool]: Using duckdb connection "list_lh"
[0m17:19:58.761372 [debug] [ThreadPool]: On list_lh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lh"'
    
  
  
[0m17:19:58.761372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:58.777021 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:19:58.777021 [debug] [ThreadPool]: On list_lh: Close
[0m17:19:58.792630 [debug] [ThreadPool]: Using duckdb connection "list_lh"
[0m17:19:58.792630 [debug] [ThreadPool]: On list_lh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lh"'
    
  
  
[0m17:19:58.792630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:58.808252 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:19:58.823849 [debug] [ThreadPool]: On list_lh: Close
[0m17:19:58.823849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh, now create_lh_main_mart)
[0m17:19:58.823849 [debug] [ThreadPool]: Creating schema "database: "lh"
schema: "main_mart"
"
[0m17:19:58.839492 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_mart"
[0m17:19:58.839492 [debug] [ThreadPool]: On create_lh_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_mart"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lh'
        and type='sqlite'
    
  
[0m17:19:58.839492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:58.855112 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m17:19:58.870747 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_mart"
[0m17:19:58.870747 [debug] [ThreadPool]: On create_lh_main_mart: BEGIN
[0m17:19:58.870747 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:58.870747 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_mart"
[0m17:19:58.870747 [debug] [ThreadPool]: On create_lh_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_mart"} */

    
    
        create schema if not exists "lh"."main_mart"
    
[0m17:19:58.870747 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:58.870747 [debug] [ThreadPool]: On create_lh_main_mart: COMMIT
[0m17:19:58.870747 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_mart"
[0m17:19:58.870747 [debug] [ThreadPool]: On create_lh_main_mart: COMMIT
[0m17:19:58.870747 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:58.870747 [debug] [ThreadPool]: On create_lh_main_mart: Close
[0m17:19:58.886351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lh_main_mart, now create_lh_main_raw)
[0m17:19:58.886351 [debug] [ThreadPool]: Creating schema "database: "lh"
schema: "main_raw"
"
[0m17:19:58.886351 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_raw"
[0m17:19:58.886351 [debug] [ThreadPool]: On create_lh_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lh'
        and type='sqlite'
    
  
[0m17:19:58.886351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:58.917590 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:19:58.917590 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_raw"
[0m17:19:58.917590 [debug] [ThreadPool]: On create_lh_main_raw: BEGIN
[0m17:19:58.917590 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:58.917590 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_raw"
[0m17:19:58.917590 [debug] [ThreadPool]: On create_lh_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_raw"} */

    
    
        create schema if not exists "lh"."main_raw"
    
[0m17:19:58.917590 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:58.917590 [debug] [ThreadPool]: On create_lh_main_raw: COMMIT
[0m17:19:58.917590 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_raw"
[0m17:19:58.917590 [debug] [ThreadPool]: On create_lh_main_raw: COMMIT
[0m17:19:58.917590 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:58.933211 [debug] [ThreadPool]: On create_lh_main_raw: Close
[0m17:19:58.933211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lh_main_raw, now create_lh_main_stage)
[0m17:19:58.933211 [debug] [ThreadPool]: Creating schema "database: "lh"
schema: "main_stage"
"
[0m17:19:58.933211 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_stage"
[0m17:19:58.933211 [debug] [ThreadPool]: On create_lh_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lh'
        and type='sqlite'
    
  
[0m17:19:58.933211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:58.964450 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:19:58.964450 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_stage"
[0m17:19:58.964450 [debug] [ThreadPool]: On create_lh_main_stage: BEGIN
[0m17:19:58.964450 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:58.964450 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_stage"
[0m17:19:58.964450 [debug] [ThreadPool]: On create_lh_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "create_lh_main_stage"} */

    
    
        create schema if not exists "lh"."main_stage"
    
[0m17:19:58.964450 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:58.964450 [debug] [ThreadPool]: On create_lh_main_stage: COMMIT
[0m17:19:58.964450 [debug] [ThreadPool]: Using duckdb connection "create_lh_main_stage"
[0m17:19:58.964450 [debug] [ThreadPool]: On create_lh_main_stage: COMMIT
[0m17:19:58.980070 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:58.980070 [debug] [ThreadPool]: On create_lh_main_stage: Close
[0m17:19:58.980070 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lh_main'
[0m17:19:58.995670 [debug] [ThreadPool]: Using duckdb connection "list_lh_main"
[0m17:19:58.995670 [debug] [ThreadPool]: On list_lh_main: BEGIN
[0m17:19:58.995670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:59.011292 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m17:19:59.011292 [debug] [ThreadPool]: Using duckdb connection "list_lh_main"
[0m17:19:59.026911 [debug] [ThreadPool]: On list_lh_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lh'
  
[0m17:19:59.120630 [debug] [ThreadPool]: SQL status: OK in 0.095 seconds
[0m17:19:59.120630 [debug] [ThreadPool]: On list_lh_main: ROLLBACK
[0m17:19:59.120630 [debug] [ThreadPool]: Failed to rollback 'list_lh_main'
[0m17:19:59.120630 [debug] [ThreadPool]: On list_lh_main: Close
[0m17:19:59.136251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh_main, now list_lh_main_mart)
[0m17:19:59.136251 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_mart"
[0m17:19:59.136251 [debug] [ThreadPool]: On list_lh_main_mart: BEGIN
[0m17:19:59.136251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:59.164126 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:19:59.164126 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_mart"
[0m17:19:59.168113 [debug] [ThreadPool]: On list_lh_main_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main_mart"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_mart'
    and lower(table_catalog) = 'lh'
  
[0m17:19:59.291889 [debug] [ThreadPool]: SQL status: OK in 0.124 seconds
[0m17:19:59.295902 [debug] [ThreadPool]: On list_lh_main_mart: ROLLBACK
[0m17:19:59.295902 [debug] [ThreadPool]: Failed to rollback 'list_lh_main_mart'
[0m17:19:59.295902 [debug] [ThreadPool]: On list_lh_main_mart: Close
[0m17:19:59.303887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh_main_mart, now list_lh_main_raw)
[0m17:19:59.311875 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_raw"
[0m17:19:59.311875 [debug] [ThreadPool]: On list_lh_main_raw: BEGIN
[0m17:19:59.315867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:59.335812 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:19:59.335812 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_raw"
[0m17:19:59.335812 [debug] [ThreadPool]: On list_lh_main_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main_raw"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'lh'
  
[0m17:19:59.427683 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:19:59.427683 [debug] [ThreadPool]: On list_lh_main_raw: ROLLBACK
[0m17:19:59.431674 [debug] [ThreadPool]: Failed to rollback 'list_lh_main_raw'
[0m17:19:59.431674 [debug] [ThreadPool]: On list_lh_main_raw: Close
[0m17:19:59.439640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lh_main_raw, now list_lh_main_stage)
[0m17:19:59.443636 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_stage"
[0m17:19:59.443636 [debug] [ThreadPool]: On list_lh_main_stage: BEGIN
[0m17:19:59.447695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:59.467975 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:19:59.471969 [debug] [ThreadPool]: Using duckdb connection "list_lh_main_stage"
[0m17:19:59.471969 [debug] [ThreadPool]: On list_lh_main_stage: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "connection_name": "list_lh_main_stage"} */
select
      'lh' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'lh'
  
[0m17:19:59.563795 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m17:19:59.567814 [debug] [ThreadPool]: On list_lh_main_stage: ROLLBACK
[0m17:19:59.569103 [debug] [ThreadPool]: Failed to rollback 'list_lh_main_stage'
[0m17:19:59.569682 [debug] [ThreadPool]: On list_lh_main_stage: Close
[0m17:19:59.575603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D939084D0>]}
[0m17:19:59.575603 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:59.579604 [debug] [MainThread]: On master: BEGIN
[0m17:19:59.579604 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:59.599569 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m17:19:59.599569 [debug] [MainThread]: On master: COMMIT
[0m17:19:59.599569 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:59.603566 [debug] [MainThread]: On master: COMMIT
[0m17:19:59.603566 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:19:59.603566 [debug] [MainThread]: On master: Close
[0m17:19:59.611574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:59.611574 [info ] [MainThread]: 
[0m17:19:59.619434 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_raw
[0m17:19:59.619434 [info ] [Thread-1 (]: 1 of 15 START sql table model main_raw.aircrafts_raw ........................... [RUN]
[0m17:19:59.626087 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lufthansa.aircrafts_raw'
[0m17:19:59.629143 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_raw
[0m17:19:59.646623 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_raw"
[0m17:19:59.649649 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_raw
[0m17:19:59.727711 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_raw"
[0m17:19:59.731746 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:19:59.735689 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: BEGIN
[0m17:19:59.735689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:19:59.755655 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m17:19:59.755655 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:19:59.755655 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."aircrafts_raw__dbt_tmp"
  
    as (
      

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from main.raw_aircrafts   -- airlines_lufthansa.raw_aircrafts
    );
  
  
[0m17:19:59.759649 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:19:59.771628 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:19:59.775621 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
alter table "lh"."main_raw"."aircrafts_raw__dbt_tmp" rename to "aircrafts_raw"
[0m17:19:59.775621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:19:59.807379 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:19:59.807379 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:19:59.807379 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: COMMIT
[0m17:19:59.822814 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:19:59.822814 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_raw"
[0m17:19:59.822814 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_raw"} */
drop table if exists "lh"."main_raw"."aircrafts_raw__dbt_backup" cascade
[0m17:19:59.822814 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:19:59.838461 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_raw: Close
[0m17:19:59.854062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9259F010>]}
[0m17:19:59.869681 [info ] [Thread-1 (]: 1 of 15 OK created sql table model main_raw.aircrafts_raw ...................... [[32mOK[0m in 0.23s]
[0m17:19:59.869681 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_raw
[0m17:19:59.869681 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_raw
[0m17:19:59.869681 [info ] [Thread-1 (]: 2 of 15 START sql table model main_raw.airports_raw ............................ [RUN]
[0m17:19:59.869681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_raw, now model.lufthansa.airports_raw)
[0m17:19:59.869681 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_raw
[0m17:19:59.885321 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_raw"
[0m17:19:59.885321 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_raw
[0m17:19:59.885321 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_raw"
[0m17:19:59.900942 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:19:59.900942 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: BEGIN
[0m17:19:59.900942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:59.932181 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:19:59.932181 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:19:59.932181 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."airports_raw__dbt_tmp"
  
    as (
      

select
    airport_code,
    airport_name,
    city,
    country,
    timezone
from main.raw_airports
    );
  
  
[0m17:19:59.932181 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:19:59.947801 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:19:59.947801 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
alter table "lh"."main_raw"."airports_raw__dbt_tmp" rename to "airports_raw"
[0m17:19:59.947801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:19:59.947801 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:19:59.947801 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:19:59.947801 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: COMMIT
[0m17:19:59.947801 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:19:59.963410 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_raw"
[0m17:19:59.963410 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_raw"} */
drop table if exists "lh"."main_raw"."airports_raw__dbt_backup" cascade
[0m17:19:59.963410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:19:59.963410 [debug] [Thread-1 (]: On model.lufthansa.airports_raw: Close
[0m17:20:00.010264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D94039A90>]}
[0m17:20:00.010264 [info ] [Thread-1 (]: 2 of 15 OK created sql table model main_raw.airports_raw ....................... [[32mOK[0m in 0.14s]
[0m17:20:00.010264 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_raw
[0m17:20:00.010264 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_raw
[0m17:20:00.010264 [info ] [Thread-1 (]: 3 of 15 START sql table model main_raw.bookings_raw ............................ [RUN]
[0m17:20:00.025881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_raw, now model.lufthansa.bookings_raw)
[0m17:20:00.025881 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_raw
[0m17:20:00.025881 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_raw"
[0m17:20:00.025881 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_raw
[0m17:20:00.041503 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_raw"
[0m17:20:00.041503 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:20:00.041503 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: BEGIN
[0m17:20:00.041503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:00.072762 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:20:00.072762 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:20:00.072762 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."bookings_raw__dbt_tmp"
  
    as (
      

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    booking_status,
    price
from  main.raw_bookings
    );
  
  
[0m17:20:00.088382 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:20:00.088382 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:20:00.088382 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
alter table "lh"."main_raw"."bookings_raw__dbt_tmp" rename to "bookings_raw"
[0m17:20:00.088382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.088382 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:20:00.104001 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:20:00.104717 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: COMMIT
[0m17:20:00.112843 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:20:00.112843 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_raw"
[0m17:20:00.119870 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_raw"} */
drop table if exists "lh"."main_raw"."bookings_raw__dbt_backup" cascade
[0m17:20:00.119870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.119870 [debug] [Thread-1 (]: On model.lufthansa.bookings_raw: Close
[0m17:20:00.135499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9253AA50>]}
[0m17:20:00.151120 [info ] [Thread-1 (]: 3 of 15 OK created sql table model main_raw.bookings_raw ....................... [[32mOK[0m in 0.11s]
[0m17:20:00.151120 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_raw
[0m17:20:00.151120 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_raw
[0m17:20:00.151120 [info ] [Thread-1 (]: 4 of 15 START sql table model main_raw.flights_raw ............................. [RUN]
[0m17:20:00.151120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_raw, now model.lufthansa.flights_raw)
[0m17:20:00.151120 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_raw
[0m17:20:00.166763 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_raw"
[0m17:20:00.166763 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_raw
[0m17:20:00.166763 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_raw"
[0m17:20:00.166763 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:20:00.166763 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: BEGIN
[0m17:20:00.166763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:00.198001 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:20:00.198001 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:20:00.198001 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."flights_raw__dbt_tmp"
  
    as (
        -- tells dbt how to create and store model in db

select
    flight_id,
    flight_number,
    origin_airport_code,
    destination_airport_code,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    status
from main.raw_flights
    );
  
  
[0m17:20:00.213619 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:00.213619 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:20:00.213619 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
alter table "lh"."main_raw"."flights_raw__dbt_tmp" rename to "flights_raw"
[0m17:20:00.213619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.229240 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:20:00.229240 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:20:00.229240 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: COMMIT
[0m17:20:00.229240 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:00.229240 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_raw"
[0m17:20:00.229240 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_raw"} */
drop table if exists "lh"."main_raw"."flights_raw__dbt_backup" cascade
[0m17:20:00.229240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.244859 [debug] [Thread-1 (]: On model.lufthansa.flights_raw: Close
[0m17:20:00.276080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9396DE50>]}
[0m17:20:00.276080 [info ] [Thread-1 (]: 4 of 15 OK created sql table model main_raw.flights_raw ........................ [[32mOK[0m in 0.12s]
[0m17:20:00.276080 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_raw
[0m17:20:00.276080 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_raw
[0m17:20:00.276080 [info ] [Thread-1 (]: 5 of 15 START sql table model main_raw.passengers_raw .......................... [RUN]
[0m17:20:00.276080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_raw, now model.lufthansa.passengers_raw)
[0m17:20:00.291701 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_raw
[0m17:20:00.291701 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_raw"
[0m17:20:00.291701 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_raw
[0m17:20:00.307321 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_raw"
[0m17:20:00.307321 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:20:00.307321 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: BEGIN
[0m17:20:00.307321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:00.338558 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m17:20:00.338558 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:20:00.338558 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */

  
    
    

    create  table
      "lh"."main_raw"."passengers_raw__dbt_tmp"
  
    as (
      

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    email,
    phone_number
from  main.raw_passengers
    );
  
  
[0m17:20:00.354198 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:20:00.354198 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:20:00.354198 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
alter table "lh"."main_raw"."passengers_raw__dbt_tmp" rename to "passengers_raw"
[0m17:20:00.354198 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.369944 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:20:00.370471 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:20:00.370471 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: COMMIT
[0m17:20:00.375536 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:00.375536 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_raw"
[0m17:20:00.385568 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_raw"} */
drop table if exists "lh"."main_raw"."passengers_raw__dbt_backup" cascade
[0m17:20:00.385568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.385568 [debug] [Thread-1 (]: On model.lufthansa.passengers_raw: Close
[0m17:20:00.401203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D922C5710>]}
[0m17:20:00.416848 [info ] [Thread-1 (]: 5 of 15 OK created sql table model main_raw.passengers_raw ..................... [[32mOK[0m in 0.13s]
[0m17:20:00.416848 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_raw
[0m17:20:00.416848 [debug] [Thread-1 (]: Began running node model.lufthansa.aircrafts_stg
[0m17:20:00.416848 [info ] [Thread-1 (]: 6 of 15 START sql view model main_stage.aircrafts_stg .......................... [RUN]
[0m17:20:00.416848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_raw, now model.lufthansa.aircrafts_stg)
[0m17:20:00.416848 [debug] [Thread-1 (]: Began compiling node model.lufthansa.aircrafts_stg
[0m17:20:00.432460 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.aircrafts_stg"
[0m17:20:00.432460 [debug] [Thread-1 (]: Began executing node model.lufthansa.aircrafts_stg
[0m17:20:00.463715 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.aircrafts_stg"
[0m17:20:00.463715 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:20:00.463715 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: BEGIN
[0m17:20:00.463715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:00.494951 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m17:20:00.494951 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:20:00.510720 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */

  
  create view "lh"."main_stage"."aircrafts_stg__dbt_tmp" as (
    

select
    aircraft_id,
    aircraft_model,
    capacity,
    manufacturer,
    in_service_date
from "lh"."main_raw"."aircrafts_raw"
where in_service_date IS NOT null
  );

[0m17:20:00.512910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.516872 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:20:00.516872 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
alter view "lh"."main_stage"."aircrafts_stg__dbt_tmp" rename to "aircrafts_stg"
[0m17:20:00.516872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.516872 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:20:00.526399 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:20:00.526917 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: COMMIT
[0m17:20:00.527943 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:20:00.527943 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.aircrafts_stg"
[0m17:20:00.527943 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.aircrafts_stg"} */
drop view if exists "lh"."main_stage"."aircrafts_stg__dbt_backup" cascade
[0m17:20:00.527943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.542471 [debug] [Thread-1 (]: On model.lufthansa.aircrafts_stg: Close
[0m17:20:00.558125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9404C290>]}
[0m17:20:00.558125 [info ] [Thread-1 (]: 6 of 15 OK created sql view model main_stage.aircrafts_stg ..................... [[32mOK[0m in 0.13s]
[0m17:20:00.558125 [debug] [Thread-1 (]: Finished running node model.lufthansa.aircrafts_stg
[0m17:20:00.558125 [debug] [Thread-1 (]: Began running node model.lufthansa.airports_stg
[0m17:20:00.558125 [info ] [Thread-1 (]: 7 of 15 START sql view model main_stage.airports_stg ........................... [RUN]
[0m17:20:00.558125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.aircrafts_stg, now model.lufthansa.airports_stg)
[0m17:20:00.558125 [debug] [Thread-1 (]: Began compiling node model.lufthansa.airports_stg
[0m17:20:00.573753 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.airports_stg"
[0m17:20:00.573753 [debug] [Thread-1 (]: Began executing node model.lufthansa.airports_stg
[0m17:20:00.573753 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.airports_stg"
[0m17:20:00.573753 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:20:00.573753 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: BEGIN
[0m17:20:00.573753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:00.604982 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:20:00.620579 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:20:00.620579 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */

  
  create view "lh"."main_stage"."airports_stg__dbt_tmp" as (
    

select
    UPPER(airport_code) as airport_code,
    airport_name,
    city,
    country,
    timezone
from "lh"."main_raw"."airports_raw"
  );

[0m17:20:00.620579 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.620579 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:20:00.620579 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
alter view "lh"."main_stage"."airports_stg__dbt_tmp" rename to "airports_stg"
[0m17:20:00.620579 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.636220 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:20:00.636220 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:20:00.636220 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: COMMIT
[0m17:20:00.636220 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:20:00.636220 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.airports_stg"
[0m17:20:00.636220 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.airports_stg"} */
drop view if exists "lh"."main_stage"."airports_stg__dbt_backup" cascade
[0m17:20:00.636220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.651844 [debug] [Thread-1 (]: On model.lufthansa.airports_stg: Close
[0m17:20:00.667457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D8E900F10>]}
[0m17:20:00.667457 [info ] [Thread-1 (]: 7 of 15 OK created sql view model main_stage.airports_stg ...................... [[32mOK[0m in 0.11s]
[0m17:20:00.667457 [debug] [Thread-1 (]: Finished running node model.lufthansa.airports_stg
[0m17:20:00.667457 [debug] [Thread-1 (]: Began running node model.lufthansa.bookings_stg
[0m17:20:00.667457 [info ] [Thread-1 (]: 8 of 15 START sql view model main_stage.bookings_stg ........................... [RUN]
[0m17:20:00.683096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.airports_stg, now model.lufthansa.bookings_stg)
[0m17:20:00.683096 [debug] [Thread-1 (]: Began compiling node model.lufthansa.bookings_stg
[0m17:20:00.683096 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.bookings_stg"
[0m17:20:00.683096 [debug] [Thread-1 (]: Began executing node model.lufthansa.bookings_stg
[0m17:20:00.698701 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.bookings_stg"
[0m17:20:00.698701 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:20:00.698701 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: BEGIN
[0m17:20:00.698701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:00.729920 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:20:00.729920 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:20:00.729920 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */

  
  create view "lh"."main_stage"."bookings_stg__dbt_tmp" as (
    

select
    booking_id,
    flight_id,
    passenger_id,
    booking_date,
    UPPER(booking_status) as booking_status,
    price
from "lh"."main_raw"."bookings_raw"
where booking_status is not null
  );

[0m17:20:00.729920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.745539 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:20:00.745539 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
alter view "lh"."main_stage"."bookings_stg__dbt_tmp" rename to "bookings_stg"
[0m17:20:00.745539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.745539 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:20:00.761159 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:20:00.761159 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: COMMIT
[0m17:20:00.761159 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:20:00.761159 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.bookings_stg"
[0m17:20:00.761159 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.bookings_stg"} */
drop view if exists "lh"."main_stage"."bookings_stg__dbt_backup" cascade
[0m17:20:00.761159 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.776804 [debug] [Thread-1 (]: On model.lufthansa.bookings_stg: Close
[0m17:20:00.792462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9409C6D0>]}
[0m17:20:00.792462 [info ] [Thread-1 (]: 8 of 15 OK created sql view model main_stage.bookings_stg ...................... [[32mOK[0m in 0.11s]
[0m17:20:00.792462 [debug] [Thread-1 (]: Finished running node model.lufthansa.bookings_stg
[0m17:20:00.792462 [debug] [Thread-1 (]: Began running node model.lufthansa.flights_stg
[0m17:20:00.792462 [info ] [Thread-1 (]: 9 of 15 START sql view model main_stage.flights_stg ............................ [RUN]
[0m17:20:00.792462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.bookings_stg, now model.lufthansa.flights_stg)
[0m17:20:00.808054 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flights_stg
[0m17:20:00.808054 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flights_stg"
[0m17:20:00.808054 [debug] [Thread-1 (]: Began executing node model.lufthansa.flights_stg
[0m17:20:00.823647 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flights_stg"
[0m17:20:00.823647 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:20:00.823647 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: BEGIN
[0m17:20:00.823647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:00.854910 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:20:00.854910 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:20:00.854910 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */

  
  create view "lh"."main_stage"."flights_stg__dbt_tmp" as (
    

select
    flight_id,
    flight_number,
    origin_airport_code as airport_from,
    destination_airport_code as airport_to,
    scheduled_departure_time,
    scheduled_arrival_time,
    actual_departure_time,
    actual_arrival_time,
    aircraft_id,
    upper(status) as status
from "lh"."main_raw"."flights_raw"
where status is not null
  );

[0m17:20:00.854910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.870523 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:20:00.870523 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
alter view "lh"."main_stage"."flights_stg__dbt_tmp" rename to "flights_stg"
[0m17:20:00.870523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.870523 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:20:00.870523 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:20:00.870523 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: COMMIT
[0m17:20:00.870523 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:00.886140 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flights_stg"
[0m17:20:00.886140 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flights_stg"} */
drop view if exists "lh"."main_stage"."flights_stg__dbt_backup" cascade
[0m17:20:00.886140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.886140 [debug] [Thread-1 (]: On model.lufthansa.flights_stg: Close
[0m17:20:00.901759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D940074D0>]}
[0m17:20:00.901759 [info ] [Thread-1 (]: 9 of 15 OK created sql view model main_stage.flights_stg ....................... [[32mOK[0m in 0.11s]
[0m17:20:00.901759 [debug] [Thread-1 (]: Finished running node model.lufthansa.flights_stg
[0m17:20:00.917382 [debug] [Thread-1 (]: Began running node model.lufthansa.passengers_stg
[0m17:20:00.917382 [info ] [Thread-1 (]: 10 of 15 START sql view model main_stage.passengers_stg ........................ [RUN]
[0m17:20:00.917382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flights_stg, now model.lufthansa.passengers_stg)
[0m17:20:00.917382 [debug] [Thread-1 (]: Began compiling node model.lufthansa.passengers_stg
[0m17:20:00.917382 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.passengers_stg"
[0m17:20:00.917382 [debug] [Thread-1 (]: Began executing node model.lufthansa.passengers_stg
[0m17:20:00.933001 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.passengers_stg"
[0m17:20:00.933001 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:20:00.933001 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: BEGIN
[0m17:20:00.933001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:00.964244 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:20:00.964244 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:20:00.964244 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */

  
  create view "lh"."main_stage"."passengers_stg__dbt_tmp" as (
    

select
    passenger_id,
    first_name,
    last_name,
    date_of_birth,
    LOWER(email) as email,
    phone_number
from "lh"."main_raw"."passengers_raw"
  );

[0m17:20:00.964244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.979840 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:20:00.979840 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
alter view "lh"."main_stage"."passengers_stg__dbt_tmp" rename to "passengers_stg"
[0m17:20:00.979840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.979840 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:20:00.979840 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:20:00.979840 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: COMMIT
[0m17:20:00.995481 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:20:00.995481 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.passengers_stg"
[0m17:20:00.995481 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.passengers_stg"} */
drop view if exists "lh"."main_stage"."passengers_stg__dbt_backup" cascade
[0m17:20:00.995481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:00.995481 [debug] [Thread-1 (]: On model.lufthansa.passengers_stg: Close
[0m17:20:01.011106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D93961A90>]}
[0m17:20:01.026702 [info ] [Thread-1 (]: 10 of 15 OK created sql view model main_stage.passengers_stg ................... [[32mOK[0m in 0.09s]
[0m17:20:01.026702 [debug] [Thread-1 (]: Finished running node model.lufthansa.passengers_stg
[0m17:20:01.026702 [debug] [Thread-1 (]: Began running node model.lufthansa.daily_flights
[0m17:20:01.026702 [info ] [Thread-1 (]: 11 of 15 START sql table model main_mart.daily_flights ......................... [RUN]
[0m17:20:01.026702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.passengers_stg, now model.lufthansa.daily_flights)
[0m17:20:01.026702 [debug] [Thread-1 (]: Began compiling node model.lufthansa.daily_flights
[0m17:20:01.026702 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.daily_flights"
[0m17:20:01.042341 [debug] [Thread-1 (]: Began executing node model.lufthansa.daily_flights
[0m17:20:01.042341 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.daily_flights"
[0m17:20:01.042341 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:20:01.042341 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: BEGIN
[0m17:20:01.042341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:01.073579 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:20:01.073579 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:20:01.073579 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */

  
    
    

    create  table
      "lh"."main_mart"."daily_flights__dbt_tmp"
  
    as (
      

with flights as (
    select
        flight_id,
        -- date(scheduled_departure_time) as flight_date,
        -- Function with name date does not exist! Did you mean "datesub"?
        CAST (scheduled_departure_time AS DATE) AS flight_date,
        airport_from,
        airport_to,
        status
    from "lh"."main_stage"."flights_stg"
)
select
    flight_date,
    airport_from,
    airport_to,
    count(*) as total_flights,
    sum(case when status = 'DEPARTED' then 1 else 0 end) as flights_departed,
    sum(case when status = 'CANCELLED' then 1 else 0 end) as flights_cancelled
from flights
group by flight_date, airport_from, airport_to
    );
  
  
[0m17:20:01.089204 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:20:01.104824 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:20:01.104824 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
alter table "lh"."main_mart"."daily_flights__dbt_tmp" rename to "daily_flights"
[0m17:20:01.104824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.104824 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: COMMIT
[0m17:20:01.104824 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:20:01.104824 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: COMMIT
[0m17:20:01.104824 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:20:01.215547 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.daily_flights"
[0m17:20:01.216642 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.daily_flights"} */
drop table if exists "lh"."main_mart"."daily_flights__dbt_backup" cascade
[0m17:20:01.216642 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.216642 [debug] [Thread-1 (]: On model.lufthansa.daily_flights: Close
[0m17:20:01.245937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D940CBF90>]}
[0m17:20:01.245937 [info ] [Thread-1 (]: 11 of 15 OK created sql table model main_mart.daily_flights .................... [[32mOK[0m in 0.22s]
[0m17:20:01.245937 [debug] [Thread-1 (]: Finished running node model.lufthansa.daily_flights
[0m17:20:01.245937 [debug] [Thread-1 (]: Began running node model.lufthansa.delays
[0m17:20:01.261585 [info ] [Thread-1 (]: 12 of 15 START sql table model main_mart.delays ................................ [RUN]
[0m17:20:01.261585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.daily_flights, now model.lufthansa.delays)
[0m17:20:01.261585 [debug] [Thread-1 (]: Began compiling node model.lufthansa.delays
[0m17:20:01.261585 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.delays"
[0m17:20:01.261585 [debug] [Thread-1 (]: Began executing node model.lufthansa.delays
[0m17:20:01.277205 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.delays"
[0m17:20:01.277205 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:20:01.277205 [debug] [Thread-1 (]: On model.lufthansa.delays: BEGIN
[0m17:20:01.277205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:01.308447 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:20:01.308447 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:20:01.308447 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */

  
    
    

    create  table
      "lh"."main_mart"."delays__dbt_tmp"
  
    as (
      

WITH delays AS (
    SELECT
        flight_id,
        scheduled_departure_time,
        actual_departure_time,
        EXTRACT('epoch' FROM (actual_departure_time - scheduled_departure_time)) / 60 AS departure_delay_minutes
      --EXTRACT('epoch' FROM interval) function returns the total number of seconds contained in the interval
    FROM "lh"."main_stage"."flights_stg"
    WHERE actual_departure_time IS NOT NULL
)

SELECT
    AVG(departure_delay_minutes) AS average_delay_minutes,
    MAX(departure_delay_minutes) AS max_delay_minutes,
    MIN(departure_delay_minutes) AS min_delay_minutes,
    COUNT(*) AS total_flights
FROM delays
    );
  
  
[0m17:20:01.308447 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:01.324066 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:20:01.324066 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
alter table "lh"."main_mart"."delays__dbt_tmp" rename to "delays"
[0m17:20:01.324066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.324066 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:20:01.324066 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:20:01.324066 [debug] [Thread-1 (]: On model.lufthansa.delays: COMMIT
[0m17:20:01.339687 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:01.339687 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.delays"
[0m17:20:01.339687 [debug] [Thread-1 (]: On model.lufthansa.delays: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.delays"} */
drop table if exists "lh"."main_mart"."delays__dbt_backup" cascade
[0m17:20:01.339687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.339687 [debug] [Thread-1 (]: On model.lufthansa.delays: Close
[0m17:20:01.370908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D92805250>]}
[0m17:20:01.370908 [info ] [Thread-1 (]: 12 of 15 OK created sql table model main_mart.delays ........................... [[32mOK[0m in 0.11s]
[0m17:20:01.370908 [debug] [Thread-1 (]: Finished running node model.lufthansa.delays
[0m17:20:01.370908 [debug] [Thread-1 (]: Began running node model.lufthansa.flight_effectiveness
[0m17:20:01.370908 [info ] [Thread-1 (]: 13 of 15 START sql table model main_mart.flight_effectiveness .................. [RUN]
[0m17:20:01.370908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.delays, now model.lufthansa.flight_effectiveness)
[0m17:20:01.386526 [debug] [Thread-1 (]: Began compiling node model.lufthansa.flight_effectiveness
[0m17:20:01.386526 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.flight_effectiveness"
[0m17:20:01.386526 [debug] [Thread-1 (]: Began executing node model.lufthansa.flight_effectiveness
[0m17:20:01.402145 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.flight_effectiveness"
[0m17:20:01.402145 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:20:01.402145 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: BEGIN
[0m17:20:01.402145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:01.433387 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m17:20:01.433387 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:20:01.433387 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */

  
    
    

    create  table
      "lh"."main_mart"."flight_effectiveness__dbt_tmp"
  
    as (
      

with flight_bookings as (
    select
        b.flight_id,
        count(*) AS booked_seats
    from "lh"."main_stage"."bookings_stg" b
    group by b.flight_id
),
flight_capacity as (
    select
        f.flight_id,
        f.aircraft_id,
        a.capacity
    from "lh"."main_stage"."flights_stg" f
    INNER JOIN "lh"."main_stage"."aircrafts_stg" a ON f.aircraft_id = a.aircraft_id
)
select
    fc.flight_id,
    fc.aircraft_id,
    fc.capacity,
    fb.booked_seats,
    (fb.booked_seats::float / fc.capacity) * 100 AS effectiveness_percentage -- typecast to float
from flight_capacity fc
LEFT JOIN flight_bookings fb ON fc.flight_id = fb.flight_id
    );
  
  
[0m17:20:01.449007 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:20:01.449007 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:20:01.449007 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
alter table "lh"."main_mart"."flight_effectiveness__dbt_tmp" rename to "flight_effectiveness"
[0m17:20:01.465295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.465295 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:20:01.465295 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:20:01.465295 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: COMMIT
[0m17:20:01.474100 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:01.480629 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.flight_effectiveness"
[0m17:20:01.480629 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.flight_effectiveness"} */
drop table if exists "lh"."main_mart"."flight_effectiveness__dbt_backup" cascade
[0m17:20:01.480629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.480629 [debug] [Thread-1 (]: On model.lufthansa.flight_effectiveness: Close
[0m17:20:01.511878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D940BE050>]}
[0m17:20:01.511878 [info ] [Thread-1 (]: 13 of 15 OK created sql table model main_mart.flight_effectiveness ............. [[32mOK[0m in 0.14s]
[0m17:20:01.511878 [debug] [Thread-1 (]: Finished running node model.lufthansa.flight_effectiveness
[0m17:20:01.511878 [debug] [Thread-1 (]: Began running node model.lufthansa.top_routes
[0m17:20:01.511878 [info ] [Thread-1 (]: 14 of 15 START sql table model main_mart.top_routes ............................ [RUN]
[0m17:20:01.511878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.flight_effectiveness, now model.lufthansa.top_routes)
[0m17:20:01.511878 [debug] [Thread-1 (]: Began compiling node model.lufthansa.top_routes
[0m17:20:01.527524 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.top_routes"
[0m17:20:01.527524 [debug] [Thread-1 (]: Began executing node model.lufthansa.top_routes
[0m17:20:01.527524 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.top_routes"
[0m17:20:01.527524 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:20:01.543139 [debug] [Thread-1 (]: On model.lufthansa.top_routes: BEGIN
[0m17:20:01.543139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:01.574376 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m17:20:01.574376 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:20:01.574376 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */

  
    
    

    create  table
      "lh"."main_mart"."top_routes__dbt_tmp"
  
    as (
      

SELECT
    airport_from,
    airport_to,
    COUNT(*) AS total_flights
FROM "lh"."main_stage"."flights_stg"
GROUP BY airport_from, airport_to
ORDER BY total_flights DESC
LIMIT 10
    );
  
  
[0m17:20:01.574376 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:20:01.589996 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:20:01.589996 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
alter table "lh"."main_mart"."top_routes__dbt_tmp" rename to "top_routes"
[0m17:20:01.589996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.589996 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:20:01.589996 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:20:01.589996 [debug] [Thread-1 (]: On model.lufthansa.top_routes: COMMIT
[0m17:20:01.589996 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:01.605616 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.top_routes"
[0m17:20:01.605616 [debug] [Thread-1 (]: On model.lufthansa.top_routes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.top_routes"} */
drop table if exists "lh"."main_mart"."top_routes__dbt_backup" cascade
[0m17:20:01.605616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.605616 [debug] [Thread-1 (]: On model.lufthansa.top_routes: Close
[0m17:20:01.652487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D922C5710>]}
[0m17:20:01.652487 [info ] [Thread-1 (]: 14 of 15 OK created sql table model main_mart.top_routes ....................... [[32mOK[0m in 0.14s]
[0m17:20:01.652487 [debug] [Thread-1 (]: Finished running node model.lufthansa.top_routes
[0m17:20:01.652487 [debug] [Thread-1 (]: Began running node model.lufthansa.revenue_from_passengers
[0m17:20:01.652487 [info ] [Thread-1 (]: 15 of 15 START sql table model main_mart.revenue_from_passengers ............... [RUN]
[0m17:20:01.652487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lufthansa.top_routes, now model.lufthansa.revenue_from_passengers)
[0m17:20:01.652487 [debug] [Thread-1 (]: Began compiling node model.lufthansa.revenue_from_passengers
[0m17:20:01.668101 [debug] [Thread-1 (]: Writing injected SQL for node "model.lufthansa.revenue_from_passengers"
[0m17:20:01.668101 [debug] [Thread-1 (]: Began executing node model.lufthansa.revenue_from_passengers
[0m17:20:01.683719 [debug] [Thread-1 (]: Writing runtime sql for node "model.lufthansa.revenue_from_passengers"
[0m17:20:01.683719 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:20:01.683719 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: BEGIN
[0m17:20:01.683719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:01.714975 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m17:20:01.714975 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:20:01.714975 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */

  
    
    

    create  table
      "lh"."main_mart"."revenue_from_passengers__dbt_tmp"
  
    as (
      

select
    p.passenger_id,
    p.first_name,
    p.last_name,
    sum(b.price) as total_revenue,
    count(*) as total_bookings
from "lh"."main_stage"."passengers_stg" p
INNER JOIN "lh"."main_stage"."bookings_stg" b on p.passenger_id = b.passenger_id
group BY p.passenger_id, p.first_name, p.last_name
    );
  
  
[0m17:20:01.730577 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:20:01.730577 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:20:01.730577 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
alter table "lh"."main_mart"."revenue_from_passengers__dbt_tmp" rename to "revenue_from_passengers"
[0m17:20:01.730577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.730577 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:20:01.746198 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:20:01.746198 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: COMMIT
[0m17:20:01.746198 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:20:01.746198 [debug] [Thread-1 (]: Using duckdb connection "model.lufthansa.revenue_from_passengers"
[0m17:20:01.746198 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lufthansa", "target_name": "dev", "node_id": "model.lufthansa.revenue_from_passengers"} */
drop table if exists "lh"."main_mart"."revenue_from_passengers__dbt_backup" cascade
[0m17:20:01.746198 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:20:01.761820 [debug] [Thread-1 (]: On model.lufthansa.revenue_from_passengers: Close
[0m17:20:01.777436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfcd795-76e8-42b4-b8d8-de6e04ac61aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9405D650>]}
[0m17:20:01.777436 [info ] [Thread-1 (]: 15 of 15 OK created sql table model main_mart.revenue_from_passengers .......... [[32mOK[0m in 0.12s]
[0m17:20:01.793037 [debug] [Thread-1 (]: Finished running node model.lufthansa.revenue_from_passengers
[0m17:20:01.793037 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:01.793037 [debug] [MainThread]: On master: BEGIN
[0m17:20:01.793037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:01.824277 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m17:20:01.824277 [debug] [MainThread]: On master: COMMIT
[0m17:20:01.824277 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:01.824277 [debug] [MainThread]: On master: COMMIT
[0m17:20:01.824277 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:20:01.824277 [debug] [MainThread]: On master: Close
[0m17:20:01.839896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:01.839896 [debug] [MainThread]: Connection 'create_lh_main_stage' was properly closed.
[0m17:20:01.839896 [debug] [MainThread]: Connection 'list_lh_main_stage' was properly closed.
[0m17:20:01.839896 [debug] [MainThread]: Connection 'model.lufthansa.revenue_from_passengers' was properly closed.
[0m17:20:01.839896 [info ] [MainThread]: 
[0m17:20:01.839896 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m17:20:01.839896 [debug] [MainThread]: Command end result
[0m17:20:01.918021 [info ] [MainThread]: 
[0m17:20:01.918021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:20:01.918021 [info ] [MainThread]: 
[0m17:20:01.918021 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m17:20:01.933701 [debug] [MainThread]: Command `dbt run` succeeded at 17:20:01.933701 after 4.75 seconds
[0m17:20:01.933701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D8C08E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D8C35D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D8C0CB5D0>]}
[0m17:20:01.933701 [debug] [MainThread]: Flushing usage events
